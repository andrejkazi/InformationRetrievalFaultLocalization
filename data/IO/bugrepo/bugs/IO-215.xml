<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun Nov 20 15:21:51 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/IO-215/IO-215.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[IO-215] FileUtils copy methods swallow date modification failures</title>
                <link>https://issues.apache.org/jira/browse/IO-215</link>
                <project id="12310477" key="IO">Commons IO</project>
                    <description>&lt;p&gt;FileUtils.doCopyDirectory(..) and .FileUtils.doCopyFile(..) both call the setLastModified() method, but fail to check if it succeeded or not.&lt;/p&gt;

&lt;p&gt;Surely if the caller has asked for the date to be preserved, failure to do so should be reported somehow?&lt;/p&gt;</description>
                <environment></environment>
        <key id="12433493">IO-215</key>
            <summary>FileUtils copy methods swallow date modification failures</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="sebb@apache.org">Sebb</reporter>
                        <labels>
                    </labels>
                <created>Wed, 19 Aug 2009 17:50:15 +0000</created>
                <updated>Thu, 10 Nov 2011 18:09:37 +0000</updated>
                            <resolved>Wed, 29 Sep 2010 18:02:23 +0000</resolved>
                                                    <fixVersion>2.0</fixVersion>
                                    <component>Utilities</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12895400" author="niallp" created="Wed, 4 Aug 2010 20:20:23 +0000"  >&lt;p&gt;I don&apos;t see any issue with the current behaviour and am not sure what you&apos;re thinking of in terms of &quot;reporting&quot; this - I guess you mean throw an exception - but that would seem over the top for the behaviour of a minor option.&lt;/p&gt;</comment>
                            <comment id="12907332" author="sebb@apache.org" created="Wed, 8 Sep 2010 17:40:30 +0000"  >&lt;p&gt;The user is able to specify whether or not to preserve file dates, and I think that failure to do so breaks the API contract - therefore an Exception should be thrown.&lt;/p&gt;

&lt;p&gt;There are some public methods which don&apos;t offer the option, but set it true internally.&lt;br/&gt;
These should probably retain the current behaviour.&lt;/p&gt;</comment>
                            <comment id="12907629" author="niallp" created="Thu, 9 Sep 2010 14:02:42 +0000"  >&lt;p&gt;I&apos;ve used this in the past and what was most important was that the files were copied - it was &lt;b&gt;preferable&lt;/b&gt; that the last modified date was preserved, but a small loss of historical info was not critical.&lt;/p&gt;

&lt;p&gt;I accept that your proposal is a valid alternative way of working - but since these methods have worked this way since at least Commons IO 1.1 then I&apos;m against changing the behaviour for current implementations.&lt;/p&gt;

&lt;p&gt;I have improved the documentation of the current methods regarding their behaviour wrt preserving the file dates:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=995431&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=995431&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="12907714" author="sebb@apache.org" created="Thu, 9 Sep 2010 18:28:55 +0000"  >&lt;p&gt;OK, point taken.&lt;/p&gt;

&lt;p&gt;How about adding new copyFileXX() and copyDirectoryXX() methods that do report failures?&lt;/p&gt;

&lt;p&gt;I don&apos;t think there&apos;s any point in adding a boolean reportError parameter as it would only apply if preserveDates is true, so the methods would need new names.&lt;br/&gt;
Any suggestions?&lt;/p&gt;

&lt;p&gt;It&apos;s a pity that changing the return from void to boolean is not binary compatible, otherwise that would be an easy solution.&lt;br/&gt;
Maybe consider doing that for a major version update?&lt;/p&gt;

&lt;p&gt;However the private internal copy methods could be changed to return true/false without affecting binary compatibility of the public API.&lt;/p&gt;</comment>
                            <comment id="12909773" author="niallp" created="Wed, 15 Sep 2010 15:34:21 +0000"  >&lt;p&gt;I couldn&apos;t think of sensible names for new methods - for example copyFilePreserve() would probably be confusing because copyFile(File, File) does &quot;preserve&quot; and it doesn&apos;t really reflect that an exception will be thrown if not preserved - which is the difference with copyFile().  Something like copyFileThrowExceptionIfDatesNotPreserved() isn&apos;t very pleasant.&lt;/p&gt;

&lt;p&gt;On the &quot;returning boolean&quot; suggestion - it seems slightly unnatural/odd to return a boolean from a copy method that means &quot;dates preserved or not&quot; - the natural meaning in my mind would be to indicate whether a file was copied or not - for example:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (FileUtils.copyFile(source, dest)) {
   &lt;span class=&quot;code-comment&quot;&gt;// ?means dates preserved, not file copied?
&lt;/span&gt;}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Another idea would be to add an enum for the three types of behaviour:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Don&apos;t Preserve Dates&lt;/li&gt;
	&lt;li&gt;Preserve Dates&lt;/li&gt;
	&lt;li&gt;Preserve Dates and throw exception&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="12909777" author="niallp" created="Wed, 15 Sep 2010 15:40:29 +0000"  >&lt;p&gt;Slight error in the previous patch - adding v2&lt;/p&gt;</comment>
                            <comment id="12910145" author="sebb@apache.org" created="Thu, 16 Sep 2010 13:14:52 +0000"  >&lt;p&gt;I like the enum option. It&apos;s also backward compatible AFAICS.&lt;/p&gt;

&lt;p&gt;BTW, the Javadoc in V2 uses &lt;/p&gt;

&lt;p&gt;@param preserveFileDate ...&lt;br/&gt;
rather than&lt;br/&gt;
@param option ..&lt;/p&gt;

&lt;p&gt;in a couple of places.&lt;/p&gt;

&lt;p&gt;I also don&apos;t like if (xxx()  == false) - I think that should be if (!xxx()).&lt;/p&gt;</comment>
                            <comment id="12910522" author="niallp" created="Fri, 17 Sep 2010 10:04:31 +0000"  >&lt;p&gt;Attaching &lt;a href=&quot;https://issues.apache.org/jira/browse/IO-215&quot; title=&quot;FileUtils copy methods swallow date modification failures&quot; class=&quot;issue-link&quot; data-issue-key=&quot;IO-215&quot;&gt;&lt;del&gt;IO-215&lt;/del&gt;&lt;/a&gt;-copy-option-v3.patch that fixes the javadoc errors and adds FileUtils.copyFileToDirectory(File, File, CopyOption) method.&lt;/p&gt;

&lt;p&gt;I don&apos;t like  if (!xxx()) - I think if (xxx() == false)  is better. I guess we disagree on this style.&lt;/p&gt;

&lt;p&gt;Currently as this stands the copyDirectory() implementation when called with CopyOption.PreserveDatesThrowError will throw an error when the first File.setLastModified(long) operation fails. This could leave the copy operation in an inconsistent state with the directory only partially copied. IMO I think it would be better to complete the copy operation and throw an exception at the end. WDYT?&lt;/p&gt;</comment>
                            <comment id="12910642" author="sebb@apache.org" created="Fri, 17 Sep 2010 15:54:33 +0000"  >&lt;p&gt;Agreed that failing part-way through a dir copy is not ideal.&lt;/p&gt;

&lt;p&gt;If the private file and dir methods were changed to return false if any setLastModified fails, and true otherwise, then it should be easy to throw the appropriate error at the end.&lt;br/&gt;
Or better yet, the private doCopyDirectory method could return the File that failed, otherwise null. This would allow the Exception to identify the file which caused the first failure.&lt;/p&gt;</comment>
                            <comment id="12910787" author="niallp" created="Fri, 17 Sep 2010 21:11:51 +0000"  >&lt;p&gt;Attaching &lt;a href=&quot;https://issues.apache.org/jira/browse/IO-215&quot; title=&quot;FileUtils copy methods swallow date modification failures&quot; class=&quot;issue-link&quot; data-issue-key=&quot;IO-215&quot;&gt;&lt;del&gt;IO-215&lt;/del&gt;&lt;/a&gt;-copy-option-v4.patch - I did that, except that I used a count of the number of dates not preserved&lt;/p&gt;</comment>
                            <comment id="12910850" author="sebb@apache.org" created="Fri, 17 Sep 2010 23:38:50 +0000"  >&lt;p&gt;OK, I wondered about maintaining a count. &lt;br/&gt;
Arguably more useful than the details of the first failed file, but would be nice to have the total count (and perhaps the first file) as well.&lt;/p&gt;

&lt;p&gt;But that can be tweaked later if necessary without changing the API.&lt;/p&gt;</comment>
                            <comment id="12913213" author="niallp" created="Tue, 21 Sep 2010 19:59:01 +0000"  >&lt;p&gt;Attaching &lt;a href=&quot;https://issues.apache.org/jira/browse/IO-215&quot; title=&quot;FileUtils copy methods swallow date modification failures&quot; class=&quot;issue-link&quot; data-issue-key=&quot;IO-215&quot;&gt;&lt;del&gt;IO-215&lt;/del&gt;&lt;/a&gt;-copy-option-v5.patch - simplified patch (test case)&lt;/p&gt;


&lt;p&gt;Having done this work, I&apos;m still wondering whether its really required. Did you have an actual need for this - or was it just from looking at the code? If its the latter and no-one else has ever raised this, then its probably overcomplicating the API for something that no-one needs.&lt;/p&gt;</comment>
                            <comment id="12916221" author="niallp" created="Wed, 29 Sep 2010 18:02:23 +0000"  >&lt;p&gt;I think we should just leave this at the documentation change.&lt;/p&gt;

&lt;p&gt;Closing as FIXED&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12454836" name="IO-215-copy-option-v3.patch" size="15574" author="niallp" created="Fri, 17 Sep 2010 10:04:31 +0000"/>
                            <attachment id="12455183" name="IO-215-copy-option-v5.patch" size="20251" author="niallp" created="Tue, 21 Sep 2010 19:59:01 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 4 Aug 2010 20:20:23 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>139639</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 8 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0b11b:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>62280</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>