<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Thu Dec 01 19:03:27 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/IO-168/IO-168.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[IO-168] Symbolic links (symlinks) followed when deleting directory.</title>
                <link>https://issues.apache.org/jira/browse/IO-168</link>
                <project id="12310477" key="IO">Commons IO</project>
                    <description>&lt;p&gt;If &apos;dlink&apos; is a symbolic link to a directory &apos;dir&apos;, and FileUtils.forceDelete is called on dlink, then here is what happens:&lt;/p&gt;

&lt;p&gt;1) the contents of &apos;dir&apos; are emptied (the link is followed).&lt;br/&gt;
2) &apos;dir&apos; continues to exist (but is empty).&lt;br/&gt;
3) &apos;dlink&apos; is removed.&lt;/p&gt;

&lt;p&gt;The correct behavior is to simply remove &apos;dlink&apos; without following it and thus without altering the contents of &apos;dir&apos; (or &apos;dir&apos; itself).&lt;/p&gt;</description>
                <environment>&lt;p&gt;Linux only (symlinks required for bug to manifest)&lt;/p&gt;</environment>
        <key id="12395338">IO-168</key>
            <summary>Symbolic links (symlinks) followed when deleting directory.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="niallp">Niall Pemberton</assignee>
                                    <reporter username="tlerios">Apostolos Lerios</reporter>
                        <labels>
                    </labels>
                <created>Mon, 5 May 2008 17:02:08 +0000</created>
                <updated>Thu, 10 Nov 2011 18:09:32 +0000</updated>
                            <resolved>Tue, 28 Sep 2010 23:28:42 +0000</resolved>
                                    <version>1.4</version>
                                    <fixVersion>2.0</fixVersion>
                                    <component>Utilities</component>
                        <due></due>
                            <votes>4</votes>
                                    <watches>3</watches>
                                                                <comments>
                            <comment id="12601087" author="niallp" created="Fri, 30 May 2008 11:15:53 +0000"  >&lt;p&gt;Is there any way to determine a file is a symlink?&lt;/p&gt;</comment>
                            <comment id="12601095" author="tlerios" created="Fri, 30 May 2008 11:32:19 +0000"  >&lt;p&gt;Yes. Here is how.&lt;/p&gt;

&lt;p&gt;    public static final FileType get&lt;br/&gt;
        (File file)&lt;br/&gt;
    {&lt;br/&gt;
        if (file==null) &lt;/p&gt;
{
            return UNKNOWN;
        }
&lt;p&gt;        try {&lt;br/&gt;
            if (!file.exists()) &lt;/p&gt;
{
                return NONEXISTENT;
            }
&lt;p&gt;            if (file.getCanonicalFile().equals(file.getAbsoluteFile())) {&lt;br/&gt;
                if (file.isDirectory()) &lt;/p&gt;
{
                    return DIR;
                }
&lt;p&gt;                if (file.isFile()) &lt;/p&gt;
{
                    return FILE;
                }
&lt;p&gt;            } else {&lt;br/&gt;
                if (file.isDirectory()) &lt;/p&gt;
{
                    return LINK_DIR;
                }
&lt;p&gt;                if (file.isFile()) &lt;/p&gt;
{
                    return LINK_FILE;
                }
&lt;p&gt;            }&lt;br/&gt;
        } catch (IOException ex) &lt;/p&gt;
{
           // CANNOT_GET_TYPE
        }
&lt;p&gt;        return UNKNOWN;&lt;br/&gt;
    }&lt;/p&gt;</comment>
                            <comment id="12615831" author="ajay.sridhar" created="Tue, 22 Jul 2008 23:58:24 +0000"  >&lt;p&gt;Hi Guys,&lt;/p&gt;

&lt;p&gt;Is there an update on this? This seems like a fairly severe bug,&lt;/p&gt;

&lt;p&gt;Cheers,&lt;br/&gt;
Ajay.&lt;/p&gt;</comment>
                            <comment id="12617409" author="attila" created="Mon, 28 Jul 2008 11:41:37 +0000"  >&lt;p&gt;Folks,&lt;/p&gt;

&lt;p&gt;file.getCanonicalFile().equals(file.getAbsoluteFile())&lt;/p&gt;

&lt;p&gt;won&apos;t return true only for a symlink. It will also return true for a file that has at least one symlinked directory in its path.&lt;/p&gt;

&lt;p&gt;This will work as expected though:&lt;/p&gt;

&lt;p&gt;File canonicalDir = file.getParentFile().getCanonicalFile();&lt;br/&gt;
File fileInCanonicalDir = new File(canonicalDir, file.getName());&lt;br/&gt;
return fileInCanonicalDir.getCanonicalFile().equals(fileInCanonicalDir.getAbsoluteFile());&lt;/p&gt;

&lt;p&gt;Attila.&lt;/p&gt;</comment>
                            <comment id="12621360" author="bmccoy" created="Mon, 11 Aug 2008 06:28:10 +0000"  >&lt;p&gt;Hi Guys,&lt;/p&gt;

&lt;p&gt;I an attempt to get this fix in sooner, I have written up a patch for FileUtils based on Attila&apos;s suggestions along with a whole bunch of tests.  I have only put the fix in for the regular deleteDirectory and not the deleteDirectoryOnExit method which I am assuming will probably need this check in it as well.&lt;/p&gt;

&lt;p&gt;Hope it helps...&lt;/p&gt;

&lt;p&gt;Cheers,&lt;br/&gt;
Brydie&lt;/p&gt;</comment>
                            <comment id="12621413" author="niallp" created="Mon, 11 Aug 2008 11:30:28 +0000"  >&lt;p&gt;Brydie, thanks for the patch and Attila for the solution. I have applied a slightly modified form, which includes null checks - which if you could run the tests would be great because I&apos;m on windows &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/sad.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://svn.apache.org/viewvc?view=rev&amp;amp;revision=684715&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewvc?view=rev&amp;amp;revision=684715&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;http://svn.apache.org/viewvc?view=rev&amp;amp;revision=684716&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewvc?view=rev&amp;amp;revision=684716&lt;/a&gt;&lt;/p&gt;
</comment>
                            <comment id="12621651" author="bmccoy" created="Mon, 11 Aug 2008 23:36:09 +0000"  >&lt;p&gt;Thanks for that Niall, I knew there was something i was forgetting...  Anyway, I ran the tests on your changes and they are still passing!&lt;/p&gt;

&lt;p&gt;Thanks again,&lt;br/&gt;
Brydie&lt;/p&gt;</comment>
                            <comment id="12651684" author="niallp" created="Sat, 29 Nov 2008 01:21:40 +0000"  >&lt;p&gt;Thanks for testing, marking as resolved.&lt;/p&gt;</comment>
                            <comment id="12781760" author="tlerios" created="Tue, 24 Nov 2009 03:40:38 +0000"  >&lt;p&gt;The issue is very close to being resolved. Attila&apos;s suggestion was near perfect. It has the following problem though:&lt;/p&gt;

&lt;p&gt;If File f was constructed using a relative path (e.g. new File(&quot;dir&quot;) where dir is a directory within the current one), then getParent() will return null. So far so good. However, if dir is a directory whose ancestors include folders with long names (e.g. &quot;Documents and Settings&quot;), then under 1.6.0_14 on Windows XP SP3, the canonical path is something like&lt;/p&gt;

&lt;p&gt;C:\Documents and Settings\Administrator\Desktop\test\directory&lt;/p&gt;

&lt;p&gt;And the absolute path is something like&lt;/p&gt;

&lt;p&gt;c:\DOCUME~1\Administrator\DESKTOP\tst\directory&lt;/p&gt;

&lt;p&gt;They are unequal, so isSymlink will return true. Which is incorrect. To avoid this problem, we should obtain f&apos;s absolute path before we try to get its parent. That is, inside isSymlink,&lt;/p&gt;

&lt;p&gt;      file.getParent()&lt;/p&gt;

&lt;p&gt;should be replaced with&lt;/p&gt;

&lt;p&gt;      file.getAbsoluteFile().getParent()&lt;/p&gt;

&lt;p&gt;And similarly file.getParentFile() should become file.getAbsoluteFile().getParentFile().&lt;/p&gt;

&lt;p&gt;Doing this will ensure that we&apos;ll obtain f&apos;s parent, even if f is specified with a relative file name. This, combined with Attila&apos;s fix, will avoid oddities like the DOS names above somewhere in the ancestral hierarchy.&lt;/p&gt;</comment>
                            <comment id="12915969" author="niallp" created="Tue, 28 Sep 2010 23:28:42 +0000"  >&lt;p&gt;Apostolos thanks for your suggestion - I changed the method to always return false for Windows:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1002416&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1002416&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12387928" name="symlinkFix.patch" size="10054" author="bmccoy" created="Mon, 11 Aug 2008 06:30:22 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 30 May 2008 11:15:53 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>139604</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 10 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0b15b:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>62298</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>