<!-- 
RSS generated by JIRA (6.4.11#64026-sha1:78f6ec473a3f058bd5d6c30e9319c7ab376bdb9c) at Thu Dec 22 19:49:21 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://jira.spring.io/si/jira.issueviews:issue-xml/SPR-2237/SPR-2237.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>Spring JIRA</title>
    <link>https://jira.spring.io</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.4.11</version>
        <build-number>64026</build-number>
        <build-date>25-08-2015</build-date>
    </build-info>

<item>
            <title>[SPR-2237] Subclasses of ApplicatonObjectSupport can no longer be proxied via CGLIB</title>
                <link>https://jira.spring.io/browse/SPR-2237</link>
                <project id="10000" key="SPR">Spring Framework</project>
                    <description>&lt;p&gt;The latest nightly build (2.0RC2 b69) fails to proxy beans whose implementation inherits from ApplicationObjectSupport.&lt;/p&gt;

&lt;p&gt;With RC1, the following messages were logged:&lt;/p&gt;

&lt;p&gt;10:36:58.469 INFO  &lt;span class=&quot;error&quot;&gt;&amp;#91;Cglib2AopProxy&amp;#93;&lt;/span&gt; Unable to proxy method &lt;span class=&quot;error&quot;&gt;&amp;#91;public final org.springframework.context.ApplicationContext org.springframework.context.support.ApplicationObjectSupport.getApplicationContext() throws java.lang.IllegalStateException&amp;#93;&lt;/span&gt; because it is final: All calls to this method via a proxy will be routed directly to the proxy. [] &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt;&lt;br/&gt;
10:36:58.469 INFO  &lt;span class=&quot;error&quot;&gt;&amp;#91;Cglib2AopProxy&amp;#93;&lt;/span&gt; Unable to proxy method &lt;span class=&quot;error&quot;&gt;&amp;#91;public final void org.springframework.context.support.ApplicationObjectSupport.setApplicationContext(org.springframework.context.ApplicationContext) throws org.springframework.beans.BeansException&amp;#93;&lt;/span&gt; because it is final: All calls to this method via a proxy will be routed directly to the proxy. [] &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;With RC2b69, an exception is thrown with the following message:&lt;/p&gt;

&lt;p&gt;Cannot proxy class &apos;bridges.facade.aa.AuthenticationFacadeImpl&apos; since it has one or more public final methods.&lt;/p&gt;

&lt;p&gt;...it looks like the implementation of Cglib2AopProxy.doValidateClass changed between RC1 &amp;amp; RC2b69.&lt;/p&gt;

&lt;p&gt;One workaround would be to use JDK proxies, which works for this specific object; however, we have a number of legacy objects (now Spring-proxied for txns), which is why CGLIB proxying is enabled.&lt;/p&gt;
</description>
            <key id="14434">SPR-2237</key>
            <summary>Subclasses of ApplicatonObjectSupport can no longer be proxied via CGLIB</summary>
                <type id="1" iconUrl="https://jira.spring.io/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="1" iconUrl="https://jira.spring.io/images/icons/priorities/blocker.png">Blocker</priority>
                        <status id="6" iconUrl="https://jira.spring.io/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="robh">Rob Harrop</assignee>
                                    <reporter username="chrislee">Chris Lee</reporter>
                        <labels>
                    </labels>
                <created>Tue, 4 Jul 2006 08:06:28 +0000</created>
                <updated>Tue, 19 Jun 2012 03:52:30 +0000</updated>
                            <resolved>Wed, 5 Jul 2006 19:18:18 +0000</resolved>
                                    <version>2.0 RC2</version>
                                    <fixVersion>2.0 RC2</fixVersion>
                                    <component>Core</component>
                    <component>Core:AOP</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="18387" author="chrislee" created="Tue, 4 Jul 2006 08:15:05 +0000"  >
&lt;p&gt;It looks like the fix for &lt;a href=&quot;http://opensource.atlassian.com/projects/spring/browse/SPR-2163&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://opensource.atlassian.com/projects/spring/browse/SPR-2163&lt;/a&gt; causes failure when trying to proxy classes with final methods.&lt;/p&gt;

&lt;p&gt;Some possible solutions:&lt;/p&gt;

&lt;p&gt;1) Modify ApplicationObjectSupport to remove final modifier on public methods, allowing it to be a CGLIB proxy-able superclass.&lt;br/&gt;
2) Modify Cglib2AopProxy to log final methods as a warning (was info in RC1) instead of throwing an exception.&lt;/p&gt;</comment>
                            <comment id="18389" author="juergen.hoeller" created="Tue, 4 Jul 2006 20:19:51 +0000"  >&lt;p&gt;The problem here is that proxying final methods via CGLIB methods causes &lt;b&gt;really&lt;/b&gt; bad effects: It&apos;s the proxy instance itself that handles the call then, based on the proxy instance&apos;s state which is completely uninitialized! This only works out of sheer luck (if at all), or if you&apos;re not calling that method through the proxy in the first place. In any case, it is an inherent danger, which is why we switched to throwing an exception in this case.&lt;/p&gt;

&lt;p&gt;That said, I do appreciate that such proxying works in your case because it only affects configuration methods which will never be called through the proxy in the first place. This scenario might be common enough to warrant switching to warn messages again in case of proxying final methods. Unfortunately, we can&apos;t clearly differentiate between configuration methods and operation methods there, so would have to accept the proxying in any case...&lt;/p&gt;

&lt;p&gt;I guess the most important lesson to be learned from this is: Proxy with interfaces wherever you can. Only use CGLIB proxies if you really have no way around. For legacy objects that need to have transactions applied, you could for example build a thin wrapper that exposes a service interface and does the transactional proxying at that level...&lt;/p&gt;

&lt;p&gt;Rob, what do you think?&lt;/p&gt;

&lt;p&gt;Juergen&lt;/p&gt;</comment>
                            <comment id="18404" author="chrislee" created="Wed, 5 Jul 2006 01:28:20 +0000"  >
&lt;p&gt;Thanks Juergen; good explanation.&lt;/p&gt;

&lt;p&gt;We had always planned to convert to proxied interfaces, just not so suddenly &lt;img class=&quot;emoticon&quot; src=&quot;https://jira.spring.io/images/icons/emoticons/sad.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;I agree that it is important for proxies to &apos;just work&apos; - and flagging an error for proxying final methods aligns nicely with that.&lt;/p&gt;

&lt;p&gt;In the interest of a smooth transition - perhaps a compromise solution can be considered:&lt;/p&gt;

&lt;p&gt;&amp;lt;bean class=&quot;org.springframework.aop.framework.autoproxy.DefaultAdvisorAutoProxyCreator&quot;&amp;gt;&lt;br/&gt;
        &amp;lt;property name=&quot;proxyTargetClass&quot; value=&quot;true&quot; /&amp;gt;&lt;br/&gt;
        &amp;lt;property name=&quot;proxyFinalMethods&quot; value=&quot;true&quot;/&amp;gt;&lt;br/&gt;
&amp;lt;/bean&amp;gt;&lt;/p&gt;

&lt;p&gt;...where the proxyFinalMethods functionality is &apos;false&apos; by default, heavily documented as to the drawbacks, and logs a large DEPRECATED warning during context startup (and s/b removed in a near-future Spring release)&lt;/p&gt;</comment>
                            <comment id="18421" author="robh" created="Wed, 5 Jul 2006 19:18:18 +0000"  >&lt;p&gt;The simplest and safest solution here is to simply WARN on final methods which I have reverted the code to.&lt;/p&gt;

&lt;p&gt;Rob&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_10180" key="com.atlassian.jira.toolkit:dayslastcommented">
                        <customfieldname>Days since last comment</customfieldname>
                        <customfieldvalues>
                                        10 years, 26 weeks, 1 day ago
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10170" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>First Response Date</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 4 Jul 2006 20:19:51 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10181" key="com.atlassian.jira.toolkit:lastusercommented">
                        <customfieldname>Last commented by a User</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>false</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10182" key="com.atlassian.jira.toolkit:lastupdaterorcommenter">
                        <customfieldname>Last updater</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>tmarshall</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10880" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i03o5z:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10380" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>21457</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_10171" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>