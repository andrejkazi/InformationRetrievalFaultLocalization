<!-- 
RSS generated by JIRA (6.4.11#64026-sha1:78f6ec473a3f058bd5d6c30e9319c7ab376bdb9c) at Thu Dec 22 20:16:14 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://jira.spring.io/si/jira.issueviews:issue-xml/SPR-640/SPR-640.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>Spring JIRA</title>
    <link>https://jira.spring.io</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.4.11</version>
        <build-number>64026</build-number>
        <build-date>25-08-2015</build-date>
    </build-info>

<item>
            <title>[SPR-640] AbstractEnterpriseBean depends on ejbRemove</title>
                <link>https://jira.spring.io/browse/SPR-640</link>
                <project id="10000" key="SPR">Spring Framework</project>
                    <description>&lt;p&gt;According to ejb-2.1 specification ejb bean is simply discarded when it throws system exception. This means that ejbRemove will not be called when beans directly transits to &quot;non-existent&quot; state within ejb container.&lt;/p&gt;

&lt;p&gt;Unfortunately unloadBeanFactory() is called in ejbRemove() which creates unreliable mechanism for unloading bean factories, because reference counting employed in singleton bean factory will not work correctly.&lt;/p&gt;

&lt;p&gt;Possible solution is to choose WeakReference for automatic release of bean factories used in ejb.&lt;/p&gt;</description>
            <key id="11005">SPR-640</key>
            <summary>AbstractEnterpriseBean depends on ejbRemove</summary>
                <type id="1" iconUrl="https://jira.spring.io/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://jira.spring.io/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://jira.spring.io/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="colin.sampaleanu">Colin Sampaleanu</assignee>
                                    <reporter username="tawek">Tomasz Wysocki</reporter>
                        <labels>
                    </labels>
                <created>Wed, 19 Jan 2005 01:25:51 +0000</created>
                <updated>Fri, 11 Mar 2005 05:48:40 +0000</updated>
                            <resolved>Fri, 11 Mar 2005 05:47:31 +0000</resolved>
                                    <version>1.1.3</version>
                                    <fixVersion>1.2 RC1</fixVersion>
                                    <component>EJB</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12063" author="juergen.hoeller" created="Mon, 24 Jan 2005 00:21:43 +0000"  >&lt;p&gt;Colin, can you please have a look at this?&lt;/p&gt;

&lt;p&gt;Juergen&lt;/p&gt;</comment>
                            <comment id="12437" author="juergen.hoeller" created="Sun, 27 Feb 2005 07:34:32 +0000"  >&lt;p&gt;Colin, it would be great to have this addressed for 1.2 RC1.&lt;/p&gt;

&lt;p&gt;Juergen&lt;/p&gt;</comment>
                            <comment id="12514" author="colin.sampaleanu" created="Wed, 9 Mar 2005 08:34:03 +0000"  >&lt;p&gt;Yet another idiotic API/lifecycle decision by the EJB designers...&lt;/p&gt;

&lt;p&gt;I&apos;m not completely happy with this solution because it forces a dependency on cglib where none was needed before.&lt;/p&gt;

&lt;p&gt;However, unless I&apos;m missing something, in this case we can get by with a variation just using a regular Java based Proxy, since we know we are dealing with a BeanFactoryReference.&lt;/p&gt;

&lt;p&gt;I would go ahead with some variation of this code which uses a Proxy, if you can confirm, Tomasz, that you own this code, can contribute it to Spring, and are ok with it being released under the Apache license. At some point pretty soon, you&apos;d also have to sign a Contributor&apos;s License Agreement to the same effect. We&apos;re trying to be very careful with IP issues since it&apos;s important for everybody involved that the source of all code in Spring is verified.&lt;/p&gt;

&lt;p&gt;If you&apos;re not ok with this, then somebody would probably have to write a clean room implementation of the idea, which of course is manageable, but probably would not happen by 1.2RC1.&lt;/p&gt;

</comment>
                            <comment id="12560" author="colin.sampaleanu" created="Fri, 11 Mar 2005 05:47:31 +0000"  >&lt;p&gt;I&apos;ve modified AbstractEnterpriseBean to employ a slightly modified (uses ProxyFactory to create a JDK proxy only, instead of cglib directly) version of the WeakReferenceMonitor, as a backup for calling the release() mehtod on the BeanFactoryReference.&lt;/p&gt;

&lt;p&gt;Note that I was however able to still leave the original release() call in unloadBeanFactory(), with the WeakReferenceMonitor serving as only a backup (for when the container does not call ejbRemove()), by slightly changing the semantics of BeanFactoryReference.release(). It is not legal to call the latter multiple times.&lt;/p&gt;

&lt;p&gt;So what will happen now is that in the case where the container does call ejbRemove, there will be a normal release at that point, and a no-op release later by the weak reference monitor. In the case where the container does not call ejbRemove, there will only be a late call (at some indeterminate point) to release, when the weak reference monitor kicks in. Better than nothing, in any case.&lt;/p&gt;</comment>
                            <comment id="12561" author="colin.sampaleanu" created="Fri, 11 Mar 2005 05:48:40 +0000"  >&lt;p&gt;Sorry, the above comment shoudl say it is &lt;em&gt;now&lt;/em&gt; legal to call release() multiple times on a BeanFactoryReference, where before it was not.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="10480" name="WeakReferenceMonitor.java" size="6837" author="tawek" created="Mon, 31 Jan 2005 21:21:11 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_10180" key="com.atlassian.jira.toolkit:dayslastcommented">
                        <customfieldname>Days since last comment</customfieldname>
                        <customfieldvalues>
                                        11 years, 42 weeks, 6 days ago
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10170" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>First Response Date</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 24 Jan 2005 00:21:43 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10181" key="com.atlassian.jira.toolkit:lastusercommented">
                        <customfieldname>Last commented by a User</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>true</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10182" key="com.atlassian.jira.toolkit:lastupdaterorcommenter">
                        <customfieldname>Last updater</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>tmarshall</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10880" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i04xen:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10380" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>28786</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_10171" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>