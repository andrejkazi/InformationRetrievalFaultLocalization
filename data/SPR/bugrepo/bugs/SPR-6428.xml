<!-- 
RSS generated by JIRA (6.4.11#64026-sha1:78f6ec473a3f058bd5d6c30e9319c7ab376bdb9c) at Thu Dec 22 21:40:41 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://jira.spring.io/si/jira.issueviews:issue-xml/SPR-6428/SPR-6428.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>Spring JIRA</title>
    <link>https://jira.spring.io</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.4.11</version>
        <build-number>64026</build-number>
        <build-date>25-08-2015</build-date>
    </build-info>

<item>
            <title>[SPR-6428] Placeholders not resolved when using multiple PropertyPlaceHolderConfigurers</title>
                <link>https://jira.spring.io/browse/SPR-6428</link>
                <project id="10000" key="SPR">Spring Framework</project>
                    <description>&lt;p&gt;When using 2 PropertyPlaceHolderConfigurers, placeholders declared (and given a value) in the first PPC are not resolved in the second PPC.&lt;/p&gt;

&lt;p&gt;&amp;lt;bean id=&quot;configurer1&quot; class=&quot;org.springframework.beans.factory.config.PropertyPlaceholderConfigurer&quot;&amp;gt;&lt;br/&gt;
    &amp;lt;property name=&quot;properties&quot;&amp;gt;&lt;br/&gt;
      &amp;lt;bean class=&quot;java.util.Properties&quot;&amp;gt;&lt;br/&gt;
        &amp;lt;constructor-arg&amp;gt;&lt;br/&gt;
          &amp;lt;map&amp;gt;&lt;br/&gt;
            &amp;lt;entry key=&quot;resourceDirPlaceHolder&quot;&amp;gt;&lt;br/&gt;
              &amp;lt;value&amp;gt;myResourceDir&amp;lt;/value&amp;gt;&lt;br/&gt;
            &amp;lt;/entry&amp;gt;&lt;br/&gt;
          &amp;lt;/map&amp;gt;&lt;br/&gt;
        &amp;lt;/constructor-arg&amp;gt;&lt;br/&gt;
      &amp;lt;/bean&amp;gt;&lt;br/&gt;
    &amp;lt;/property&amp;gt;&lt;br/&gt;
    &amp;lt;property name=&quot;order&quot; value=&quot;1&quot;/&amp;gt;&lt;br/&gt;
    &amp;lt;property name=&quot;ignoreUnresolvablePlaceholders&quot; value=&quot;true&quot;/&amp;gt;&lt;br/&gt;
  &amp;lt;/bean&amp;gt;&lt;/p&gt;

&lt;p&gt;  &amp;lt;bean id=&quot;configurer2&quot; class=&quot;org.springframework.beans.factory.config.PropertyPlaceholderConfigurer&quot;&amp;gt;&lt;br/&gt;
    &amp;lt;property name=&quot;locations&quot;&amp;gt;&lt;br/&gt;
    	&amp;lt;list&amp;gt;&lt;br/&gt;
    		&amp;lt;value&amp;gt;classpath:$&lt;/p&gt;
{resourceDirPlaceHolder}/props.properties&amp;lt;/value&amp;gt;&lt;br/&gt;
    	&amp;lt;/list&amp;gt;&lt;br/&gt;
    &amp;lt;/property&amp;gt;&lt;br/&gt;
  &amp;lt;/bean&amp;gt;&lt;br/&gt;
&lt;br/&gt;
this configuration results in:&lt;br/&gt;
&lt;br/&gt;
java.io.FileNotFoundException: class path resource [${resourceDirPlaceHolder}
&lt;p&gt;/props.properties] cannot be opened because it does not exist&lt;/p&gt;</description>
            <key id="28904">SPR-6428</key>
            <summary>Placeholders not resolved when using multiple PropertyPlaceHolderConfigurers</summary>
                <type id="1" iconUrl="https://jira.spring.io/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://jira.spring.io/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://jira.spring.io/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="9">Works as Designed</resolution>
                                        <assignee username="cbeams">Chris Beams</assignee>
                                    <reporter username="gizit">Gisbert van Rossum</reporter>
                        <labels>
                    </labels>
                <created>Mon, 23 Nov 2009 22:39:28 +0000</created>
                <updated>Sat, 2 Jul 2011 01:52:20 +0000</updated>
                            <resolved>Sat, 2 Jul 2011 01:41:38 +0000</resolved>
                                    <version>2.5.6</version>
                                                    <component>Core</component>
                        <due></due>
                            <votes>2</votes>
                                    <watches>2</watches>
                                    <timeoriginalestimate seconds="14400">0.5d</timeoriginalestimate>
                            <timeestimate seconds="14400">0.5d</timeestimate>
                                        <comments>
                            <comment id="48566" author="gizit" created="Mon, 23 Nov 2009 22:41:01 +0000"  >&lt;p&gt;Zip file contains a maven project illustrating the issue&lt;/p&gt;</comment>
                            <comment id="48567" author="gizit" created="Mon, 23 Nov 2009 23:03:26 +0000"  >&lt;p&gt;Issue might be the same as &lt;a href=&quot;https://jira.spring.io/browse/SPR-5719&quot; title=&quot;only the first PropertyPlaceHolderConfigurer is initialized. Others are not&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPR-5719&quot;&gt;&lt;del&gt;SPR-5719&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="52955" author="akshaygehi" created="Wed, 14 Apr 2010 01:44:51 +0000"  >&lt;p&gt;I searched for this issue and I found people are using ignore-unresolvable property as true so that the first PropertyPlaceholderConfigurer does not throw an exception&lt;/p&gt;</comment>
                            <comment id="52956" author="akshaygehi" created="Wed, 14 Apr 2010 01:45:58 +0000"  >&lt;p&gt;Trace after the change:&lt;/p&gt;

&lt;p&gt;INFO  main 2010-04-14 20:10:14,241 Loading properties file from class path resource &lt;span class=&quot;error&quot;&gt;&amp;#91;jdbc.properties&amp;#93;&lt;/span&gt; &lt;/p&gt;
{ org.springframework.core.io.support.PropertiesLoaderSupport.loadProperties(PropertiesLoaderSupport.java:177)}
&lt;p&gt;DEBUG main 2010-04-14 20:10:14,241 Resolved placeholder &apos;driverClassName&apos; &lt;/p&gt;
{ org.springframework.util.PropertyPlaceholderHelper.parseStringValue(PropertyPlaceholderHelper.java:143)}
&lt;p&gt;DEBUG main 2010-04-14 20:10:14,241 Resolved placeholder &apos;url&apos; &lt;/p&gt;
{ org.springframework.util.PropertyPlaceholderHelper.parseStringValue(PropertyPlaceholderHelper.java:143)}
&lt;p&gt;DEBUG main 2010-04-14 20:10:14,241 Resolved placeholder &apos;reuters.username&apos; &lt;/p&gt;
{ org.springframework.util.PropertyPlaceholderHelper.parseStringValue(PropertyPlaceholderHelper.java:143)}
&lt;p&gt;DEBUG main 2010-04-14 20:10:14,241 Resolved placeholder &apos;reuters.password&apos; &lt;/p&gt;
{ org.springframework.util.PropertyPlaceholderHelper.parseStringValue(PropertyPlaceholderHelper.java:143)}
&lt;p&gt;INFO  main 2010-04-14 20:10:14,241 Loading properties file from class path resource &lt;span class=&quot;error&quot;&gt;&amp;#91;jdbc.properties&amp;#93;&lt;/span&gt; &lt;/p&gt;
{ org.springframework.core.io.support.PropertiesLoaderSupport.loadProperties(PropertiesLoaderSupport.java:177)}
&lt;p&gt;INFO  main 2010-04-14 20:10:14,241 Loading properties file from class path resource &lt;span class=&quot;error&quot;&gt;&amp;#91;msgProperties.xml&amp;#93;&lt;/span&gt; &lt;/p&gt;
{ org.springframework.core.io.support.PropertiesLoaderSupport.loadProperties(PropertiesLoaderSupport.java:177)}
&lt;p&gt;DEBUG main 2010-04-14 20:10:14,241 Resolved placeholder &apos;brokerUrl&apos; &lt;/p&gt;
{ org.springframework.util.PropertyPlaceholderHelper.parseStringValue(PropertyPlaceholderHelper.java:143)}
&lt;p&gt;INFO  main 2010-04-14 20:10:14,241 Loading properties file from class path resource &lt;span class=&quot;error&quot;&gt;&amp;#91;msgProperties.xml&amp;#93;&lt;/span&gt; &lt;/p&gt;
{ org.springframework.core.io.support.PropertiesLoaderSupport.loadProperties(PropertiesLoaderSupport.java:177)}</comment>
                            <comment id="54572" author="rhoegg" created="Fri, 11 Jun 2010 04:02:16 +0000"  >&lt;p&gt;I tried changing the order of my PropertyPlaceHolderConfigurers, and confirmed that it is always the one with the highest &quot;order&quot; value that is not found.  A little debugging told me that they are both registered as BeanFactoryPostProcessors, but the exception is thrown while trying to resolve a property from the second one.  This causes the BeanDefinitionStoreException, which aborts initialization before the second one gets to try to resolve the property.&lt;/p&gt;

&lt;p&gt;I was able to get this working by adding ignoreUnresolvablePlaceholders=&quot;true&quot;, but I had to add it to ALL the PropertyPlaceHolderConfigurers in my application.  If even one of them does not ignoreUnresolvablePlaceholders, you will get the BeanDefinitionStoreException.&lt;/p&gt;</comment>
                            <comment id="67962" author="cbeams" created="Sat, 2 Jul 2011 01:41:38 +0000"  >&lt;p&gt;Gisbert, all,&lt;/p&gt;

&lt;p&gt;Indeed the configuration described here does cause the reported exception, however I&apos;m resolving this as &quot;Works as Designed&quot; for reasons explained below.  Please note that if you read all the way, you&apos;ll find my recommendations as to how to eliminate this problem using Spring 3.1.&lt;/p&gt;


&lt;p&gt;To recap the issue, consider two &lt;tt&gt;PropertyPlaceholderConfigurer&lt;/tt&gt; beans P and Q configured in the same context where &quot;Q&quot; has a $&lt;/p&gt;
{...} placeholder that depends on &quot;P&quot; for replacement.  In such a case, the placeholder replacement for &quot;Q&quot; will fail every time.&lt;br/&gt;
&lt;br/&gt;
The reason for this can be understood by studying the way &lt;tt&gt;AbstractApplicationContext&lt;/tt&gt; collects, sorts and executes &lt;tt&gt;BeanFactoryPostProcessor&lt;/tt&gt; instances.  It begins with a call to &lt;tt&gt;beanFactory.getBeansOfType()&lt;/tt&gt;.  This call requires that all such beans (of type &lt;tt&gt;BFPP&lt;/tt&gt;) be fully instantiated and returned.  This means that all the property values will be evaluated and injected into each new &lt;tt&gt;BFPP&lt;/tt&gt; instance, and immediately so.  This is done before any one &lt;tt&gt;BFPP&lt;/tt&gt; has a chance to visit other beans.  This means that the &quot;Q&quot; bean instance will end up retaining its original, un-replaced ${...}
&lt;p&gt; placeholder &amp;#8211; there was never a chance for &quot;P&quot; to replace it.&lt;/p&gt;

&lt;p&gt;Even though &quot;P&quot; does eventually visit the BeanDefinition of &quot;Q&quot;, this does not matter because the &quot;Q&quot; bean instance has already been created.  Changing the BeanDefinition metadata is moot at that point.&lt;/p&gt;

&lt;p&gt;The question then arises, how shall we fix this problem?  It is certainly possible, given enough careful effort and testing to refactor &lt;tt&gt;BFPP&lt;/tt&gt; handling such that earlier &lt;tt&gt;BFPPs&lt;/tt&gt; are capable of modifying subsequent &lt;tt&gt;BFPPs&lt;/tt&gt; at the level of bean definition metadata.&lt;/p&gt;

&lt;p&gt;However, given the critical and non-trivial nature of the code in question, it is not likely worth the risk to &quot;fix&quot; this issue.  Fix is quoted here, because while the behavior described by this issue is unituitive, it is not a bug per se.  It might better be termed an &apos;undocumented limitation&apos;: BFPPs cannot modify other BFPPs bean definition metadata.&lt;/p&gt;

&lt;p&gt;With all that said, the good news is that for Spring 3.1 users there is an alternative approach that might even be considered a superior solution.&lt;/p&gt;

&lt;p&gt;The alternative is to (a) use the new &lt;tt&gt;PropertySourcesPlaceholderConfigurer&lt;/tt&gt; instead of the traditional &lt;tt&gt;PropertyPlaceholderConfigurer&lt;/tt&gt;; (b) eliminate the first PPC; (c) register a &lt;tt&gt;PropertySource&lt;/tt&gt; with the &lt;tt&gt;ApplicationContext&lt;/tt&gt;&apos;s &lt;tt&gt;Environment&lt;/tt&gt; that contains the properties for the placeholders that need replacement in the &lt;tt&gt;PropertySourcesPlaceholderConfigurer&lt;/tt&gt;, such as $&lt;/p&gt;
{resourceDirPlaceHolder}
&lt;p&gt; from your original example.&lt;/p&gt;

&lt;p&gt;To demonstrate this, I&apos;ve added a new &quot;&lt;a href=&quot;https://jira.spring.io/browse/SPR-6428&quot; title=&quot;Placeholders not resolved when using multiple PropertyPlaceHolderConfigurers&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPR-6428&quot;&gt;&lt;del&gt;SPR-6428&lt;/del&gt;&lt;/a&gt;&quot; directory to the &lt;tt&gt;spring-framework-issues&lt;/tt&gt; repository at Github.&lt;/p&gt;

&lt;p&gt;You&apos;re welcome to check this repository out and build the &lt;a href=&quot;https://jira.spring.io/browse/SPR-6428&quot; title=&quot;Placeholders not resolved when using multiple PropertyPlaceHolderConfigurers&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPR-6428&quot;&gt;&lt;del&gt;SPR-6428&lt;/del&gt;&lt;/a&gt; project with Maven / import it into your IDE to see a working example of the workaround to this issue.&lt;/p&gt;

&lt;p&gt;See &lt;a href=&quot;https://github.com/SpringSource/spring-framework-issues#readme&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/SpringSource/spring-framework-issues#readme&lt;/a&gt; for instructions.&lt;/p&gt;

&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Chris&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="26496">SPR-5719</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10020">
                    <name>Related</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="26496">SPR-5719</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="15954" name="multiplePPCs.zip" size="4956" author="gizit" created="Mon, 23 Nov 2009 22:41:01 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_10180" key="com.atlassian.jira.toolkit:dayslastcommented">
                        <customfieldname>Days since last comment</customfieldname>
                        <customfieldvalues>
                                        5 years, 25 weeks, 5 days ago
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10170" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>First Response Date</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 14 Apr 2010 01:44:51 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10181" key="com.atlassian.jira.toolkit:lastusercommented">
                        <customfieldname>Last commented by a User</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>true</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10182" key="com.atlassian.jira.toolkit:lastupdaterorcommenter">
                        <customfieldname>Last updater</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>tmarshall</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10880" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i039zz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10380" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>19162</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_10171" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>