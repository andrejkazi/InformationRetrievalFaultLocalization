<!-- 
RSS generated by JIRA (6.4.11#64026-sha1:78f6ec473a3f058bd5d6c30e9319c7ab376bdb9c) at Thu Dec 22 17:55:17 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://jira.spring.io/si/jira.issueviews:issue-xml/SPR-1760/SPR-1760.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>Spring JIRA</title>
    <link>https://jira.spring.io</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.4.11</version>
        <build-number>64026</build-number>
        <build-date>25-08-2015</build-date>
    </build-info>

<item>
            <title>[SPR-1760] Select Tag Misinterpreting items attribute type</title>
                <link>https://jira.spring.io/browse/SPR-1760</link>
                <project id="10000" key="SPR">Spring Framework</project>
                    <description>&lt;p&gt;Hello,&lt;/p&gt;

&lt;p&gt;The spring-form:select tag is somehow interpreting the value for the items parameter as a string always.  This string has as a value to toString() result from the object intended to be the value for items.&lt;/p&gt;

&lt;p&gt;Example:&lt;/p&gt;

&lt;p&gt;&amp;lt;% out.print(request.getAttribute(&quot;phoneNumberTypes&quot;).getClass().isArray()); %&amp;gt;&lt;br/&gt;
&amp;lt;c:forEach items=&quot;$&lt;/p&gt;
{phoneNumberTypes}&quot; var=&quot;p&quot;&amp;gt;&lt;br/&gt;
${p }&lt;br/&gt;
&amp;lt;/c:forEach&amp;gt;&lt;br/&gt;
&amp;lt;spring-form:select items=&quot;${phoneNumberTypes}
&lt;p&gt;&quot; path=&quot;phoneNumbers[$&lt;/p&gt;
{loop.index}
&lt;p&gt;].type&quot; /&amp;gt;&lt;/p&gt;

&lt;p&gt;The manual iteration through phoneNumberTypes works great, as c:forEach understands that is is an array.&lt;br/&gt;
However, when given to spring-form:select, we get the error:&lt;/p&gt;

&lt;p&gt;javax.servlet.jsp.JspException: Property &apos;items&apos; must be of type &apos;java.util.Collection&apos;, array, or &apos;java.util.Map&apos;.  You specified a &apos;java.lang.String&apos;.&lt;br/&gt;
	org.springframework.web.servlet.tags.form.SelectTag.writeTagContent(SelectTag.java:167)&lt;br/&gt;
	org.springframework.web.servlet.tags.form.AbstractFormTag.doStartTagInternal(AbstractFormTag.java:81)&lt;/p&gt;

&lt;p&gt;(I added some extra debugging there in the error message)&lt;/p&gt;

&lt;p&gt;Running this through the debugger, phoneNumberTypes is (in this case) the string &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;HOME,CELL,WORK&amp;#93;&lt;/span&gt;&quot;, which is the toString() on an ArrayList.&lt;/p&gt;</description>
            <key id="13453">SPR-1760</key>
            <summary>Select Tag Misinterpreting items attribute type</summary>
                <type id="1" iconUrl="https://jira.spring.io/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://jira.spring.io/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://jira.spring.io/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="robh">Rob Harrop</assignee>
                                    <reporter username="sethladd">Seth Ladd</reporter>
                        <labels>
                    </labels>
                <created>Sat, 4 Mar 2006 11:08:32 +0000</created>
                <updated>Tue, 19 Jun 2012 03:54:32 +0000</updated>
                            <resolved>Tue, 21 Mar 2006 22:18:44 +0000</resolved>
                                    <version>2.0 M3</version>
                                    <fixVersion>2.0 M4</fixVersion>
                                    <component>Web</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                <comments>
                            <comment id="16662" author="robh" created="Sun, 5 Mar 2006 20:21:27 +0000"  >&lt;p&gt;I added testWithResolvedStringArray() to SelectTagTests that should have highlighted the fix for this. Can you test it and see if it works?&lt;/p&gt;

&lt;p&gt;Rob&lt;/p&gt;</comment>
                            <comment id="16716" author="juergen.hoeller" created="Tue, 7 Mar 2006 22:11:42 +0000"  >&lt;p&gt;I consider this as fixed for the time being. To be reopened if there any remaining issues.&lt;/p&gt;

&lt;p&gt;Juergen&lt;/p&gt;</comment>
                            <comment id="16789" author="vsonnathi" created="Mon, 13 Mar 2006 15:56:47 +0000"  >&lt;p&gt;Hi,&lt;/p&gt;

&lt;p&gt;It still seems to be not working, $&lt;/p&gt;
{countries}
&lt;p&gt; which is an ArrayList is convert to string: Country@1a8fb1b and it is trying to eval that in the selectTag and I get the following exception: &lt;br/&gt;
javax.servlet.jsp.JspException: Property &apos;items&apos; must be of type &apos;java.util.Collection&apos;.&lt;br/&gt;
	org.springframework.web.servlet.tags.form.SelectTag.writeTagContent(SelectTag.java:167)&lt;br/&gt;
	org.springframework.web.servlet.tags.form.AbstractFormTag.doStartTagInternal(AbstractFormTag.java:81)&lt;br/&gt;
	org.springframework.web.servlet.tags.RequestContextAwareTag.doStartTag(RequestContextAwareTag.java:68)&lt;br/&gt;
	org.apache.jsp.index_jsp._jspx_meth_form_select_0(org.apache.jsp.index_jsp:321)&lt;br/&gt;
	org.apache.jsp.index_jsp._jspService(org.apache.jsp.index_jsp:175)&lt;br/&gt;
	org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:97)&lt;br/&gt;
	javax.servlet.http.HttpServlet.service(HttpServlet.java:802)&lt;/p&gt;

&lt;p&gt;Thanks,&lt;br/&gt;
--Venkat.&lt;/p&gt;</comment>
                            <comment id="16790" author="sethladd" created="Mon, 13 Mar 2006 16:01:22 +0000"  >&lt;p&gt;Good, I&apos;m glad it wasn&apos;t just me. &lt;img class=&quot;emoticon&quot; src=&quot;https://jira.spring.io/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;  If I had to guess, I think the problem is in the way the TLD is written?  I only say this because Rob&apos;s tests are working.  I haven&apos;t had a chance to look into it.&lt;/p&gt;

&lt;p&gt;How does one re-open a bug with this JIRA instance?  Not sure how to flag this issue as &quot;Not Fixed&quot;.&lt;/p&gt;</comment>
                            <comment id="16791" author="vsonnathi" created="Mon, 13 Mar 2006 16:12:13 +0000"  >&lt;p&gt;I looked at it further... JSP is evaluating the $&lt;/p&gt;
{countries} and converting it to String (toString on ArrayList) since the method is setItems(String) on the SelectTag class. I tried mucking with the tld file to say not to expect runtimevalue and passed ${countries}
&lt;p&gt; and it says cannot pass run-time expressions..&lt;/p&gt;

&lt;p&gt;I looked a bind tag and it takes plain string and then does special to evaulate. If I pass plain string to items it chokes again since it is expected ${ to be present in the variable to evaluate it  but when ${ is present the JSP evaluater replaces that with the actual value converted to string...&lt;/p&gt;

&lt;p&gt;Hope this is useful....&lt;/p&gt;

&lt;p&gt;Regards,&lt;br/&gt;
--Venkat.&lt;/p&gt;</comment>
                            <comment id="16817" author="srankin" created="Tue, 14 Mar 2006 03:01:54 +0000"  >&lt;p&gt;Seth or Venkat - are you using JSP 2.0?  &lt;/p&gt;</comment>
                            <comment id="16818" author="srankin" created="Tue, 14 Mar 2006 03:12:59 +0000"  >&lt;p&gt;The issue is that the tag is expecting the string &quot;$&lt;/p&gt;
{itemCollection}&quot; as the value passed to setItems.  However, in JSP 2.0, since you can use EL anywhere, that &quot;${itemCollection}
&lt;p&gt;&quot; is getting evaluated as itemCollection.toString() &lt;b&gt;before&lt;/b&gt; getting passed to the SelectTag class.  So either the tag needs to be changed to expect just a literal string that it then passes to findAttribute() or the setter needs to be changed to accept java.util.Collection. Of course, this prevents it from being used with arrays or maps... but that&apos;s a different problem. &lt;/p&gt;</comment>
                            <comment id="16820" author="sethladd" created="Tue, 14 Mar 2006 04:20:25 +0000"  >&lt;p&gt;Yup, JSP 2.0&lt;/p&gt;</comment>
                            <comment id="16823" author="srankin" created="Tue, 14 Mar 2006 06:17:03 +0000"  >&lt;p&gt;Updated tag file - changed the &quot;items&quot; attribute to &quot;itemAttribute&quot; and changed the code to use pageContext.findAttribute to look up the collection of items&lt;/p&gt;</comment>
                            <comment id="16824" author="srankin" created="Tue, 14 Mar 2006 06:17:58 +0000"  >&lt;p&gt;Changed to reflect changes in the SelectTag code, namely to pass the itemAttribute option rather than the items option. &lt;/p&gt;</comment>
                            <comment id="16825" author="srankin" created="Tue, 14 Mar 2006 06:18:50 +0000"  >&lt;p&gt;Changed attribute name from items to itemAttribute&lt;/p&gt;</comment>
                            <comment id="16858" author="paul.misner" created="Fri, 17 Mar 2006 14:36:35 +0000"  >&lt;p&gt;I see the same problem.  I am running my tests under Tomcat 5.5.6 currently, and the value I entered appears to be getting converted to a string, even from the current CVS version.  This appears to be strictly related to JSP 2.0, as was commented on above.  I&apos;ve had to change some tags I defined to take in the converted collections rather than performing the expression processing inside my tag.&lt;/p&gt;</comment>
                            <comment id="16871" author="robh" created="Sun, 19 Mar 2006 23:39:45 +0000"  >&lt;p&gt;Reopening since the problem has been highlighted now. &lt;/p&gt;</comment>
                            <comment id="16887" author="robh" created="Tue, 21 Mar 2006 01:17:00 +0000"  >&lt;p&gt;All,&lt;/p&gt;

&lt;p&gt;I updated select, radio and checkbox today so that setItems takes Object rather than String. This allows for the case where a JSP 2.0 expression is evaluated &lt;b&gt;before&lt;/b&gt; the tag gets control. Now expression evaluation is only attempted if we get a String passed in.&lt;/p&gt;

&lt;p&gt;Please try out a build from HEAD and let me know how this works out for you. I extended the test suite to cover these cases as well.&lt;/p&gt;

&lt;p&gt;Rob&lt;/p&gt;</comment>
                            <comment id="16908" author="vsonnathi" created="Tue, 21 Mar 2006 16:23:40 +0000"  >&lt;p&gt;It works fine now. However I want to be able to specify an additional option which prompts the user to select for e.g.:&lt;/p&gt;

&lt;p&gt;&amp;lt;form:select path=&quot;countryCode&quot; items=&quot;$&lt;/p&gt;
{activeSeminarCountries}&quot;&lt;br/&gt;
                                itemValue=&quot;countryCode&quot; itemLabel=&quot;countryName&quot; onchange=&quot;showSeminars();&quot;&amp;gt;&lt;br/&gt;
     &amp;lt;form:option value=&quot;&quot;&amp;gt;- Select -&amp;lt;/form:option&amp;gt;&lt;br/&gt;
&amp;lt;/form:select&amp;gt;&lt;br/&gt;
&lt;br/&gt;
But the form:select tag does not expose the property for the form:option to work correctly. &lt;br/&gt;
&lt;br/&gt;
Any suggestions on how to implement the above I tried &lt;br/&gt;
&amp;lt;form:select path=&quot;countryCode&quot; items=&quot;${activeSeminarCountries}
&lt;p&gt;&quot;&lt;br/&gt;
                                itemValue=&quot;countryCode&quot; itemLabel=&quot;countryName&quot; onchange=&quot;showSeminars();&quot;&amp;gt;&lt;br/&gt;
   &amp;lt;option value=&quot;&quot;&amp;gt;- Select -&amp;lt;/option&amp;gt;&lt;br/&gt;
&amp;lt;/form:select&amp;gt;&lt;/p&gt;

&lt;p&gt;This did not work the &amp;lt;option&amp;gt; tag manually inserted was rendered outside the &amp;lt;/select&amp;gt; tag.&lt;/p&gt;

&lt;p&gt;Thanks,&lt;br/&gt;
--Venkat.&lt;/p&gt;</comment>
                            <comment id="16911" author="robh" created="Tue, 21 Mar 2006 22:18:09 +0000"  >&lt;p&gt;Venkat,&lt;/p&gt;

&lt;p&gt;The easiest way to get that to work would be to extend the source list with an additional entry at the beginning. What I will do is create a &amp;lt;form:options/&amp;gt; tag for nesting so you can do something like this:&lt;/p&gt;

&lt;p&gt;&amp;lt;form:select&amp;gt;&lt;br/&gt;
  &amp;lt;form:option label=&quot;Please select&quot;/&amp;gt;&lt;br/&gt;
  &amp;lt;form:options list=&quot;$&lt;/p&gt;
{countries}
&lt;p&gt;&quot;/&amp;gt;&lt;br/&gt;
&amp;lt;/form:select&amp;gt;&lt;/p&gt;

&lt;p&gt;I&apos;ve opened &lt;a href=&quot;https://jira.spring.io/browse/SPR-1808&quot; title=&quot;Add &amp;lt;form:options/&amp;gt; tag.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPR-1808&quot;&gt;&lt;del&gt;SPR-1808&lt;/del&gt;&lt;/a&gt; to track this new feature.&lt;/p&gt;

&lt;p&gt;Rob&lt;/p&gt;</comment>
                            <comment id="16912" author="robh" created="Tue, 21 Mar 2006 22:18:44 +0000"  >&lt;p&gt;Thanks for Venkat for confirming this fix works &lt;img class=&quot;emoticon&quot; src=&quot;https://jira.spring.io/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="16915" author="vsonnathi" created="Wed, 22 Mar 2006 00:21:48 +0000"  >&lt;p&gt;Rob,&lt;/p&gt;

&lt;p&gt;Thanks for &lt;a href=&quot;https://jira.spring.io/browse/SPR-1808&quot; title=&quot;Add &amp;lt;form:options/&amp;gt; tag.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPR-1808&quot;&gt;&lt;del&gt;SPR-1808&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Regards,&lt;br/&gt;
--Venkat.&lt;/p&gt;</comment>
                            <comment id="16992" author="mbenson" created="Mon, 27 Mar 2006 06:26:01 +0000"  >&lt;p&gt;Don&apos;t know if there&apos;s another way around this, but I am running WAS 5.x (trust me, not my idea) and get NoSuchMethodError with the recent switch from String-&amp;gt;Object.  I was using &amp;lt;form:select items=&quot;$&lt;/p&gt;
{foo}
&lt;p&gt;&quot; /&amp;gt; (again, this is a JSP 1.0 container).   Hacking into SelectTag thus:&lt;/p&gt;

&lt;p&gt;public void setItems(String items) {&lt;br/&gt;
        setItems((Object) items);&lt;br/&gt;
}&lt;/p&gt;

&lt;p&gt;solved my problem.  Anybody know a prettier way to make this work here?&lt;/p&gt;

&lt;p&gt;-Matt&lt;/p&gt;</comment>
                            <comment id="17053" author="mbenson" created="Mon, 3 Apr 2006 02:57:46 +0000"  >&lt;p&gt;Adding a comment here to document that the above issue does not exist.  To my shame, Rob has correctly guessed that my issue was caused by a non-recompiled JSP.  &lt;img class=&quot;emoticon&quot; src=&quot;https://jira.spring.io/images/icons/emoticons/sad.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="11503" name="SelectTag.java" size="9781" author="srankin" created="Tue, 14 Mar 2006 06:17:03 +0000"/>
                            <attachment id="11504" name="SelectTagTests.java" size="6515" author="srankin" created="Tue, 14 Mar 2006 06:17:58 +0000"/>
                            <attachment id="11505" name="spring-form.tld" size="27881" author="srankin" created="Tue, 14 Mar 2006 06:18:50 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_10180" key="com.atlassian.jira.toolkit:dayslastcommented">
                        <customfieldname>Days since last comment</customfieldname>
                        <customfieldvalues>
                                        10 years, 39 weeks, 3 days ago
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10170" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>First Response Date</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Sun, 5 Mar 2006 20:21:27 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10181" key="com.atlassian.jira.toolkit:lastusercommented">
                        <customfieldname>Last commented by a User</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>true</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10182" key="com.atlassian.jira.toolkit:lastupdaterorcommenter">
                        <customfieldname>Last updater</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>tmarshall</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10880" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i019jb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10380" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>7422</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_10171" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>