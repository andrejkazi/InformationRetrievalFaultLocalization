<!-- 
RSS generated by JIRA (6.4.11#64026-sha1:78f6ec473a3f058bd5d6c30e9319c7ab376bdb9c) at Thu Dec 22 19:47:33 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://jira.spring.io/si/jira.issueviews:issue-xml/SPR-821/SPR-821.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>Spring JIRA</title>
    <link>https://jira.spring.io</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.4.11</version>
        <build-number>64026</build-number>
        <build-date>25-08-2015</build-date>
    </build-info>

<item>
            <title>[SPR-821] LocalDataSourceJobStore setting a TX datasource for nonManagedTXDataSource</title>
                <link>https://jira.spring.io/browse/SPR-821</link>
                <project id="10000" key="SPR">Spring Framework</project>
                    <description>&lt;p&gt;Quartz requires a non managed TX datasource to be set (nonManagedTXDataSource) when using JobStoreCMT. Spring uses the same datasource for the managed and non-managed transactional datasources. This causes Quartz to fail upon init using strict XADataSource drivers (WebLogic/WebSphere).&lt;/p&gt;

&lt;p&gt;Exception:&lt;br/&gt;
org.quartz.JobPersistenceException: Failed to obtain DB connection from data source &apos;springNonTxDataSource&apos;: java.sql.SQLException: SQL operations are not allowed with no global transaction by default for XA drivers. If the XA driver supports performing SQL operations with no global transaction, explicitly allow it by setting &quot;SupportsLocalTransaction&quot; JDBC connection pool property to true. In this case, also remember to complete the local transaction before using the connection again for global transaction, else a XAER_OUTSIDE XAException may result. To complete a local transaction, you can either set auto commit to true or call Connection.commit() or Connection.rollback(). &lt;span class=&quot;error&quot;&gt;&amp;#91;See nested exception: java.sql.SQLException: SQL operations are not allowed with no global transaction by default for XA drivers. If the XA driver supports performing SQL operations with no global transaction, explicitly allow it by setting &amp;quot;SupportsLocalTransaction&amp;quot; JDBC connection pool property to true. In this case, also remember to complete the local transaction before using the connection again for global transaction, else a XAER_OUTSIDE XAException may result. To complete a local transaction, you can either set auto commit to true or call Connection.commit() or Connection.rollback().&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at org.quartz.impl.jdbcjobstore.JobStoreCMT.getNonManagedTXConnection(JobStoreCMT.java:1402)&lt;br/&gt;
	at org.quartz.impl.jdbcjobstore.JobStoreCMT.cleanVolatileTriggerAndJobs(JobStoreCMT.java:216)&lt;br/&gt;
	at org.quartz.impl.jdbcjobstore.JobStoreSupport.initialize(JobStoreSupport.java:501)&lt;br/&gt;
	at org.quartz.impl.jdbcjobstore.JobStoreCMT.initialize(JobStoreCMT.java:150)&lt;br/&gt;
	at org.springframework.scheduling.quartz.LocalDataSourceJobStore.initialize(LocalDataSourceJobStore.java:118)&lt;br/&gt;
	at org.quartz.impl.StdSchedulerFactory.instantiate(StdSchedulerFactory.java:915)&lt;br/&gt;
	at org.quartz.impl.StdSchedulerFactory.getScheduler(StdSchedulerFactory.java:1047)&lt;br/&gt;
	at org.springframework.scheduling.quartz.SchedulerFactoryBean.createScheduler(SchedulerFactoryBean.java:543)&lt;br/&gt;
	at org.springframework.scheduling.quartz.SchedulerFactoryBean.afterPropertiesSet(SchedulerFactoryBean.java:494)&lt;/p&gt;

&lt;p&gt;More info, see:&lt;br/&gt;
&lt;a href=&quot;http://wiki.opensymphony.com/display/QRTZ1/ConfigJobStoreCMT&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://wiki.opensymphony.com/display/QRTZ1/ConfigJobStoreCMT&lt;/a&gt;&lt;/p&gt;</description>
            <key id="11316">SPR-821</key>
            <summary>LocalDataSourceJobStore setting a TX datasource for nonManagedTXDataSource</summary>
                <type id="1" iconUrl="https://jira.spring.io/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://jira.spring.io/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://jira.spring.io/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="juergen.hoeller">Juergen Hoeller</assignee>
                                    <reporter username="pathos">Mathias Bogaert</reporter>
                        <labels>
                    </labels>
                <created>Thu, 24 Mar 2005 19:37:24 +0000</created>
                <updated>Thu, 24 Mar 2005 21:17:48 +0000</updated>
                            <resolved>Thu, 24 Mar 2005 21:17:48 +0000</resolved>
                                    <version>1.2 RC1</version>
                                    <fixVersion>1.2 RC1</fixVersion>
                                    <component>Transaction</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12697" author="juergen.hoeller" created="Thu, 24 Mar 2005 21:10:22 +0000"  >&lt;p&gt;I guess that XA DataSource can be configured to support local transactions in almost all application servers. But anyway, you&apos;ve got a point there: SchedulerFactoryBean should allow for an explicit non-transactional DataSource to be specified.&lt;/p&gt;

&lt;p&gt;Consequently, I&apos;ve added a &quot;nonTransactionalDataSource&quot; property for this, which is optional: If not set, the default DataSource will be used there too. When working with a non-XA DataSource and Spring transactions, a single default DataSource is always sufficient. In the XA/JTA case, it&apos;s recommendable to explicitly specify a non-transactional version of the DataSource.&lt;/p&gt;

&lt;p&gt;Juergen&lt;/p&gt;</comment>
                            <comment id="12698" author="juergen.hoeller" created="Thu, 24 Mar 2005 21:17:00 +0000"  >&lt;p&gt;As a side note: You could of course use the default Quartz JobStoreCMT class directly, with JNDI DataSources. Spring does not get in your way there. All you&apos;d need to do is specify the corresponding standard Quartz properties as &quot;quartzProperties&quot; on SchedulerFactoryBean, or in a quartz.properties file (specified as &quot;configLocation&quot;).&lt;/p&gt;

&lt;p&gt;The main point of LocalDataSourceJobStore was, well, to support a local Spring DataSource as job store for Quartz, usually in combination with Spring transactions. LocalDataSourceJobStore is now fully usable for XA/JTA too, passing in local DataSource references that will usually point to JNDI DataSources.&lt;/p&gt;

&lt;p&gt;In that respect, the priority &quot;Critical&quot; should probably be lowered to &quot;Major&quot;, as this was essentially about a limitation of an optional convenience that Spring offers.&lt;/p&gt;

&lt;p&gt;Juergen&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_10180" key="com.atlassian.jira.toolkit:dayslastcommented">
                        <customfieldname>Days since last comment</customfieldname>
                        <customfieldvalues>
                                        11 years, 40 weeks, 6 days ago
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10170" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>First Response Date</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 24 Mar 2005 21:10:22 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10181" key="com.atlassian.jira.toolkit:lastusercommented">
                        <customfieldname>Last commented by a User</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>false</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10182" key="com.atlassian.jira.toolkit:lastupdaterorcommenter">
                        <customfieldname>Last updater</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>tmarshall</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10880" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i046v3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10380" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>24486</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_10171" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>