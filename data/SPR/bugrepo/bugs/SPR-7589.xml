<!-- 
RSS generated by JIRA (6.4.11#64026-sha1:78f6ec473a3f058bd5d6c30e9319c7ab376bdb9c) at Thu Dec 22 18:36:12 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://jira.spring.io/si/jira.issueviews:issue-xml/SPR-7589/SPR-7589.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>Spring JIRA</title>
    <link>https://jira.spring.io</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.4.11</version>
        <build-number>64026</build-number>
        <build-date>25-08-2015</build-date>
    </build-info>

<item>
            <title>[SPR-7589] Determination of the best pattern match to map a handler to an URL</title>
                <link>https://jira.spring.io/browse/SPR-7589</link>
                <project id="10000" key="SPR">Spring Framework</project>
                    <description>&lt;p&gt;Hi people,&lt;/p&gt;

&lt;p&gt;I might have found an odd behavior in the AbstractUrlHandlerMapping class : given two controllers, one annotated with @RequestMapping(&quot;/**&quot;) and the another one annotated with @RequestMapping(&quot;/access/&lt;/p&gt;
{resourceType}
&lt;p&gt;/&lt;/p&gt;
{resourceSubType}
&lt;p&gt;/&lt;/p&gt;
{resourceName}
&lt;p&gt;&quot;), when the path &quot;/access/document/text/sometextdocument&quot; is evaluated I would expect the second controller to be chosen to handle the request but it is the first one that is taken.&lt;/p&gt;

&lt;p&gt;Looking at the code of AbstractUrlHandlerMapping.lookupHandler() one can see that when several patterns are found that match the path, they are ordered using an AntPatternComparator to find the most pertinent one for it. Digging in further, this comparator orders patterns based on their level of incertitude, counting the occurrences of wildcards and brackets. In my opinion it should read patterns as we do (i.e. from left to right in our countries) to see if the pattern start makes it more suitable to handle the path that is evaluated.&lt;/p&gt;

&lt;p&gt;I attached a JUnit test to illustrate my point.&lt;/p&gt;

&lt;p&gt;Thanks&lt;/p&gt;</description>
            <key id="33494">SPR-7589</key>
            <summary>Determination of the best pattern match to map a handler to an URL</summary>
                <type id="1" iconUrl="https://jira.spring.io/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="4" iconUrl="https://jira.spring.io/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://jira.spring.io/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="3">Duplicate</resolution>
                                        <assignee username="bclozel">Brian Clozel</assignee>
                                    <reporter username="ndemengel">Nicolas Demengel</reporter>
                        <labels>
                    </labels>
                <created>Fri, 24 Sep 2010 01:34:57 +0000</created>
                <updated>Mon, 5 May 2014 10:05:58 +0000</updated>
                            <resolved>Mon, 5 May 2014 10:05:58 +0000</resolved>
                                    <version>3.0.4</version>
                                                    <component>Web</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="64382" author="aewhite" created="Wed, 16 Mar 2011 05:47:37 +0000"  >&lt;p&gt;I just got bit by this bug as well. The ant comparator seems to make assumptions about the specificness of a match prematurely based only on the number of wildcards/brackets. For example...&lt;/p&gt;

&lt;p&gt;Given the request /user/id/property/value the comparator will rank the following patters in the following order &lt;/p&gt;

&lt;p&gt;1) /user/**/&lt;/p&gt;
{a}/{b}               &amp;lt;-- Because it only has 2 brackets&lt;br/&gt;
2) /user/**/{a}
&lt;p&gt;/&lt;/p&gt;
{b}
&lt;p&gt;/property/&lt;/p&gt;
{c}
&lt;p&gt;  &amp;lt;-- vs 3 brackets here&lt;/p&gt;

&lt;p&gt;However, it seems clear that (2) is more specific. Namely because it has more brackets that are assignable given the input.&lt;/p&gt;

&lt;p&gt;For now, what is the best workaround? Simply avoid these patters (can be hard to do in some cases)? Is there a way to inject an alternate comparator?&lt;/p&gt;</comment>
                            <comment id="64385" author="ndemengel" created="Wed, 16 Mar 2011 06:23:49 +0000"  >&lt;p&gt;Hi Andrew,&lt;/p&gt;

&lt;p&gt;I&apos;m the original reporter of this bug. As far as I remember I could not found any way to inject an alternate comparator (or maybe I didn&apos;t want to...), but as you can see in the attached java file I could find a workaround. It&apos;s ugly but it worked for me. In your case it would consist in rewriting &quot;/user/**/&lt;/p&gt;
{a}/{b}&quot; to become &quot;/user/*&lt;b&gt;/&lt;/b&gt;*/{a}
&lt;p&gt;/&lt;/p&gt;
{b}
&lt;p&gt;&quot;. As &quot;*&lt;b&gt;&quot; and &quot;&lt;/b&gt;&lt;b&gt;/&lt;/b&gt;*&quot; evaluates in the same way, it does not change the meaning of your mapping, but it does increase the number of stars thus making this mapping less likely to be used .&lt;/p&gt;

&lt;p&gt;Regards,&lt;br/&gt;
Nicolas&lt;/p&gt;</comment>
                            <comment id="64386" author="ndemengel" created="Wed, 16 Mar 2011 06:27:38 +0000"  >&lt;p&gt;It looks like my stars were interpreted as formatting characters. Here is the correction:&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;In your case it would consist in rewriting &lt;p/&gt;
&lt;div id=&quot;syntaxplugin&quot; class=&quot;syntaxplugin&quot; style=&quot;border: 1px dashed #bbb; border-radius: 5px !important; overflow: auto; max-height: 30em;&quot;&gt;
&lt;table cellspacing=&quot;0&quot; cellpadding=&quot;0&quot; border=&quot;0&quot; width=&quot;100%&quot; style=&quot;font-size: 1em; line-height: 1.4em !important; font-weight: normal; font-style: normal; color: black;&quot;&gt;
		&lt;tbody &gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;  margin-top: 10px;   margin-bottom: 10px;  width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;/user/**/{a}/{b}&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
			&lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;p/&gt; to become &lt;p/&gt;
&lt;div id=&quot;syntaxplugin&quot; class=&quot;syntaxplugin&quot; style=&quot;border: 1px dashed #bbb; border-radius: 5px !important; overflow: auto; max-height: 30em;&quot;&gt;
&lt;table cellspacing=&quot;0&quot; cellpadding=&quot;0&quot; border=&quot;0&quot; width=&quot;100%&quot; style=&quot;font-size: 1em; line-height: 1.4em !important; font-weight: normal; font-style: normal; color: black;&quot;&gt;
		&lt;tbody &gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;  margin-top: 10px;   margin-bottom: 10px;  width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;/user/**/**/{a}/{b}&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
			&lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;p/&gt;. As &lt;p/&gt;
&lt;div id=&quot;syntaxplugin&quot; class=&quot;syntaxplugin&quot; style=&quot;border: 1px dashed #bbb; border-radius: 5px !important; overflow: auto; max-height: 30em;&quot;&gt;
&lt;table cellspacing=&quot;0&quot; cellpadding=&quot;0&quot; border=&quot;0&quot; width=&quot;100%&quot; style=&quot;font-size: 1em; line-height: 1.4em !important; font-weight: normal; font-style: normal; color: black;&quot;&gt;
		&lt;tbody &gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;  margin-top: 10px;   margin-bottom: 10px;  width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;**&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
			&lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;p/&gt; and &lt;p/&gt;
&lt;div id=&quot;syntaxplugin&quot; class=&quot;syntaxplugin&quot; style=&quot;border: 1px dashed #bbb; border-radius: 5px !important; overflow: auto; max-height: 30em;&quot;&gt;
&lt;table cellspacing=&quot;0&quot; cellpadding=&quot;0&quot; border=&quot;0&quot; width=&quot;100%&quot; style=&quot;font-size: 1em; line-height: 1.4em !important; font-weight: normal; font-style: normal; color: black;&quot;&gt;
		&lt;tbody &gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;  margin-top: 10px;   margin-bottom: 10px;  width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;**/**&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
			&lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;p/&gt; evaluate in the same way, it does not change the meaning of your mapping, but it does increase the number of stars thus making this mapping less likely to be used .&lt;/p&gt;&lt;/blockquote&gt;</comment>
                            <comment id="64389" author="aewhite" created="Wed, 16 Mar 2011 06:50:43 +0000"  >&lt;p&gt;Thanks, I actually ended up doing something very similar but it&apos;ll nag at me until it&apos;s fixed &lt;img class=&quot;emoticon&quot; src=&quot;https://jira.spring.io/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; I did find out that you can extend the AntPathcerMatcher and override the comparator if needed. However, I have a feeling that making a &quot;correct&quot; comparator will be non trivial so I opted for a the quick fix for now.&lt;/p&gt;

&lt;p&gt;On a side note, it would be nice if Spring at least had a DEBUG log output for the candidates and the resulting order so we don&apos;t have to dig so deep to find the cause of the oddness.&lt;/p&gt;</comment>
                            <comment id="64390" author="aewhite" created="Wed, 16 Mar 2011 06:52:07 +0000"  >&lt;p&gt;I should also add that I am seeing this in 3.0.5 as well. &lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10000">
                    <name>Duplicate</name>
                                            <outwardlinks description="duplicates">
                                        <issuelink>
            <issuekey id="29768">SPR-6741</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10151">
                    <name>Relate</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="39721">SPR-8683</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="17132" name="AntPatternComparatorTest.java" size="1479" author="ndemengel" created="Fri, 24 Sep 2010 01:34:57 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_10180" key="com.atlassian.jira.toolkit:dayslastcommented">
                        <customfieldname>Days since last comment</customfieldname>
                        <customfieldvalues>
                                        5 years, 41 weeks, 1 day ago
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10170" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>First Response Date</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 16 Mar 2011 05:47:37 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10181" key="com.atlassian.jira.toolkit:lastusercommented">
                        <customfieldname>Last commented by a User</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>true</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10182" key="com.atlassian.jira.toolkit:lastupdaterorcommenter">
                        <customfieldname>Last updater</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>bclozel</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10880" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i012t3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10380" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>6332</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_10171" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>