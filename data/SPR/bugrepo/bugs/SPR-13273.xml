<!-- 
RSS generated by JIRA (6.4.11#64026-sha1:78f6ec473a3f058bd5d6c30e9319c7ab376bdb9c) at Thu Dec 22 18:37:21 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://jira.spring.io/si/jira.issueviews:issue-xml/SPR-13273/SPR-13273.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>Spring JIRA</title>
    <link>https://jira.spring.io</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.4.11</version>
        <build-number>64026</build-number>
        <build-date>25-08-2015</build-date>
    </build-info>

<item>
            <title>[SPR-13273] Not able to unit test validations using MockMVC</title>
                <link>https://jira.spring.io/browse/SPR-13273</link>
                <project id="10000" key="SPR">Spring Framework</project>
                    <description>&lt;p&gt;I am starting out on using &lt;tt&gt;MockMvc&lt;/tt&gt;, and I don&apos;t understand why my validations (javax and hibernate) do not execute when I run my unit test.&lt;/p&gt;

&lt;p&gt;Here is the summary : &lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;I have a mvc controller annotated with &lt;tt&gt;@RestController&lt;/tt&gt;. This controller has a method to delete resource.  uri to delete resource is &lt;tt&gt;/myresources/{resourceId&lt;/tt&gt;}. I have given context relative url. This method accepts the Path Parameter in &lt;tt&gt;resourceId&lt;/tt&gt; parameter annotated with &lt;tt&gt;@PathParam&lt;/tt&gt;. Also this parameter is annotated with two other annotations for validating the path parameter.
	&lt;ol&gt;
		&lt;li&gt;&lt;tt&gt;@Pattern&lt;/tt&gt; which is a javax.validation annotation which specifies following pattern:&lt;br/&gt;
&lt;tt&gt;regexp=[0-9]{1,12&lt;/tt&gt;} to accept only 1 to 12 digits as input.&lt;/li&gt;
		&lt;li&gt;it has &lt;tt&gt;@NotBlank&lt;/tt&gt; validation which is org.hibernate validation to check if its not empty.&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;I am building &lt;b&gt;standalone&lt;/b&gt; &lt;tt&gt;MockMvc&lt;/tt&gt; setup and using the &lt;tt&gt;perform&lt;/tt&gt; method to call the url with path parameter.&lt;/p&gt;

&lt;p&gt;Should it not preempt the call by carrying out validation so that it doesn&apos;t reach my method?&lt;/p&gt;

&lt;p&gt;In fact I receive the NumberFormatException in my deleteResource method. I convert Path Parameter resourceId which is a String, into Integer in my deleteResource method..Now if I send resourceId as something which cannot be converted to Integer (e.g. abcd) instead of regular integer it throws NumberFormatException. However it should not reach inside my method  where it throws NumberFormatException.(rather it happens at the first line itself where I convert String into Integer)  if validations are executed as it would pre-empt the call and should return response which indicate validation errors.&lt;/p&gt;

&lt;p&gt;If yes, why is it not working? If no, is this possible in anyway because I want to write a unit test for each of the validations?&lt;/p&gt;

&lt;p&gt;I found similar issue on &lt;a href=&quot;http://stackoverflow.com/questions/27106298/mock-mvc-javax-validation-test&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;Stack Overflow&lt;/a&gt;.&lt;/p&gt;</description>
            <key id="64942">SPR-13273</key>
            <summary>Not able to unit test validations using MockMVC</summary>
                <type id="4" iconUrl="https://jira.spring.io/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://jira.spring.io/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://jira.spring.io/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="3">Duplicate</resolution>
                                        <assignee username="rstoya05-aop">Rossen Stoyanchev</assignee>
                                    <reporter username="ShaileshV">Shailesh Vaishampayan</reporter>
                        <labels>
                    </labels>
                <created>Fri, 24 Jul 2015 04:49:48 +0000</created>
                <updated>Wed, 29 Jul 2015 05:03:40 +0000</updated>
                            <resolved>Tue, 28 Jul 2015 12:46:32 +0000</resolved>
                                                                    <component>Test</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                <comments>
                            <comment id="118033" author="rstoya05-aop" created="Mon, 27 Jul 2015 05:37:10 +0000"  >&lt;p&gt;The SO post indicates a NumberFormatException was raised. The above description says validations do not execute. Can you please update the above description with all the necessary information?&lt;/p&gt;</comment>
                            <comment id="118046" author="shaileshv" created="Mon, 27 Jul 2015 08:40:43 +0000"  >&lt;p&gt;Well.. sorry I didn&apos;t explain it in detail. In fact I also receive the NumberFormatException. In my deleteResource method I convert Path Parameter  resourceId which is a String,  into Integer. Now if I send resourceId as something which cannot be converted to Integer (e.g. abcd) instead of regular integer it throws NumberFormatException. However it should not reach the point in my method where it throws NumberFormatException if validations are executed as it would preempt the call and should return response which indicates Validaiton errors.&lt;/p&gt;

&lt;p&gt;also in the link I have given they are using a bean and annotate it with same validation annotation that I am using like @NotBlank and @Pattern.&lt;/p&gt;

&lt;p&gt;Hope I am clear now.If you need more information please let me know.&lt;/p&gt;

</comment>
                            <comment id="118047" author="shaileshv" created="Mon, 27 Jul 2015 08:45:00 +0000"  >&lt;p&gt;In your MVC showcase GIthub repository you have given example to explain how to write unit tests to validate  parameters . I have not tried that but I took a cue from it and assumed that It should work for PathParameters which are annotated with javax..and hibernate validations as well.  But my assumption seems to fail and would like to know if its possible?&lt;/p&gt;

</comment>
                            <comment id="118051" author="rstoya05-aop" created="Mon, 27 Jul 2015 12:44:31 +0000"  >&lt;p&gt;Okay so the SO link is not your post. I&apos;m afraid I&apos;m not any more clear than before. Please, provide the controller method signature and implementation if relevant (I&apos;m not sure why conversion needs to be performed inside the controller method). Ideally provide a simple &lt;a href=&quot;https://github.com/spring-projects/spring-framework-issues#using-this-repository-to-demonstrate-the-issue&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;repro project&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="118060" author="shaileshv" created="Mon, 27 Jul 2015 23:00:28 +0000"  >&lt;p&gt;Ok I will create a repro project.  As far as the conversion is concerned this will be a distraction from original requirement of unit testing validations (javax and hibernate ) applied to Path parameters. Still will provide info on why conversion is happening inside the method. &lt;br/&gt;
       I understand that for primary key parameters/path parameters  like resourceId  I mentioned here Spring takes care of basic conversions. So resourceId should not be a String in first place. If its Long or Integer Spring will either convert or keep the value Null. And there I have to simply check null. &lt;br/&gt;
      However we have converted this project from old Jersey Project which had this implementation and for strange /weird reasons our architect doesn&apos;t want to change this and wants us to use Strings and apply @Pattern validations on these Parameters. Hence the conversion is happening inside the method. So much about why conversion is  happening inside the method. Anyway thats not the point. &lt;br/&gt;
     What I want is to be able to validate all types of validations (like @NotBlank @NotNull,@Size(min = 1, max = 40),@Pattern) applied on Path Parameters to execute and it should generate appropriate error response which I can validate in my unit test. I guess JSR 330 says it should be 400 Bad Request response if any such validations fail. I am really not concerned about following any standard as such as long as I am able to test against consistent error response when validations fail.&lt;/p&gt;

&lt;p&gt;      I hope I am able to get my points across. Please let me know if they are invalid outright or make sense. Please let me know if you need more information as well. I am anyway creating a repro project for this.&lt;/p&gt;

</comment>
                            <comment id="118080" author="rstoya05-aop" created="Tue, 28 Jul 2015 12:46:14 +0000"  >&lt;p&gt;Ah, I think you&apos;re trying to apply annotation-based validation on @PathParameter in which case this is a duplicate of &lt;a href=&quot;https://jira.spring.io/browse/SPR-6380&quot; title=&quot;Support for javax.validation annotations on @PathVariable, @RequestHeader, @RequestParam&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPR-6380&quot;&gt;SPR-6380&lt;/a&gt; (not resolved) which in turn depends on &lt;a href=&quot;https://jira.spring.io/browse/SPR-11900&quot; title=&quot;Bean Validation invocation API for use with individual values and constraints&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPR-11900&quot;&gt;SPR-11900&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="118102" author="shaileshv" created="Wed, 29 Jul 2015 04:34:44 +0000"  >&lt;p&gt;So if these features are implemented MockMVC also will start giving me validations failure results correct?&lt;/p&gt;</comment>
                            <comment id="118104" author="rstoya05-aop" created="Wed, 29 Jul 2015 05:03:40 +0000"  >&lt;p&gt;Yes.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_10180" key="com.atlassian.jira.toolkit:dayslastcommented">
                        <customfieldname>Days since last comment</customfieldname>
                        <customfieldvalues>
                                        1 year, 21 weeks, 1 day ago
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10170" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>First Response Date</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 27 Jul 2015 05:37:10 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10181" key="com.atlassian.jira.toolkit:lastusercommented">
                        <customfieldname>Last commented by a User</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>false</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10182" key="com.atlassian.jira.toolkit:lastupdaterorcommenter">
                        <customfieldname>Last updater</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>rstoya05-aop</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10880" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i08mlb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10380" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10120" key="com.atlassian.jira.plugin.system.customfieldtypes:url">
                        <customfieldname>Reference URL</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[http://stackoverflow.com/questions/27106298/mock-mvc-javax-validation-test]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10171" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>