<!-- 
RSS generated by JIRA (6.4.11#64026-sha1:78f6ec473a3f058bd5d6c30e9319c7ab376bdb9c) at Thu Dec 22 20:04:55 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://jira.spring.io/si/jira.issueviews:issue-xml/SPR-14302/SPR-14302.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>Spring JIRA</title>
    <link>https://jira.spring.io</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.4.11</version>
        <build-number>64026</build-number>
        <build-date>25-08-2015</build-date>
    </build-info>

<item>
            <title>[SPR-14302] Messages not delivered to all user sessions using distributed topic</title>
                <link>https://jira.spring.io/browse/SPR-14302</link>
                <project id="10000" key="SPR">Spring Framework</project>
                    <description>&lt;p&gt;My app is hosted on multiple servers, each with its own broker. A user can have more than one open session, where each of those sessions are sticky but may be on different servers in the cluster. Clients are connected to the broker via Spring Websocket.&lt;/p&gt;

&lt;p&gt;The problem I&apos;m seeing is when a message is sent to a distributed topic user destination.&lt;/p&gt;

&lt;p&gt;Expected:&lt;br/&gt;
The message would be relayed to all the brokers in the cluster, so that all of the sessions open for that user (regardless of the app server hosting the session) would receive the message.&lt;/p&gt;

&lt;p&gt;Observed:&lt;br/&gt;
If there are any sessions for the user open on the app server that&apos;s executing the send, the message will only be delivered to to those sessions and will not be relayed to the other brokers in the cluster.&lt;/p&gt;</description>
            <key id="68729">SPR-14302</key>
            <summary>Messages not delivered to all user sessions using distributed topic</summary>
                <type id="1" iconUrl="https://jira.spring.io/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="4" iconUrl="https://jira.spring.io/images/icons/priorities/minor.png">Minor</priority>
                        <status id="5" iconUrl="https://jira.spring.io/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="3">Duplicate</resolution>
                                        <assignee username="rstoya05-aop">Rossen Stoyanchev</assignee>
                                    <reporter username="dsmeyer">Derek Meyer</reporter>
                        <labels>
                            <label>Distributed-user-sessions</label>
                            <label>Spring</label>
                            <label>userSessionRegistry</label>
                            <label>websockets</label>
                    </labels>
                <created>Tue, 24 May 2016 15:27:13 +0000</created>
                <updated>Fri, 27 May 2016 17:44:44 +0000</updated>
                            <resolved>Fri, 27 May 2016 17:44:44 +0000</resolved>
                                    <version>4.2.6</version>
                                                    <component>Messaging:WebSocket</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                <comments>
                            <comment id="129523" author="dsmeyer" created="Tue, 24 May 2016 15:30:10 +0000"  >&lt;p&gt;I think the code responsible for this behavior is at UserDestinationMessageHandler line 201 (4.2.6.RELEASE). Perhaps the broadcastHandler should be given the message regardless of whether there are local target destinations?&lt;/p&gt;

&lt;p&gt;Does this behavior need to differ depending on the type of the target - queue vs topic?&lt;/p&gt;</comment>
                            <comment id="129539" author="rstoya05-aop" created="Wed, 25 May 2016 20:38:26 +0000"  >&lt;blockquote&gt;&lt;p&gt;app is hosted on multiple servers, each with its own broker&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I presume this means you&apos;re using the simple broker with each server? The simpler broker is only aware of users connected locally, i.e. on the same server. &lt;/p&gt;

&lt;p&gt;The broker relay which connects to an external, shared broker supports multi-server scenarios. We fixed an issue in this area recently (see &lt;a href=&quot;https://jira.spring.io/browse/SPR-13800&quot; title=&quot;Users logged in to multiple servers do not get messages in sessions on remote servers&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPR-13800&quot;&gt;&lt;del&gt;SPR-13800&lt;/del&gt;&lt;/a&gt;) but again that&apos;s for the broker relay only.&lt;/p&gt;</comment>
                            <comment id="129540" author="dsmeyer" created="Wed, 25 May 2016 20:45:15 +0000"  >&lt;p&gt;We&apos;re using the full stomp broker with ActiveMQ &quot;networks of brokers&quot; as the provider.&lt;/p&gt;</comment>
                            <comment id="129541" author="dsmeyer" created="Wed, 25 May 2016 20:45:47 +0000"  >&lt;p&gt;I&apos;ll try the 4.3 RC and see if that resolves my issue and report back, thanks.&lt;/p&gt;</comment>
                            <comment id="129542" author="rstoya05-aop" created="Wed, 25 May 2016 21:01:52 +0000"  >&lt;p&gt;Okay, it was fixed in RC1 but you can try RC2 or the latest snapshot.&lt;/p&gt;</comment>
                            <comment id="129580" author="dsmeyer" created="Fri, 27 May 2016 15:47:36 +0000"  >&lt;p&gt;Using RC2, the issue is still present.&lt;/p&gt;</comment>
                            <comment id="129583" author="rstoya05-aop" created="Fri, 27 May 2016 16:11:05 +0000"  >&lt;p&gt;This is exactly what &lt;a href=&quot;https://jira.spring.io/browse/SPR-13800&quot; title=&quot;Users logged in to multiple servers do not get messages in sessions on remote servers&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPR-13800&quot;&gt;&lt;del&gt;SPR-13800&lt;/del&gt;&lt;/a&gt; addressed (and tested) so you&apos;ll need to provide more details. See &lt;a href=&quot;https://github.com/spring-projects/spring-framework/commit/68f6cf9d3a2c9dace624fffc93473d91772df14e&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;the commit&lt;/a&gt;. You need to make sure that &lt;tt&gt;userDestinationBroadcast&lt;/tt&gt; is set and also there is a slight delay with knowledge of user sessions being propagated across all servers. That&apos;s configurable.&lt;/p&gt;</comment>
                            <comment id="129588" author="dsmeyer" created="Fri, 27 May 2016 17:41:20 +0000"  >&lt;p&gt;I missed the userDestinationBroadcast configuration! With that in place it&apos;s now working. Thanks for your assistance, the ticket can be closed.&lt;/p&gt;</comment>
                            <comment id="129589" author="rstoya05-aop" created="Fri, 27 May 2016 17:44:38 +0000"  >&lt;p&gt;Thanks for confirming.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10151">
                    <name>Relate</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="67093">SPR-13800</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_10180" key="com.atlassian.jira.toolkit:dayslastcommented">
                        <customfieldname>Days since last comment</customfieldname>
                        <customfieldvalues>
                                        29 weeks, 6 days ago
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10170" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>First Response Date</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 25 May 2016 20:38:26 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10181" key="com.atlassian.jira.toolkit:lastusercommented">
                        <customfieldname>Last commented by a User</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>false</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10182" key="com.atlassian.jira.toolkit:lastupdaterorcommenter">
                        <customfieldname>Last updater</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>rstoya05-aop</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10880" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i098rj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10380" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_10171" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>