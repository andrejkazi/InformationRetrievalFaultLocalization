<!-- 
RSS generated by JIRA (6.4.11#64026-sha1:78f6ec473a3f058bd5d6c30e9319c7ab376bdb9c) at Thu Dec 22 19:41:37 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://jira.spring.io/si/jira.issueviews:issue-xml/SPR-1953/SPR-1953.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>Spring JIRA</title>
    <link>https://jira.spring.io</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.4.11</version>
        <build-number>64026</build-number>
        <build-date>25-08-2015</build-date>
    </build-info>

<item>
            <title>[SPR-1953] PropertyPlaceholderConfigurer indirectly instantiates FactoryBeans if it&apos;s autowire mode is anything but &apos;no&apos;</title>
                <link>https://jira.spring.io/browse/SPR-1953</link>
                <project id="10000" key="SPR">Spring Framework</project>
                    <description>&lt;p&gt;Please see &lt;a href=&quot;http://forum.springframework.org/showthread.php?t=24133&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://forum.springframework.org/showthread.php?t=24133&lt;/a&gt; for more details.&lt;/p&gt;

&lt;p&gt;I have a properties file with jdbc and hibernate information.  I am using the following configuration file:&lt;/p&gt;

&lt;p&gt;&amp;lt;bean id=&quot;propertyConfigurer&quot; class=&quot;org.springframework.beans.factory.config.PropertyPlaceholderConfigurer&quot;&amp;gt;&lt;br/&gt;
&amp;lt;property name=&quot;location&quot; value=&quot;/WEB-INF/config/forum.properties&quot;/&amp;gt;&lt;br/&gt;
&amp;lt;/bean&amp;gt;&lt;/p&gt;

&lt;p&gt;&amp;lt;bean id=&quot;dataSource&quot; class=&quot;org.apache.commons.dbcp.BasicDataSource&quot;&amp;gt;&lt;br/&gt;
&amp;lt;property name=&quot;driverClassName&quot;&amp;gt;&amp;lt;value&amp;gt;com.mysql.jdbc.Drive r&amp;lt;/value&amp;gt;&amp;lt;/property&amp;gt;&lt;br/&gt;
&amp;lt;property name=&quot;url&quot;&amp;gt;&amp;lt;value&amp;gt;$&lt;/p&gt;
{jdbc.url}
&lt;p&gt;&amp;lt;/value&amp;gt;&amp;lt;/property&amp;gt;&lt;br/&gt;
&amp;lt;property name=&quot;username&quot;&amp;gt;&amp;lt;value&amp;gt;$&lt;/p&gt;
{jdbc.username}
&lt;p&gt;&amp;lt;/value&amp;gt;&amp;lt;/property&amp;gt;&lt;br/&gt;
&amp;lt;property name=&quot;password&quot;&amp;gt;&amp;lt;value&amp;gt;$&lt;/p&gt;
{jdbc.password}
&lt;p&gt;&amp;lt;/value&amp;gt;&amp;lt;/property&amp;gt;&lt;br/&gt;
&amp;lt;property name=&quot;maxActive&quot;&amp;gt;&amp;lt;value&amp;gt;90&amp;lt;/value&amp;gt;&amp;lt;/property&amp;gt;&lt;br/&gt;
&amp;lt;property name=&quot;maxIdle&quot;&amp;gt;&amp;lt;value&amp;gt;3&amp;lt;/value&amp;gt;&amp;lt;/property&amp;gt;&lt;br/&gt;
&amp;lt;property name=&quot;maxWait&quot;&amp;gt;&amp;lt;value&amp;gt;10000&amp;lt;/value&amp;gt;&amp;lt;/property&amp;gt;&lt;br/&gt;
&amp;lt;property name=&quot;removeAbandoned&quot;&amp;gt;&amp;lt;value&amp;gt;true&amp;lt;/value&amp;gt;&amp;lt;/property&amp;gt;&lt;br/&gt;
&amp;lt;property name=&quot;removeAbandonedTimeout&quot;&amp;gt;&amp;lt;value&amp;gt;600&amp;lt;/value&amp;gt;&amp;lt;/property&amp;gt;&lt;br/&gt;
&amp;lt;/bean&amp;gt;&lt;/p&gt;

&lt;p&gt;&amp;lt;bean id=&quot;sessionFactory&quot; class=&quot;org.springframework.orm.hibernate3.LocalSessionFactoryBean&quot;&amp;gt;&lt;br/&gt;
&amp;lt;property name=&quot;dataSource&quot;&amp;gt;&amp;lt;ref bean=&quot;dataSource&quot;/&amp;gt;&amp;lt;/property&amp;gt;&lt;br/&gt;
&amp;lt;property name=&quot;mappingResources&quot;&amp;gt;&lt;br/&gt;
&amp;lt;list&amp;gt;&lt;br/&gt;
&amp;lt;value&amp;gt;com/amlforum/entities/Category.hbm.xml&amp;lt;/value&amp;gt;&lt;br/&gt;
&amp;lt;value&amp;gt;com/amlforum/entities/Forum.hbm.xml&amp;lt;/value&amp;gt;&lt;br/&gt;
&amp;lt;value&amp;gt;com/amlforum/entities/Topic.hbm.xml&amp;lt;/value&amp;gt;&lt;br/&gt;
&amp;lt;value&amp;gt;com/amlforum/entities/Post.hbm.xml&amp;lt;/value&amp;gt;&lt;br/&gt;
&amp;lt;value&amp;gt;com/amlforum/entities/User.hbm.xml&amp;lt;/value&amp;gt;&lt;br/&gt;
&amp;lt;value&amp;gt;com/amlforum/entities/Rank.hbm.xml&amp;lt;/value&amp;gt;&lt;br/&gt;
&amp;lt;value&amp;gt;com/amlforum/entities/Permission.hbm.xml&amp;lt;/value&amp;gt;&lt;br/&gt;
&amp;lt;value&amp;gt;com/amlforum/entities/Group.hbm.xml&amp;lt;/value&amp;gt;&lt;br/&gt;
&amp;lt;/list&amp;gt;&lt;br/&gt;
&amp;lt;/property&amp;gt;&lt;br/&gt;
&amp;lt;property name=&quot;hibernateProperties&quot;&amp;gt;&lt;br/&gt;
&amp;lt;props&amp;gt;&lt;br/&gt;
&amp;lt;prop key=&quot;hibernate.dialect&quot;&amp;gt;$&lt;/p&gt;
{hibernate.dialect}
&lt;p&gt;&amp;lt;/prop&amp;gt;&lt;br/&gt;
&amp;lt;prop key=&quot;hibernate.show_sql&quot;&amp;gt;$&lt;/p&gt;
{hibernate.show_sql}
&lt;p&gt;&amp;lt;/prop&amp;gt;&lt;br/&gt;
&amp;lt;/props&amp;gt;&lt;br/&gt;
&amp;lt;/property&amp;gt;&lt;/p&gt;

&lt;p&gt;&amp;lt;/bean&amp;gt;&lt;/p&gt;

&lt;p&gt;When I add org.springframework.orm.hibernate3.LocalSessionFactoryBean to the configuration file it loads hibernate first, the datasource second then the PropertyPlaceholderConfigurer.  If I remove the LocalSessionFactoryBean configuration it loads PropertyPlaceholderConfigurer first like I would expect it to.  With it&apos;s current behavior there is no way to use a properties file to configure either the datasource or the hibernate LocalSessionFactoryBean.&lt;/p&gt;</description>
            <key id="13831">SPR-1953</key>
            <summary>PropertyPlaceholderConfigurer indirectly instantiates FactoryBeans if it&apos;s autowire mode is anything but &apos;no&apos;</summary>
                <type id="1" iconUrl="https://jira.spring.io/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://jira.spring.io/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://jira.spring.io/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="springboy">Rick Evans</assignee>
                                    <reporter username="adamal">Adam Ruggles</reporter>
                        <labels>
                    </labels>
                <created>Mon, 24 Apr 2006 09:44:19 +0000</created>
                <updated>Tue, 19 Jun 2012 03:52:39 +0000</updated>
                            <resolved>Wed, 21 Jun 2006 08:39:48 +0000</resolved>
                                    <version>1.2.7</version>
                                    <fixVersion>2.0 RC2</fixVersion>
                                    <component>Core</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="17509" author="juergen.hoeller" created="Sat, 6 May 2006 08:07:09 +0000"  >&lt;p&gt;This should definitely work: We&apos;re using the exact same configuration style in the Hibernate version of our PetClinic sample applicaiton, and it works perfectly there. There must be some other effect in your scenario: Please try to reproduce it in isolation and provide a test case (for example a minimal WAR that fails to start up for you).&lt;/p&gt;

&lt;p&gt;Juergen&lt;/p&gt;</comment>
                            <comment id="17588" author="adamal" created="Sat, 13 May 2006 03:05:50 +0000"  >&lt;p&gt;I&apos;ve added an older copy of the project.  I have modified the configurations just a bit to be more inline with the petclinic example.  I am still having the problem.  &lt;/p&gt;</comment>
                            <comment id="17638" author="adamal" created="Mon, 15 May 2006 14:19:13 +0000"  >&lt;p&gt;This still occurs in version 1.2.8&lt;/p&gt;</comment>
                            <comment id="18077" author="juergen.hoeller" created="Mon, 19 Jun 2006 09:00:53 +0000"  >&lt;p&gt;Can you please try to reproduce this, Rick?&lt;/p&gt;

&lt;p&gt;Juergen&lt;/p&gt;</comment>
                            <comment id="18078" author="springboy" created="Mon, 19 Jun 2006 09:09:59 +0000"  >&lt;p&gt;Will do. Am checking out Spring 1.2.7 right now. Expect an update sometime tomorrow night &lt;img class=&quot;emoticon&quot; src=&quot;https://jira.spring.io/images/icons/emoticons/biggrin.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="18119" author="springboy" created="Tue, 20 Jun 2006 09:03:05 +0000"  >&lt;p&gt;(Back from break during which I didn&apos;t find any goats cheese nor any orange soda.)&lt;/p&gt;

&lt;p&gt;The nub of it is that PropertyPlaceholderConfigurers must not be autowired. If it is marked for autowiring (either explicitly on its own bean definition or implicitly via the default-autowire attribute on the top level &amp;lt;beans/&amp;gt; element), then the process of searching for types to autowire into it results in FactoryBeans (such as LocalSessionFactoryBean) being instantiated.&lt;/p&gt;

&lt;p&gt;The &apos;answer&apos; (such as it is) is to have configuration like the following; notice the explicit &apos;autowire=&quot;no&quot;&apos; attribute on the PPHC bean definition.&lt;/p&gt;

&lt;p&gt;&amp;lt;beans default-autowire=&quot;autodetect&quot;&amp;gt;&lt;/p&gt;

&lt;p&gt;    &amp;lt;bean autowire=&quot;no&quot;&lt;br/&gt;
          class=&quot;org.springframework.beans.factory.config.PropertyPlaceholderConfigurer&quot;&amp;gt;&lt;br/&gt;
        &amp;lt;property name=&quot;location&quot; value=&quot;classpath:jdbc.properties&quot;/&amp;gt;&lt;br/&gt;
    &amp;lt;/bean&amp;gt;&lt;/p&gt;

&lt;p&gt;    &amp;lt;!-- more bean defs such as LocalSessionFactoryBean here... --&amp;gt;&lt;/p&gt;

&lt;p&gt;&amp;lt;/beans&amp;gt;&lt;/p&gt;

&lt;p&gt;I don&apos;t think (Juergen may prove me wrong) that this behaviour is going to be changed. Unless Juergen or Adam comments otherwise, I will mark this issue as resolved tomorrow night.&lt;/p&gt;

&lt;p&gt;I appreciate that the &apos;answer&apos; is a tad &apos;rum&apos;. Perhaps the documentation (Javadoc / ref manual) could be updated to mention this? Or perhaps PPHC could be excluded from being autowired?&lt;/p&gt;

&lt;p&gt;Comments?&lt;/p&gt;</comment>
                            <comment id="18121" author="springboy" created="Tue, 20 Jun 2006 09:09:27 +0000"  >&lt;p&gt;Updated ticket title to more accurately reflect the root cause of the issue.&lt;/p&gt;</comment>
                            <comment id="18122" author="adamal" created="Tue, 20 Jun 2006 09:45:28 +0000"  >&lt;p&gt;If the propertyPlaceholderConfigurer doesn&apos;t load correctly with autowire set to anything but no, then shouldn&apos;t the autowire always be no?  Either way, having to set the autowire=&quot;no&quot; in the configuration is a good enough solution for me. &lt;/p&gt;</comment>
                            <comment id="18148" author="springboy" created="Wed, 21 Jun 2006 08:39:48 +0000"  >&lt;p&gt;Hi Adam&lt;/p&gt;

&lt;p&gt;I have updated the class level Javadoc for the PPHC to highlight the issue you raised Adam. Marking one&apos;s PPHC bean definition as &apos;autowire=&quot;no&quot;&apos; is the recommended approach.&lt;/p&gt;

&lt;p&gt;Thanks for spotting this.&lt;/p&gt;

&lt;p&gt;Cheers&lt;br/&gt;
Rick&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10020">
                    <name>Related</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="21098">SPR-4578</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="11633" name="AmlForum.war" size="79343" author="adamal" created="Sat, 13 May 2006 02:51:54 +0000"/>
                            <attachment id="11634" name="lib1.zip" size="5662677" author="adamal" created="Sat, 13 May 2006 03:00:14 +0000"/>
                            <attachment id="11635" name="lib2.zip" size="6674476" author="adamal" created="Sat, 13 May 2006 03:04:18 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_10180" key="com.atlassian.jira.toolkit:dayslastcommented">
                        <customfieldname>Days since last comment</customfieldname>
                        <customfieldvalues>
                                        10 years, 28 weeks, 1 day ago
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10170" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>First Response Date</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Sat, 6 May 2006 08:07:09 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10181" key="com.atlassian.jira.toolkit:lastusercommented">
                        <customfieldname>Last commented by a User</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>false</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10182" key="com.atlassian.jira.toolkit:lastupdaterorcommenter">
                        <customfieldname>Last updater</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>tmarshall</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10880" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i04siv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10380" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>27995</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_10171" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>