<!-- 
RSS generated by JIRA (6.4.11#64026-sha1:78f6ec473a3f058bd5d6c30e9319c7ab376bdb9c) at Thu Dec 22 19:50:50 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://jira.spring.io/si/jira.issueviews:issue-xml/SPR-2738/SPR-2738.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>Spring JIRA</title>
    <link>https://jira.spring.io</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.4.11</version>
        <build-number>64026</build-number>
        <build-date>25-08-2015</build-date>
    </build-info>

<item>
            <title>[SPR-2738] BeanWrapperImpl cannot retrieve an indexed value from a Map of Lists</title>
                <link>https://jira.spring.io/browse/SPR-2738</link>
                <project id="10000" key="SPR">Spring Framework</project>
                    <description>&lt;p&gt;BeanWrapperImpl#getPropertyValue fails when attempting to load a value from a Map of Lists when the keys are anything other than Strings. For example, say your bean has a property &quot;map&quot; whose type is Map&amp;lt;Integer, List&amp;lt;Whatever&amp;gt;&amp;gt;.  This will successfully load an individual list:&lt;/p&gt;

&lt;p&gt;List&amp;lt;Whatever&amp;gt; list = beanWrapper.getPropertyValue(&quot;map&lt;span class=&quot;error&quot;&gt;&amp;#91;3&amp;#93;&lt;/span&gt;&quot;)&lt;/p&gt;

&lt;p&gt;This, however, will fail to load a single element:&lt;/p&gt;

&lt;p&gt;Whatever w = beanWrapper.getPropertyValue(&quot;map&lt;span class=&quot;error&quot;&gt;&amp;#91;3&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt;&quot;)&lt;/p&gt;

&lt;p&gt;The immediate cause is that the second call does bean.getMap().get(&quot;3&quot;) &amp;#8211; i.e., the key isn&apos;t converted to an Integer.  Since it works in the first case, it seems like it should be workable in the second case.&lt;/p&gt;

&lt;p&gt;I&apos;ve got a self-contained test case which I will attach.  &lt;/p&gt;</description>
            <key id="15305">SPR-2738</key>
            <summary>BeanWrapperImpl cannot retrieve an indexed value from a Map of Lists</summary>
                <type id="1" iconUrl="https://jira.spring.io/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://jira.spring.io/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://jira.spring.io/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="juergen.hoeller">Juergen Hoeller</assignee>
                                    <reporter username="rsutphin">Rhett Sutphin</reporter>
                        <labels>
                    </labels>
                <created>Sat, 21 Oct 2006 21:11:55 +0000</created>
                <updated>Tue, 19 Jun 2012 03:50:43 +0000</updated>
                            <resolved>Thu, 26 Oct 2006 04:08:43 +0000</resolved>
                                    <version>2.0 final</version>
                                    <fixVersion>2.0.1</fixVersion>
                                        <due></due>
                            <votes>1</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="20383" author="rsutphin" created="Sat, 21 Oct 2006 21:20:59 +0000"  >&lt;p&gt;A self-contained test for this bug. Run it using ant &amp;#8211; you need to specify a &quot;spring.dir&quot; property; see build.xml for details.&lt;/p&gt;

&lt;p&gt;Includes four files: the build script, a bean with which to test, a main class with example error output, and a junit test case.&lt;/p&gt;</comment>
                            <comment id="20385" author="springboy" created="Sun, 22 Oct 2006 02:00:55 +0000"  >&lt;p&gt;Patch (line 560 of BeanWrapperImpl)...&lt;/p&gt;

&lt;p&gt;if (JdkVersion.isAtLeastJava15()) {&lt;br/&gt;
    mapKeyType = GenericCollectionTypeResolver.getMapKeyReturnType(pd.getReadMethod());&lt;br/&gt;
}&lt;/p&gt;

&lt;p&gt;Test attached too.&lt;/p&gt;</comment>
                            <comment id="20386" author="rsutphin" created="Sun, 22 Oct 2006 09:17:47 +0000"  >&lt;p&gt;It looks like you&apos;re on the way to a solution to this bug (very quick response, thanks).  One more thing I noticed:  this bug was present in 2.0RC4 but not in 2.0RC3.&lt;/p&gt;</comment>
                            <comment id="20459" author="ahardy66" created="Thu, 26 Oct 2006 00:34:43 +0000"  >&lt;p&gt;I see this too after upgrading from 2.0-RC3. I&apos;m intrigued to see what changed that caused it to fail.&lt;/p&gt;</comment>
                            <comment id="20464" author="juergen.hoeller" created="Thu, 26 Oct 2006 04:08:43 +0000"  >&lt;p&gt;Thanks for pointing this out! Rick, the code that you point is indeed the cause of this: We need to check the type for the right index there. The 2.0 code always checks the type for the &lt;b&gt;last&lt;/b&gt; index, which is of course wrong. Always checking the type for the &lt;b&gt;first&lt;/b&gt; index (by not specifying the index at all) is wrong as well, though. The correct code looks like this:&lt;/p&gt;

&lt;p&gt;  mapKeyType = GenericCollectionTypeResolver.getMapKeyReturnType(pd.getReadMethod(), i + 1);&lt;/p&gt;

&lt;p&gt;with i being the current index in the keys array.&lt;/p&gt;

&lt;p&gt;Juergen&lt;/p&gt;</comment>
                            <comment id="20471" author="springboy" created="Thu, 26 Oct 2006 06:07:23 +0000"  >&lt;p&gt;Darn. How annoying that the unit test I wrote didnlt fllush out my broken &apos;fix&apos;.&lt;/p&gt;

&lt;p&gt;Oh well, thank goodness for JHo filling the breach &lt;img class=&quot;emoticon&quot; src=&quot;https://jira.spring.io/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12053" name="spr-2738_mapoflists.tar.bz2" size="1671" author="rsutphin" created="Sat, 21 Oct 2006 21:20:59 +0000"/>
                            <attachment id="12054" name="test.txt" size="1080" author="springboy" created="Sun, 22 Oct 2006 02:01:48 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_10180" key="com.atlassian.jira.toolkit:dayslastcommented">
                        <customfieldname>Days since last comment</customfieldname>
                        <customfieldvalues>
                                        10 years, 10 weeks ago
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10170" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>First Response Date</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Sun, 22 Oct 2006 02:00:55 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10181" key="com.atlassian.jira.toolkit:lastusercommented">
                        <customfieldname>Last commented by a User</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>false</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10182" key="com.atlassian.jira.toolkit:lastupdaterorcommenter">
                        <customfieldname>Last updater</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>tmarshall</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10880" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i00vhj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10380" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5146</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_10171" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>