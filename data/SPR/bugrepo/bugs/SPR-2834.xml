<!-- 
RSS generated by JIRA (6.4.11#64026-sha1:78f6ec473a3f058bd5d6c30e9319c7ab376bdb9c) at Thu Dec 22 20:13:54 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://jira.spring.io/si/jira.issueviews:issue-xml/SPR-2834/SPR-2834.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>Spring JIRA</title>
    <link>https://jira.spring.io</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.4.11</version>
        <build-number>64026</build-number>
        <build-date>25-08-2015</build-date>
    </build-info>

<item>
            <title>[SPR-2834] AutoProxyFactoryBean must have depends-on to force interceptors to initialise fully</title>
                <link>https://jira.spring.io/browse/SPR-2834</link>
                <project id="10000" key="SPR">Spring Framework</project>
                    <description>&lt;p&gt;An AutoProxyFactoryBean seems to require an ugly depends-on= to force its interceptors to be fully instantiated when it is initalised.  This is a) surprising, b) irritating, especially if there are many interceptors because then they all have to be chained together with depends-on=.  In this example:&lt;/p&gt;

&lt;p&gt;	&amp;lt;bean id=&quot;proxies&quot; class=&quot;org.springframework.aop.framework.autoproxy.BeanNameAutoProxyCreator&quot; depends-on=&quot;nullChecker&quot;&amp;gt;&lt;br/&gt;
		&amp;lt;property name=&quot;beanNames&quot; value=&quot;*&quot;/&amp;gt;&lt;br/&gt;
		&amp;lt;property name=&quot;proxyTargetClass&quot; value=&quot;true&quot;/&amp;gt;&lt;br/&gt;
		&amp;lt;property name=&quot;interceptorNames&quot;&amp;gt;&lt;br/&gt;
			&amp;lt;list&amp;gt;&lt;br/&gt;
				&amp;lt;value&amp;gt;nullChecker&amp;lt;/value&amp;gt;&lt;br/&gt;
			&amp;lt;/list&amp;gt;&lt;br/&gt;
		&amp;lt;/property&amp;gt;&lt;br/&gt;
	&amp;lt;/bean&amp;gt;&lt;/p&gt;

&lt;p&gt;	&amp;lt;bean id=&quot;nullChecker&quot; class=&quot;org.springframework.aop.support.RegexpMethodPointcutAdvisor&quot;&amp;gt;&lt;br/&gt;
		&amp;lt;property name=&quot;advice&quot;&amp;gt;&lt;br/&gt;
			&amp;lt;bean class=&quot;test.aop.NullChecker&quot;/&amp;gt;&lt;br/&gt;
		&amp;lt;/property&amp;gt;&lt;br/&gt;
		&amp;lt;property name=&quot;pattern&quot; value=&quot;.&lt;b&gt;\.set&lt;span class=&quot;error&quot;&gt;&amp;#91;a-zA-Z&amp;#93;&lt;/span&gt;&lt;/b&gt;(.*)&quot;/&amp;gt;&lt;br/&gt;
	&amp;lt;/bean&amp;gt;&lt;/p&gt;

&lt;p&gt;	&amp;lt;bean id=&quot;bean&quot; class=&quot;test.aop.TestBean&quot;/&amp;gt;&lt;/p&gt;

&lt;p&gt;The context fails to initialise with a NullPointerException because the nullChecker.advice property is null at the time when the FactoryBean needs it.&lt;/p&gt;</description>
            <key id="15486">SPR-2834</key>
            <summary>AutoProxyFactoryBean must have depends-on to force interceptors to initialise fully</summary>
                <type id="1" iconUrl="https://jira.spring.io/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://jira.spring.io/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://jira.spring.io/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="juergen.hoeller">Juergen Hoeller</assignee>
                                    <reporter username="david_syer">Dave Syer</reporter>
                        <labels>
                    </labels>
                <created>Mon, 13 Nov 2006 22:47:20 +0000</created>
                <updated>Tue, 19 Jun 2012 03:50:58 +0000</updated>
                            <resolved>Mon, 20 Nov 2006 03:31:55 +0000</resolved>
                                    <version>1.2.8</version>
                    <version>2.0 final</version>
                                    <fixVersion>2.0.1</fixVersion>
                    <fixVersion>1.2.9</fixVersion>
                                    <component>Core:AOP</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="20814" author="david_syer" created="Mon, 13 Nov 2006 22:48:32 +0000"  >&lt;p&gt;N.B. the example above &lt;b&gt;includes&lt;/b&gt; the depends-on= workaround - take this out to see the exception.&lt;/p&gt;</comment>
                            <comment id="20967" author="juergen.hoeller" created="Sun, 19 Nov 2006 06:48:50 +0000"  >&lt;p&gt;Dave, I can&apos;t reproduce this... Such a scenario works fine for me on both 2.0 final and 1.2.8. Can you please post the test case code, or at least the stacktrace?&lt;/p&gt;

&lt;p&gt;Juergen&lt;/p&gt;</comment>
                            <comment id="20976" author="david_syer" created="Mon, 20 Nov 2006 01:46:08 +0000"  >&lt;p&gt;Attached testcase.zip.  Let me know if I missed anything out.&lt;/p&gt;</comment>
                            <comment id="20977" author="david_syer" created="Mon, 20 Nov 2006 01:47:33 +0000"  >&lt;p&gt;Also note that I got the class name wrong in the original report (should be Creator not FactoryBean).&lt;/p&gt;</comment>
                            <comment id="20979" author="juergen.hoeller" created="Mon, 20 Nov 2006 02:04:46 +0000"  >&lt;p&gt;Thanks, Dave, that test case does reproduce the problem for me. Will have a look at the root cause right away!&lt;/p&gt;

&lt;p&gt;Juergen&lt;/p&gt;</comment>
                            <comment id="20981" author="juergen.hoeller" created="Mon, 20 Nov 2006 02:41:23 +0000"  >&lt;p&gt;This is, at its root, a circular reference problem: The auto-proxy creator tries to apply an early version of the Advisor to the nested NullChecker instance... which of course can&apos;t work, since the Advisor isn&apos;t ready before that inner bean has been created. I have added a corresponding check to ignore interceptors/advisors that have not been fully initialized at the time of building a specific proxy.&lt;/p&gt;

&lt;p&gt;If you add an explicit &quot;depends-on&quot; declaration, you enforce full creation of the Advisor before the auto-proxy creator does any work. This does not allow for auto-proxy creation for any beans that the Advisor depends on, but of course solves the init order issue. We do want to allow for auto-proxy creation of such dependent beans as well, though, so the above fix is generally better than adding &quot;depends-on&quot;.&lt;/p&gt;

&lt;p&gt;The NPE only happens with CGLIB doing its hashCode calculation for a proxy class, BTW. The exception is at least nicer (although not necessarily clearer) in other paths of execution. Still, the fix above applies in general, since this needs to work nicely out of the box.&lt;/p&gt;

&lt;p&gt;Juergen&lt;/p&gt;</comment>
                            <comment id="20984" author="juergen.hoeller" created="Mon, 20 Nov 2006 03:15:16 +0000"  >&lt;p&gt;Furthermore, it only fails for a MethodBeforeAdvice! It works fine for a MethodInterceptor, even without the fix... Which is why I couldn&apos;t reproduce it before, since I implemented the NullChecker as a MethodInterceptor. The reason is that we have an explicit exclusion for infrastructure classes for auto-proxying there, which excludes Advisors and MethodInterceptors... but not other Advices. I&apos;ve changed this to general exclusion of Advice there, to exclude this from early on. Any other dependent beans will still be excluded by the &quot;in creation&quot; check as outlined above.&lt;/p&gt;

&lt;p&gt;Juergen&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12229" name="testcase.zip" size="2104" author="david_syer" created="Mon, 20 Nov 2006 01:46:08 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_10180" key="com.atlassian.jira.toolkit:dayslastcommented">
                        <customfieldname>Days since last comment</customfieldname>
                        <customfieldvalues>
                                        10 years, 6 weeks, 3 days ago
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10170" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>First Response Date</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Sun, 19 Nov 2006 06:48:50 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10181" key="com.atlassian.jira.toolkit:lastusercommented">
                        <customfieldname>Last commented by a User</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>false</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10182" key="com.atlassian.jira.toolkit:lastupdaterorcommenter">
                        <customfieldname>Last updater</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>tmarshall</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10880" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i00va7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10380" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5113</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_10171" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>