<!-- 
RSS generated by JIRA (6.4.11#64026-sha1:78f6ec473a3f058bd5d6c30e9319c7ab376bdb9c) at Thu Dec 22 20:48:05 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://jira.spring.io/si/jira.issueviews:issue-xml/SPR-9424/SPR-9424.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>Spring JIRA</title>
    <link>https://jira.spring.io</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.4.11</version>
        <build-number>64026</build-number>
        <build-date>25-08-2015</build-date>
    </build-info>

<item>
            <title>[SPR-9424] Spring JtaTransactionManager is not flushing during before completion phase when using Hibernate 4 or Hibernate 3</title>
                <link>https://jira.spring.io/browse/SPR-9424</link>
                <project id="10000" key="SPR">Spring Framework</project>
                    <description>&lt;p&gt;Hibernate 4.1.0.Final isn&#180;t auto flushing during before completion phase when using JTA (CMT) under Spring 3.1.1.RELEASE and JBoss AS 7.1.&lt;/p&gt;

&lt;p&gt;I&#180;ve set hibernate.transaction.factory_class to org.hibernate.engine.transaction.internal.jta.CMTTransactionFactory and hibernate.transaction.jta.platform to org.hibernate.service.jta.platform.internal.JBossAppServerJtaPlatform. My transaction manager bean is a org.springframework.transaction.jta.JtaTransactionManager configured bean.&lt;/p&gt;

&lt;p&gt;Then, logging (TRACE mode) shows me the following info:&lt;/p&gt;

&lt;p&gt;15:23:58,555 TRACE &lt;span class=&quot;error&quot;&gt;&amp;#91;org.springframework.transaction.interceptor.TransactionInterceptor&amp;#93;&lt;/span&gt; (http--127.0.0.1-8080-1) Completing transaction for...&lt;/p&gt;

&lt;p&gt;15:23:58,557 TRACE &lt;span class=&quot;error&quot;&gt;&amp;#91;org.springframework.transaction.jta.JtaTransactionManager&amp;#93;&lt;/span&gt; (http--127.0.0.1-8080-1) Triggering beforeCommit synchronization&lt;br/&gt;
15:23:58,558 TRACE &lt;span class=&quot;error&quot;&gt;&amp;#91;org.springframework.transaction.jta.JtaTransactionManager&amp;#93;&lt;/span&gt; (http--127.0.0.1-8080-1) Triggering beforeCompletion synchronization&lt;br/&gt;
15:23:58,559 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;org.springframework.orm.jpa.EntityManagerFactoryUtils&amp;#93;&lt;/span&gt; (http--127.0.0.1-8080-1) Closing JPA EntityManager&lt;br/&gt;
15:23:58,560 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;org.springframework.transaction.jta.JtaTransactionManager&amp;#93;&lt;/span&gt; (http--127.0.0.1-8080-1) Initiating transaction commit&lt;br/&gt;
15:23:58,561 TRACE &lt;span class=&quot;error&quot;&gt;&amp;#91;org.hibernate.engine.transaction.synchronization.internal.RegisteredSynchronization&amp;#93;&lt;/span&gt; (http--127.0.0.1-8080-1) JTA sync : beforeCompletion()&lt;br/&gt;
15:23:58,562 TRACE &lt;span class=&quot;error&quot;&gt;&amp;#91;org.hibernate.engine.transaction.synchronization.internal.SynchronizationCallbackCoordinatorImpl&amp;#93;&lt;/span&gt; (http--127.0.0.1-8080-1) Transaction before completion callback&lt;br/&gt;
15:23:58,564 TRACE &lt;span class=&quot;error&quot;&gt;&amp;#91;org.hibernate.internal.SessionImpl&amp;#93;&lt;/span&gt; (http--127.0.0.1-8080-1) before transaction completion&lt;br/&gt;
15:23:58,566 TRACE &lt;span class=&quot;error&quot;&gt;&amp;#91;org.hibernate.engine.transaction.synchronization.internal.RegisteredSynchronization&amp;#93;&lt;/span&gt; (http--127.0.0.1-8080-1) JTA sync : afterCompletion(3)&lt;br/&gt;
15:23:58,567 TRACE &lt;span class=&quot;error&quot;&gt;&amp;#91;org.hibernate.engine.transaction.synchronization.internal.SynchronizationCallbackCoordinatorImpl&amp;#93;&lt;/span&gt; (http--127.0.0.1-8080-1) Transaction after completion callback &lt;span class=&quot;error&quot;&gt;&amp;#91;status=3&amp;#93;&lt;/span&gt;&lt;br/&gt;
15:23:58,568 TRACE &lt;span class=&quot;error&quot;&gt;&amp;#91;org.hibernate.engine.transaction.internal.TransactionCoordinatorImpl&amp;#93;&lt;/span&gt; (http--127.0.0.1-8080-1) after transaction completion&lt;br/&gt;
15:23:58,569 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;org.hibernate.engine.jdbc.internal.LogicalConnectionImpl&amp;#93;&lt;/span&gt; (http--127.0.0.1-8080-1) Aggressively releasing JDBC connection&lt;br/&gt;
15:23:58,570 TRACE &lt;span class=&quot;error&quot;&gt;&amp;#91;org.hibernate.internal.SessionImpl&amp;#93;&lt;/span&gt; (http--127.0.0.1-8080-1) after transaction completion&lt;br/&gt;
15:23:58,571 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;org.hibernate.ejb.EntityManagerImpl&amp;#93;&lt;/span&gt; (http--127.0.0.1-8080-1) Closing entity manager after transaction completion&lt;br/&gt;
15:23:58,572 TRACE &lt;span class=&quot;error&quot;&gt;&amp;#91;org.hibernate.internal.SessionImpl&amp;#93;&lt;/span&gt; (http--127.0.0.1-8080-1) Closing session&lt;br/&gt;
15:23:58,573 TRACE &lt;span class=&quot;error&quot;&gt;&amp;#91;org.hibernate.engine.jdbc.internal.LogicalConnectionImpl&amp;#93;&lt;/span&gt; (http--127.0.0.1-8080-1) Closing logical connection&lt;br/&gt;
15:23:58,574 TRACE &lt;span class=&quot;error&quot;&gt;&amp;#91;org.hibernate.engine.jdbc.internal.proxy.ConnectionProxyHandler&amp;#93;&lt;/span&gt; (http--127.0.0.1-8080-1) Handling invocation of connection method &lt;span class=&quot;error&quot;&gt;&amp;#91;close&amp;#93;&lt;/span&gt;&lt;br/&gt;
15:23:58,575 TRACE &lt;span class=&quot;error&quot;&gt;&amp;#91;org.hibernate.engine.jdbc.internal.proxy.ConnectionProxyHandler&amp;#93;&lt;/span&gt; (http--127.0.0.1-8080-1) Invalidating connection handle&lt;br/&gt;
15:23:58,576 TRACE &lt;span class=&quot;error&quot;&gt;&amp;#91;org.hibernate.engine.jdbc.internal.JdbcResourceRegistryImpl&amp;#93;&lt;/span&gt; (http--127.0.0.1-8080-1) Closing JDBC container &lt;span class=&quot;error&quot;&gt;&amp;#91;org.hibernate.engine.jdbc.internal.JdbcResourceRegistryImpl@17072bf&amp;#93;&lt;/span&gt;&lt;br/&gt;
...&lt;/p&gt;

&lt;p&gt;HOWEVER, IF I use org.springframework.orm.jpa.JpaTransactionManager, instead of JtaTransactionManager, adjusting the configurations above, logging shows me:&lt;/p&gt;

&lt;p&gt;16:40:36,014 TRACE &lt;span class=&quot;error&quot;&gt;&amp;#91;org.springframework.transaction.interceptor.TransactionInterceptor&amp;#93;&lt;/span&gt; (http--127.0.0.1-8080-1) Completing transaction for...&lt;/p&gt;

&lt;p&gt;16:40:36,015 TRACE &lt;span class=&quot;error&quot;&gt;&amp;#91;org.springframework.orm.jpa.JpaTransactionManager&amp;#93;&lt;/span&gt; (http--127.0.0.1-8080-1) Triggering beforeCommit synchronization&lt;br/&gt;
16:40:36,015 TRACE &lt;span class=&quot;error&quot;&gt;&amp;#91;org.springframework.orm.jpa.JpaTransactionManager&amp;#93;&lt;/span&gt; (http--127.0.0.1-8080-1) Triggering beforeCompletion synchronization&lt;br/&gt;
16:40:36,016 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;org.springframework.orm.jpa.JpaTransactionManager&amp;#93;&lt;/span&gt; (http--127.0.0.1-8080-1) Initiating transaction commit&lt;br/&gt;
16:40:36,016 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;org.springframework.orm.jpa.JpaTransactionManager&amp;#93;&lt;/span&gt; (http--127.0.0.1-8080-1) Committing JPA transaction on EntityManager &lt;span class=&quot;error&quot;&gt;&amp;#91;org.hibernate.ejb.EntityManagerImpl@2d885a&amp;#93;&lt;/span&gt;&lt;br/&gt;
16:40:36,017 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;org.hibernate.engine.transaction.spi.AbstractTransactionImpl&amp;#93;&lt;/span&gt; (http--127.0.0.1-8080-1) committing&lt;br/&gt;
16:40:36,017 TRACE &lt;span class=&quot;error&quot;&gt;&amp;#91;org.hibernate.internal.SessionImpl&amp;#93;&lt;/span&gt; (http--127.0.0.1-8080-1) Automatically flushing session&lt;br/&gt;
16:40:36,017 TRACE &lt;span class=&quot;error&quot;&gt;&amp;#91;org.hibernate.event.internal.AbstractFlushingEventListener&amp;#93;&lt;/span&gt; (http--127.0.0.1-8080-1) Flushing session&lt;br/&gt;
16:40:36,018 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;org.hibernate.event.internal.AbstractFlushingEventListener&amp;#93;&lt;/span&gt; (http--127.0.0.1-8080-1) Processing flush-time cascades&lt;br/&gt;
16:40:36,018 TRACE &lt;span class=&quot;error&quot;&gt;&amp;#91;org.hibernate.engine.internal.Cascade&amp;#93;&lt;/span&gt; (http--127.0.0.1-8080-1) Processing cascade ACTION_PERSIST_ON_FLUSH for: br.gov.tcu.sgos.modelo.entidade.ordemservico.OrdemServico&lt;br/&gt;
16:40:36,019 TRACE &lt;span class=&quot;error&quot;&gt;&amp;#91;org.hibernate.engine.spi.CascadingAction&amp;#93;&lt;/span&gt; (http--127.0.0.1-8080-1) Cascading to persist on flush: br.gov.tcu.sgos.modelo.entidade.contrato.Contrato&lt;br/&gt;
16:40:36,020 TRACE &lt;span class=&quot;error&quot;&gt;&amp;#91;org.hibernate.engine.internal.Cascade&amp;#93;&lt;/span&gt; (http--127.0.0.1-8080-1) Done processing cascade ACTION_PERSIST_ON_FLUSH for: br.gov.tcu.sgos.modelo.entidade.ordemservico.OrdemServico&lt;br/&gt;
16:40:36,021 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;org.hibernate.event.internal.AbstractFlushingEventListener&amp;#93;&lt;/span&gt; (http--127.0.0.1-8080-1) Dirty checking collections&lt;br/&gt;
16:40:36,021 TRACE &lt;span class=&quot;error&quot;&gt;&amp;#91;org.hibernate.event.internal.AbstractFlushingEventListener&amp;#93;&lt;/span&gt; (http--127.0.0.1-8080-1) Flushing entities and processing referenced collections&lt;br/&gt;
16:40:36,022 TRACE &lt;span class=&quot;error&quot;&gt;&amp;#91;org.hibernate.persister.entity.AbstractEntityPersister&amp;#93;&lt;/span&gt; (http--127.0.0.1-8080-1) br.gov.tcu.sgos.modelo.entidade.ordemservico.OrdemServico.descricao is dirty&lt;br/&gt;
16:40:36,022 TRACE &lt;span class=&quot;error&quot;&gt;&amp;#91;org.hibernate.event.internal.DefaultFlushEntityEventListener&amp;#93;&lt;/span&gt; (http--127.0.0.1-8080-1) Found dirty properties [&lt;a href=&quot;#5&quot;&gt;br.gov.tcu.sgos.modelo.entidade.ordemservico.OrdemServico#5&lt;/a&gt;] : [Ljava.lang.String;@1882506&lt;br/&gt;
16:40:36,023 TRACE &lt;span class=&quot;error&quot;&gt;&amp;#91;org.hibernate.event.internal.DefaultFlushEntityEventListener&amp;#93;&lt;/span&gt; (http--127.0.0.1-8080-1) Updating entity: &lt;a href=&quot;#5&quot;&gt;br.gov.tcu.sgos.modelo.entidade.ordemservico.OrdemServico#5&lt;/a&gt;&lt;br/&gt;
16:40:36,024 TRACE &lt;span class=&quot;error&quot;&gt;&amp;#91;org.hibernate.engine.internal.Versioning&amp;#93;&lt;/span&gt; (http--127.0.0.1-8080-1) Incrementing: 2 to 3&lt;br/&gt;
16:40:36,026 TRACE &lt;span class=&quot;error&quot;&gt;&amp;#91;org.hibernate.event.internal.AbstractFlushingEventListener&amp;#93;&lt;/span&gt; (http--127.0.0.1-8080-1) Processing unreferenced collections&lt;br/&gt;
16:40:36,026 TRACE &lt;span class=&quot;error&quot;&gt;&amp;#91;org.hibernate.event.internal.AbstractFlushingEventListener&amp;#93;&lt;/span&gt; (http--127.0.0.1-8080-1) Scheduling collection removes/(re)creates/updates&lt;br/&gt;
16:40:36,027 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;org.hibernate.event.internal.AbstractFlushingEventListener&amp;#93;&lt;/span&gt; (http--127.0.0.1-8080-1) Flushed: 0 insertions, 1 updates, 0 deletions to 1 objects&lt;/p&gt;

&lt;p&gt;SO, is something missing? Some additional configuration? Using JpaTransactionaManager everything works as expected, but when using JtaTransactionManager there is no auto flush during the before completion phase.&lt;/p&gt;

&lt;p&gt;Could you please help me?&lt;/p&gt;

&lt;p&gt;I&#180;m looking forward to hearing good news from you.&lt;/p&gt;

&lt;p&gt;Thank you.&lt;/p&gt;</description>
            <key id="43400">SPR-9424</key>
            <summary>Spring JtaTransactionManager is not flushing during before completion phase when using Hibernate 4 or Hibernate 3</summary>
                <type id="1" iconUrl="https://jira.spring.io/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://jira.spring.io/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://jira.spring.io/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="3">Duplicate</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="alysson.rodrigues">Alysson Rodrigues</reporter>
                        <labels>
                            <label>JTA</label>
                    </labels>
                <created>Fri, 18 May 2012 07:25:53 +0000</created>
                <updated>Mon, 4 Jun 2012 02:43:07 +0000</updated>
                            <resolved>Mon, 4 Jun 2012 02:42:57 +0000</resolved>
                                    <version>3.1.1</version>
                                                    <component>Transaction</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                <comments>
                            <comment id="79555" author="cbeams" created="Mon, 4 Jun 2012 02:43:02 +0000"  >&lt;p&gt;Appears to be a duplicate of &lt;a href=&quot;https://jira.spring.io/browse/SPR-9404&quot; title=&quot;Session not flushed with Hibernate 4.1.3, JTA and Spring transaction management integration&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPR-9404&quot;&gt;&lt;del&gt;SPR-9404&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10000">
                    <name>Duplicate</name>
                                            <outwardlinks description="duplicates">
                                        <issuelink>
            <issuekey id="43325">SPR-9404</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_10180" key="com.atlassian.jira.toolkit:dayslastcommented">
                        <customfieldname>Days since last comment</customfieldname>
                        <customfieldvalues>
                                        4 years, 29 weeks, 3 days ago
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10170" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>First Response Date</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 4 Jun 2012 02:43:02 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10181" key="com.atlassian.jira.toolkit:lastusercommented">
                        <customfieldname>Last commented by a User</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>true</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10182" key="com.atlassian.jira.toolkit:lastupdaterorcommenter">
                        <customfieldname>Last updater</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>tmarshall</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10880" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i05l73:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10380" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>32640</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_10171" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>