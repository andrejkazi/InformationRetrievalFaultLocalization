<!-- 
RSS generated by JIRA (6.4.11#64026-sha1:78f6ec473a3f058bd5d6c30e9319c7ab376bdb9c) at Thu Dec 22 20:15:42 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://jira.spring.io/si/jira.issueviews:issue-xml/SPR-3019/SPR-3019.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>Spring JIRA</title>
    <link>https://jira.spring.io</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.4.11</version>
        <build-number>64026</build-number>
        <build-date>25-08-2015</build-date>
    </build-info>

<item>
            <title>[SPR-3019]  Quartz 1.6/CronTriggerBean persistence problem</title>
                <link>https://jira.spring.io/browse/SPR-3019</link>
                <project id="10000" key="SPR">Spring Framework</project>
                    <description>&lt;p&gt;The issue appears to be a compatibility issue between Quartz1.6 JDBCJobStore and Spring scheduling.&lt;/p&gt;

&lt;p&gt;When using a CronTriggerBean to persist a cron trigger a DataTruncationExceptions is being thrown when attempting to insert the trigger.  The stack trace indicates that Quartz is trying to insert a new BlobTrigger instead of a CronTrigger.  &lt;/p&gt;

&lt;p&gt;The issue appears to be a change in how the org.quartz.impl.jdbcjobstore.StdJDBCDelegate checks to see what type of trigger is to be inserted.  The code for the check in the older(1.5.2) version is shown below:&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;code&amp;#93;&lt;/span&gt;&lt;br/&gt;
1166            if (trigger instanceof SimpleTrigger) &lt;/p&gt;
{
1167                ps.setString(10, TTYPE_SIMPLE);
1168            }
&lt;p&gt; else if (trigger instanceof CronTrigger) &lt;/p&gt;
{
1169                ps.setString(10, TTYPE_CRON);
1170            }
&lt;p&gt; else { // (trigger instanceof BlobTrigger)&lt;br/&gt;
1171                ps.setString(10, TTYPE_BLOB);&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;/code&amp;#93;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;In the older implementations of Quartz&apos;s org.quartz.impl.jdbcjobstore.StdJDBCDelegate, it was using an instanceof check to determine the trigger type.  That was fine, since CronTriggerBean subclasses CronTrigger.  &lt;/p&gt;

&lt;p&gt;In Quartz version 1.6, the  trigger type check is now relying on the getClass method, shown below:&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;code&amp;#93;&lt;/span&gt;&lt;br/&gt;
           if (trigger.getClass() == SimpleTrigger.class) &lt;/p&gt;
{
                ps.setString(10, TTYPE_SIMPLE);
           }
&lt;p&gt; else if (trigger.getClass() == CronTrigger.class) &lt;/p&gt;
{
                ps.setString(10, TTYPE_CRON);
            }
&lt;p&gt; else &lt;/p&gt;
{
                ps.setString(10, TTYPE_BLOB);
            }
&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;/code&amp;#93;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;In this case, the CronTriggerBean (or a SimpleTriggerBean) check is always going to return false, and Quartz is going to try to insert a BlobTrigger all the time, causing the data truncation exception.  &lt;/p&gt;

&lt;p&gt;There are a couple workarounds:&lt;br/&gt;
-Use the Trigger directly as a Bean instead of using CronTriggerBean&lt;br/&gt;
-Manually enter the trigger record to the database&lt;br/&gt;
-swap in the Quartz 1.5.2 jars for the 1.6 jars, start the app and insert the trigger, then go back to 1.6(if desired). &lt;/p&gt;

&lt;p&gt;I stumbled across the last one and it is what I have tested so far.  The other workarounds should work, but I haven&apos;t tested them.&lt;/p&gt;

&lt;p&gt;This post also describes the issue:&lt;br/&gt;
&lt;a href=&quot;http://forum.springframework.org/showthread.php?t=33301&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://forum.springframework.org/showthread.php?t=33301&lt;/a&gt;&lt;/p&gt;</description>
            <key id="15845">SPR-3019</key>
            <summary> Quartz 1.6/CronTriggerBean persistence problem</summary>
                <type id="1" iconUrl="https://jira.spring.io/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="4" iconUrl="https://jira.spring.io/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://jira.spring.io/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="3">Duplicate</resolution>
                                        <assignee username="juergen.hoeller">Juergen Hoeller</assignee>
                                    <reporter username="irwinm">Eric Fletcher</reporter>
                        <labels>
                    </labels>
                <created>Mon, 8 Jan 2007 02:34:04 +0000</created>
                <updated>Wed, 17 Jan 2007 07:59:48 +0000</updated>
                            <resolved>Wed, 17 Jan 2007 07:59:48 +0000</resolved>
                                    <version>2.0 final</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="21677" author="juergen.hoeller" created="Mon, 8 Jan 2007 02:43:13 +0000"  >&lt;p&gt;This has already been reported, twice actually, but unfortunately there is no easy way around this. We probably have to introduce a full-scale alternative in the form of FactoryBeans.&lt;/p&gt;

&lt;p&gt;Juergen&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10000">
                    <name>Duplicate</name>
                                            <outwardlinks description="duplicates">
                                        <issuelink>
            <issuekey id="15521">SPR-2850</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_10180" key="com.atlassian.jira.toolkit:dayslastcommented">
                        <customfieldname>Days since last comment</customfieldname>
                        <customfieldvalues>
                                        9 years, 51 weeks, 3 days ago
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10170" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>First Response Date</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 8 Jan 2007 02:43:13 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10181" key="com.atlassian.jira.toolkit:lastusercommented">
                        <customfieldname>Last commented by a User</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>false</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10182" key="com.atlassian.jira.toolkit:lastupdaterorcommenter">
                        <customfieldname>Last updater</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>tmarshall</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10880" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i037sf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10380" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>18804</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_10171" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>