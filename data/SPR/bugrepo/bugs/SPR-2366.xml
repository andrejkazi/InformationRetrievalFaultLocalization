<!-- 
RSS generated by JIRA (6.4.11#64026-sha1:78f6ec473a3f058bd5d6c30e9319c7ab376bdb9c) at Thu Dec 22 19:21:04 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://jira.spring.io/si/jira.issueviews:issue-xml/SPR-2366/SPR-2366.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>Spring JIRA</title>
    <link>https://jira.spring.io</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.4.11</version>
        <build-number>64026</build-number>
        <build-date>25-08-2015</build-date>
    </build-info>

<item>
            <title>[SPR-2366] I believe that Notifications sent by NotificationPublisher are not being interpreted correctly by the JMX server.</title>
                <link>https://jira.spring.io/browse/SPR-2366</link>
                <project id="10000" key="SPR">Spring Framework</project>
                    <description>&lt;p&gt;I am trying to do a very simple prototype application using Spring 2.0 with it&apos;s JMX support. The issue I am having is I am getting the following warning from jconsole when I register for notifications for my sample MBean:&lt;/p&gt;

&lt;p&gt;WARNING: Failed to deserialize a notification: java.lang.ClassNotFoundException: com.real.common.bandwidth.ByteGenerator (no security manager: RMI class loader disabled)&lt;/p&gt;

&lt;p&gt;On the face of it it&apos;s pretty simple - the client, in this case jconsole, needs to have access to the ByteGenerator bytecode.&lt;/p&gt;

&lt;p&gt;I am no JMX expert but looking at the Javadoc for Notification it says:&lt;/p&gt;

&lt;p&gt;Quote:&lt;br/&gt;
The Notification class represents a notification emitted by an MBean. It contains a reference to the source MBean: if the notification has been forwarded through the MBean server, and the original source of the notification was a reference to the emitting MBean object, then the MBean server replaces it by the MBean&apos;s ObjectName. If the listener has registered directly with the MBean, this is either the object name or a direct reference to the MBean.&lt;/p&gt;

&lt;p&gt;It is strongly recommended that notification senders use the object name rather than a reference to the MBean object as the source.&lt;/p&gt;


&lt;p&gt;This seems to suggest that Spring should be replacing my actual object with the name that it was registered with in it&apos;s MBean server. Am I missing something with my code/config below which is preventing this from happening?&lt;/p&gt;

&lt;p&gt;Thanks for any help in advance,&lt;/p&gt;

&lt;p&gt;Ian.&lt;/p&gt;

&lt;p&gt;Code and XML follows&lt;br/&gt;
=======================&lt;/p&gt;

&lt;p&gt;The code for the bean is simple enough too (I had to make a couple of fields transient to prevent NotSerializableExceptions):&lt;/p&gt;

&lt;p&gt;import org.springframework.jmx.export.notification.Notifi cationPublisherAware;&lt;br/&gt;
import org.springframework.jmx.export.notification.Notifi cationPublisher;&lt;br/&gt;
import org.springframework.jmx.export.annotation.ManagedA ttribute;&lt;br/&gt;
import org.springframework.jmx.export.annotation.ManagedR esource;&lt;/p&gt;

&lt;p&gt;import javax.management.Notification;&lt;br/&gt;
import java.io.Serializable;&lt;br/&gt;
import java.util.Random;&lt;/p&gt;

&lt;p&gt;/**&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Super simple class which just generates some number of characters which when&lt;/li&gt;
	&lt;li&gt;encoded with UTF-8 will be a single byte each.&lt;br/&gt;
*&lt;/li&gt;
	&lt;li&gt;@author ibutcher&lt;br/&gt;
*/&lt;br/&gt;
@ManagedResource(objectName=&quot;bean:name=ByteGenerat or&quot;)&lt;br/&gt;
public class ByteGenerator implements NotificationPublisherAware, Serializable {&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;private transient NotificationPublisher publisher;&lt;/p&gt;

&lt;p&gt;private transient static final Random random = new Random(System.currentTimeMillis());&lt;br/&gt;
private static final int ONE_KAY = 1024;&lt;br/&gt;
private static final int NUMBER_OF_CHARACTERS_IN_ALPHABET = 26;&lt;br/&gt;
private static final int CAPITAL_A = 65;&lt;br/&gt;
private static int numberOfExecutions;&lt;/p&gt;


&lt;p&gt;public void setNotificationPublisher(NotificationPublisher notificationPublisher) {&lt;br/&gt;
this.publisher = notificationPublisher;&lt;br/&gt;
}&lt;/p&gt;


&lt;p&gt;@ManagedAttribute (description=&quot;How many times?&quot;)&lt;br/&gt;
public int getNumberOfExecutions(){&lt;br/&gt;
return numberOfExecutions;&lt;br/&gt;
}&lt;/p&gt;


&lt;p&gt;String getBytes(int numberOfBytes) {&lt;br/&gt;
StringBuffer buffer = new StringBuffer(numberOfBytes * ONE_KAY);&lt;/p&gt;

&lt;p&gt;for (int i = 0; i &amp;lt; (numberOfBytes * ONE_KAY); ++i) {&lt;br/&gt;
buffer.append((char) (CAPITAL_A + random.nextInt(NUMBER_OF_CHARACTERS_IN_ALPHABET))) ;&lt;br/&gt;
}&lt;/p&gt;

&lt;p&gt;numberOfExecutions++;&lt;/p&gt;

&lt;p&gt;publisher.sendNotification(new Notification(&quot;ByteGenerator.execute&quot;, this, getNumberOfExecutions()));&lt;/p&gt;

&lt;p&gt;return buffer.toString();&lt;br/&gt;
}&lt;br/&gt;
}&lt;/p&gt;


&lt;p&gt;As you can see I&apos;m using the fancy new Java 5 annotations to instrument the bean. By context file is here:&lt;/p&gt;

&lt;p&gt;&amp;lt;?xml version=&quot;1.0&quot; ?&amp;gt;&lt;br/&gt;
&amp;lt;!DOCTYPE beans PUBLIC &quot;-//SPRING//DTD BEAN//EN&quot; &quot;http://www.springframework.org/dtd/spring-beans.dtd&quot;&amp;gt;&lt;/p&gt;

&lt;p&gt;&amp;lt;beans&amp;gt;&lt;/p&gt;

&lt;p&gt;&amp;lt;bean id=&quot;exporter&quot; class=&quot;org.springframework.jmx.export.MBeanExporte r&quot;&amp;gt;&lt;br/&gt;
&amp;lt;property name=&quot;assembler&quot; ref=&quot;assembler&quot;/&amp;gt;&lt;br/&gt;
&amp;lt;property name=&quot;namingStrategy&quot; ref=&quot;namingStrategy&quot;/&amp;gt;&lt;br/&gt;
&amp;lt;property name=&quot;autodetect&quot; value=&quot;true&quot;/&amp;gt;&lt;br/&gt;
&amp;lt;/bean&amp;gt;&lt;/p&gt;

&lt;p&gt;&amp;lt;bean id=&quot;jmxAttributeSource&quot;&lt;br/&gt;
class=&quot;org.springframework.jmx.export.annotation.A nnotationJmxAttributeSource&quot;/&amp;gt;&lt;/p&gt;

&lt;p&gt;&amp;lt;!-- will create management interface using annotation metadata --&amp;gt;&lt;br/&gt;
&amp;lt;bean id=&quot;assembler&quot;&lt;br/&gt;
class=&quot;org.springframework.jmx.export.assembler.Me tadataMBeanInfoAssembler&quot;&amp;gt;&lt;br/&gt;
&amp;lt;property name=&quot;attributeSource&quot; ref=&quot;jmxAttributeSource&quot;/&amp;gt;&lt;br/&gt;
&amp;lt;/bean&amp;gt;&lt;/p&gt;

&lt;p&gt;&amp;lt;!-- will pick up ObjectName from annotation --&amp;gt;&lt;br/&gt;
&amp;lt;bean id=&quot;namingStrategy&quot;&lt;br/&gt;
class=&quot;org.springframework.jmx.export.naming.Metad ataNamingStrategy&quot;&amp;gt;&lt;br/&gt;
&amp;lt;property name=&quot;attributeSource&quot; ref=&quot;jmxAttributeSource&quot;/&amp;gt;&lt;br/&gt;
&amp;lt;/bean&amp;gt;&lt;/p&gt;

&lt;p&gt;&amp;lt;bean id=&quot;viewResolver&quot; class=&quot;org.springframework.web.servlet.view.Intern alResourceViewResolver&quot;&amp;gt;&lt;br/&gt;
&amp;lt;property name=&quot;prefix&quot; value=&quot;/WEB-INF/jsp/&quot;/&amp;gt;&lt;br/&gt;
&amp;lt;property name=&quot;suffix&quot; value=&quot;.jsp&quot;/&amp;gt;&lt;br/&gt;
&amp;lt;/bean&amp;gt;&lt;/p&gt;

&lt;p&gt;&amp;lt;bean id=&quot;handlerMapping&quot; class=&quot;org.springframework.web.servlet.handler.Bea nNameUrlHandlerMapping&quot;/&amp;gt;&lt;/p&gt;

&lt;p&gt;&amp;lt;bean name=&quot;/bytes&quot; class=&quot;com.real.common.bandwidth.ByteGeneratorCont roller&quot;&amp;gt;&lt;br/&gt;
&amp;lt;property name=&quot;generator&quot; ref=&quot;byteGenerator&quot;/&amp;gt;&lt;br/&gt;
&amp;lt;/bean&amp;gt;&lt;/p&gt;

&lt;p&gt;&amp;lt;bean name=&quot;byteGenerator&quot; class=&quot;com.real.common.bandwidth.ByteGenerator&quot;&amp;gt;&lt;br/&gt;
&amp;lt;/bean&amp;gt;&lt;br/&gt;
&amp;lt;/beans&amp;gt;&lt;/p&gt;</description>
            <key id="14632">SPR-2366</key>
            <summary>I believe that Notifications sent by NotificationPublisher are not being interpreted correctly by the JMX server.</summary>
                <type id="1" iconUrl="https://jira.spring.io/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://jira.spring.io/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://jira.spring.io/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="springboy">Rick Evans</assignee>
                                    <reporter username="ibutcher">Ian Butcher</reporter>
                        <labels>
                    </labels>
                <created>Fri, 28 Jul 2006 10:52:16 +0000</created>
                <updated>Tue, 19 Jun 2012 03:51:14 +0000</updated>
                            <resolved>Tue, 15 Aug 2006 03:19:52 +0000</resolved>
                                    <version>2.0 RC2</version>
                                    <fixVersion>2.0 RC4</fixVersion>
                                    <component>JMX</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="19063" author="springboy" created="Tue, 15 Aug 2006 03:19:52 +0000"  >&lt;p&gt;Hi Ian&lt;/p&gt;

&lt;p&gt;I have amended the Spring JMX Notification publishing infrastructure so that if the source of a Notification is the managed resource (a ByteGenerator instance in your case) or null, then the ObjectName of the managed resource will be set as the Notification source. I believe this will address your use case.&lt;/p&gt;

&lt;p&gt;Thanks for spotting this and taking the time to raise a JIRA issue.&lt;/p&gt;

&lt;p&gt;Cheers&lt;br/&gt;
Rick&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_10180" key="com.atlassian.jira.toolkit:dayslastcommented">
                        <customfieldname>Days since last comment</customfieldname>
                        <customfieldvalues>
                                        10 years, 20 weeks, 2 days ago
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10170" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>First Response Date</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 15 Aug 2006 03:19:52 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10181" key="com.atlassian.jira.toolkit:lastusercommented">
                        <customfieldname>Last commented by a User</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>false</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10182" key="com.atlassian.jira.toolkit:lastupdaterorcommenter">
                        <customfieldname>Last updater</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>tmarshall</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10880" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i04ujz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10380" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>28324</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_10171" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>