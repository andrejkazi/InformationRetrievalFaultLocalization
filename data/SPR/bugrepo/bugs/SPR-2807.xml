<!-- 
RSS generated by JIRA (6.4.11#64026-sha1:78f6ec473a3f058bd5d6c30e9319c7ab376bdb9c) at Thu Dec 22 18:55:06 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://jira.spring.io/si/jira.issueviews:issue-xml/SPR-2807/SPR-2807.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>Spring JIRA</title>
    <link>https://jira.spring.io</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.4.11</version>
        <build-number>64026</build-number>
        <build-date>25-08-2015</build-date>
    </build-info>

<item>
            <title>[SPR-2807] Generics metadata for nested collections</title>
                <link>https://jira.spring.io/browse/SPR-2807</link>
                <project id="10000" key="SPR">Spring Framework</project>
                    <description>&lt;p&gt;Spring doesn&apos;t respect generics metadata for nested collection classes. For example, when a Map is within a Map, the key for the inner map is not respected and is set to a value of type string (instead of looking up the type from the method and using a property editor). &lt;/p&gt;

&lt;p&gt;Here is a concrete example. We are creating a message passing class that receives a message with an optional payload and delivers it to a series of subscribers. It is kind of like the ApplicationEventMulticaster (we will probably later make it implement that) but it only sends the message to those who sign up for the certain type. For example, a class could sign up for save events of a certain type of persistent class. Instead of everyone hearing about it, only those who are interested get it. We want to set it all up in context files (because that is the best place for it since it wont couple things as tightly). The property that the listeners are set up with is below:&lt;/p&gt;

&lt;p&gt;	public void setReceivers(Map&amp;lt;Class, Map&amp;lt;Class, Set&amp;lt;NotificationReceiver&amp;gt;&amp;gt;&amp;gt; receivers) &lt;/p&gt;
{
		this.receivers = receivers;
	}

&lt;p&gt;The Map listed is organized by Notification class &amp;gt; Payload class &amp;gt; receivers. So we tried to set it up with a bean like follows:&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;	&amp;lt;bean id=&quot;notifier&quot; class=&quot;....Notifier&quot;&amp;gt;&lt;br/&gt;
		&amp;lt;property name=&quot;receivers&quot;&amp;gt;&lt;br/&gt;
			&amp;lt;map&amp;gt;&lt;br/&gt;
				&amp;lt;entry key=&quot;com.some.package.SaveNotification&quot;&amp;gt;&lt;br/&gt;
					&amp;lt;map&amp;gt;&lt;br/&gt;
						&amp;lt;entry key=&quot;com.some.other.package.SomePersistentClass&quot;&amp;gt;&lt;br/&gt;
							&amp;lt;set&amp;gt;&lt;br/&gt;
								&amp;lt;ref bean=&quot;mySpecialNotificationListener&quot;/&amp;gt;&lt;br/&gt;
							&amp;lt;/set&amp;gt;&lt;br/&gt;
						&amp;lt;/entry&amp;gt;&lt;br/&gt;
					&amp;lt;/map&amp;gt;&lt;br/&gt;
				&amp;lt;/entry&amp;gt;&lt;br/&gt;
			&amp;lt;/map&amp;gt;&lt;br/&gt;
		&amp;lt;/property&amp;gt;&lt;br/&gt;
	&amp;lt;/bean&amp;gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;This didn&apos;t, however, yield the expected results. We instead got the structure Map&amp;lt;Class, Map&amp;lt;String,Set&amp;lt;?&amp;gt;&amp;gt;&amp;gt;. This messed up the lookups on the objects. Although now we can work around the issue by using class names instead of the class objects themselves, it is not the desired implementation. This could also be worked around if we could specify maps and sets outside of beans and also be able to specify their key and value types. But that is also just a work around.&lt;/p&gt;

&lt;p&gt;I tried to make sense of the code to try and patch it, but it seems that the fix will be fairly involved and I am not familiar enough with the code. That said, it appears that the MethodParameter for the setter doesn&apos;t get passed along in TypeConverterDelegate. &lt;/p&gt;

&lt;p&gt;One way to implement it might involve using the requiredType parameter in the function convertIfNecessary(String propertyName, Object oldValue, Object newValue, Class requiredType, PropertyDescriptor descriptor, MethodParameter methodParam). It appears that it might hold the &quot;unwrapped type&quot; that is needed to make and populate the map correctly. If convertToTypedMap took a Class instead of a MethodParameter, it might have the information necessary to make and populate the map as desired. &lt;/p&gt;</description>
            <key id="15432">SPR-2807</key>
            <summary>Generics metadata for nested collections</summary>
                <type id="1" iconUrl="https://jira.spring.io/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://jira.spring.io/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://jira.spring.io/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="juergen.hoeller">Juergen Hoeller</assignee>
                                    <reporter username="blurryrunner">Stephen Todd</reporter>
                        <labels>
                    </labels>
                <created>Tue, 7 Nov 2006 08:29:35 +0000</created>
                <updated>Tue, 19 Jun 2012 03:50:33 +0000</updated>
                            <resolved>Mon, 27 Nov 2006 09:06:31 +0000</resolved>
                                    <version>2.0 final</version>
                                    <fixVersion>2.0.2</fixVersion>
                                    <component>Core</component>
                        <due></due>
                            <votes>2</votes>
                                    <watches>2</watches>
                                                                <comments>
                            <comment id="21034" author="asadler" created="Wed, 22 Nov 2006 10:59:10 +0000"  >&lt;p&gt;I have added the following unit test to demonstrate the problem&lt;/p&gt;</comment>
                            <comment id="21078" author="juergen.hoeller" created="Mon, 27 Nov 2006 09:06:31 +0000"  >&lt;p&gt;Thanks for pointing this limitation out! The capability to properly convert nested collections has been added in CVS HEAD, and should be available in the next nightly snapshot (&lt;a href=&quot;http://www.springframework.org/snapshots&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://www.springframework.org/snapshots&lt;/a&gt;). Feel free to give it an early try...&lt;/p&gt;

&lt;p&gt;Juergen&lt;/p&gt;</comment>
                            <comment id="21106" author="asadler" created="Tue, 28 Nov 2006 09:11:00 +0000"  >&lt;p&gt;Thanks, I dropped 2.0.2-build-9 into our app and undid my workarounds, it all works perfectly now thanks&lt;/p&gt;</comment>
                            <comment id="21253" author="blurryrunner" created="Thu, 7 Dec 2006 10:23:32 +0000"  >&lt;p&gt;Also tested it in our app and it works great. Thanks!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12235" name="SpringGenericTypeNesting.java" size="2066" author="asadler" created="Wed, 22 Nov 2006 10:59:10 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_10180" key="com.atlassian.jira.toolkit:dayslastcommented">
                        <customfieldname>Days since last comment</customfieldname>
                        <customfieldvalues>
                                        10 years, 4 weeks ago
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10170" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>First Response Date</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 22 Nov 2006 10:59:10 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10181" key="com.atlassian.jira.toolkit:lastusercommented">
                        <customfieldname>Last commented by a User</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>true</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10182" key="com.atlassian.jira.toolkit:lastupdaterorcommenter">
                        <customfieldname>Last updater</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>tmarshall</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10880" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i00vbz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10380" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5121</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_10171" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>