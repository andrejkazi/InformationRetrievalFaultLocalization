<!-- 
RSS generated by JIRA (6.4.11#64026-sha1:78f6ec473a3f058bd5d6c30e9319c7ab376bdb9c) at Thu Dec 22 18:05:21 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://jira.spring.io/si/jira.issueviews:issue-xml/SPR-344/SPR-344.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>Spring JIRA</title>
    <link>https://jira.spring.io</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.4.11</version>
        <build-number>64026</build-number>
        <build-date>25-08-2015</build-date>
    </build-info>

<item>
            <title>[SPR-344] JPetStore sample - user registration does not handle duplicate User ID</title>
                <link>https://jira.spring.io/browse/SPR-344</link>
                <project id="10000" key="SPR">Spring Framework</project>
                    <description>&lt;p&gt;There is an problem in JPetStore application.&lt;br/&gt;
When a new user attempts to registers itself on:&lt;br/&gt;
&lt;a href=&quot;http://localhost:8080/jpetstore/shop/newAccount.do&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://localhost:8080/jpetstore/shop/newAccount.do&lt;/a&gt;&lt;br/&gt;
there is not handled the case, when entered user id already exists.&lt;br/&gt;
For example for User ID: j2ee&lt;br/&gt;
on submit error is displayed:&lt;br/&gt;
-------------------------------------------------------------&lt;br/&gt;
org.springframework.dao.DataIntegrityViolationException: SqlMapTemplate: Violation of unique index: PK_ACCOUNT in statement &lt;span class=&quot;error&quot;&gt;&amp;#91;insert into ACCOUNT (EMAIL, FIRSTNAME, LASTNAME, STATUS, ADDR1, ADDR2, CITY, STATE, ZIP, COUNTRY, PHONE, USERID) values (&amp;#39;asdf&amp;#39;, &amp;#39;asdf&amp;#39;, &amp;#39;asdf&amp;#39;, &amp;#39;OK&amp;#39;, &amp;#39;asdf&amp;#39;, &amp;#39;asdf&amp;#39;, &amp;#39;asdf&amp;#39;, &amp;#39;asdf&amp;#39;, &amp;#39;asdf&amp;#39;, &amp;#39;asdf&amp;#39;, &amp;#39;asdf&amp;#39;, &amp;#39;j2ee&amp;#39;)&amp;#93;&lt;/span&gt;; nested exception is java.sql.SQLException: Violation of unique index: PK_ACCOUNT in statement &lt;span class=&quot;error&quot;&gt;&amp;#91;insert into ACCOUNT (EMAIL, FIRSTNAME, LASTNAME, STATUS, ADDR1, ADDR2, CITY, STATE, ZIP, COUNTRY, PHONE, USERID) values (&amp;#39;asdf&amp;#39;, &amp;#39;asdf&amp;#39;, &amp;#39;asdf&amp;#39;, &amp;#39;OK&amp;#39;, &amp;#39;asdf&amp;#39;, &amp;#39;asdf&amp;#39;, &amp;#39;asdf&amp;#39;, &amp;#39;asdf&amp;#39;, &amp;#39;asdf&amp;#39;, &amp;#39;asdf&amp;#39;, &amp;#39;asdf&amp;#39;, &amp;#39;j2ee&amp;#39;)&amp;#93;&lt;/span&gt;&lt;br/&gt;
java.sql.SQLException: Violation of unique index: PK_ACCOUNT in statement &lt;span class=&quot;error&quot;&gt;&amp;#91;insert into ACCOUNT (EMAIL, FIRSTNAME, LASTNAME, STATUS, ADDR1, ADDR2, CITY, STATE, ZIP, COUNTRY, PHONE, USERID) values (&amp;#39;asdf&amp;#39;, &amp;#39;asdf&amp;#39;, &amp;#39;asdf&amp;#39;, &amp;#39;OK&amp;#39;, &amp;#39;asdf&amp;#39;, &amp;#39;asdf&amp;#39;, &amp;#39;asdf&amp;#39;, &amp;#39;asdf&amp;#39;, &amp;#39;asdf&amp;#39;, &amp;#39;asdf&amp;#39;, &amp;#39;asdf&amp;#39;, &amp;#39;j2ee&amp;#39;)&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at com.ibatis.db.sqlmap.MappedStatement.executeUpdate(Unknown Source)&lt;br/&gt;
	at org.springframework.orm.ibatis.SqlMapTemplate$8.doInMappedStatement(SqlMapTemplate.java:218)&lt;br/&gt;
	at org.springframework.orm.ibatis.SqlMapTemplate.execute(SqlMapTemplate.java:111)&lt;br/&gt;
	at org.springframework.orm.ibatis.SqlMapTemplate.executeUpdate(SqlMapTemplate.java:216)&lt;br/&gt;
	at org.springframework.samples.jpetstore.dao.ibatis.SqlMapAccountDao.insertAccount(SqlMapAccountDao.java:24)&lt;br/&gt;
	at org.springframework.samples.jpetstore.domain.logic.PetStoreImpl.insertAccount(PetStoreImpl.java:74)&lt;br/&gt;
----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;Please note, that it is very common problem on user registration. It would be nice to fix this sample to have nice reference implementation.  I like to provide fix, but have no idea, how to make custom errors in onSubmit() method of AccountFormController (it is not obvious how to do this).&lt;/p&gt;</description>
            <key id="10577">SPR-344</key>
            <summary>JPetStore sample - user registration does not handle duplicate User ID</summary>
                <type id="1" iconUrl="https://jira.spring.io/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="4" iconUrl="https://jira.spring.io/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://jira.spring.io/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="juergen.hoeller">Juergen Hoeller</assignee>
                                    <reporter username="hpaluch">Henryk Paluch</reporter>
                        <labels>
                    </labels>
                <created>Wed, 22 Sep 2004 21:12:32 +0000</created>
                <updated>Sat, 23 Oct 2004 09:57:23 +0000</updated>
                            <resolved>Sat, 23 Oct 2004 09:57:23 +0000</resolved>
                                    <version>1.0.2</version>
                                    <fixVersion>1.1.2</fixVersion>
                                    <component>Web</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="11351" author="juergen.hoeller" created="Sat, 23 Oct 2004 09:57:23 +0000"  >&lt;p&gt;Thanks for pointing this out. (Note that the original iBATIS JPetStore doesn&apos;t catch this either...) I&apos;ve added the following to AccountFormController&apos;s onSubmit implementation:&lt;/p&gt;

&lt;p&gt;try {&lt;br/&gt;
  if (accountForm.isNewAccount()) &lt;/p&gt;
{
    this.petStore.insertAccount(accountForm.getAccount());
  }
&lt;p&gt;  else &lt;/p&gt;
{
    this.petStore.updateAccount(accountForm.getAccount());
  }
&lt;p&gt;}&lt;br/&gt;
catch (DataIntegrityViolationException ex) {&lt;br/&gt;
  errors.rejectValue(&quot;account.username&quot;, &quot;USER_ID_ALREADY_EXISTS&quot;,&lt;br/&gt;
      &quot;User ID already exists: choose a different ID.&quot;);&lt;br/&gt;
  return showForm(request, response, errors);&lt;br/&gt;
}&lt;/p&gt;

&lt;p&gt;Essentially, an onSubmit implementation can always decide to redirect back to the form view through calling the showForm method and returning its ModelAndView.&lt;/p&gt;

&lt;p&gt;Juergen&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_10180" key="com.atlassian.jira.toolkit:dayslastcommented">
                        <customfieldname>Days since last comment</customfieldname>
                        <customfieldvalues>
                                        12 years, 10 weeks, 5 days ago
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10170" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>First Response Date</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Sat, 23 Oct 2004 09:57:23 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10181" key="com.atlassian.jira.toolkit:lastusercommented">
                        <customfieldname>Last commented by a User</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>false</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10182" key="com.atlassian.jira.toolkit:lastupdaterorcommenter">
                        <customfieldname>Last updater</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>tmarshall</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10880" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i01b2f:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10380" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>7670</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_10171" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>