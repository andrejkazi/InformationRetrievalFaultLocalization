<!-- 
RSS generated by JIRA (6.4.11#64026-sha1:78f6ec473a3f058bd5d6c30e9319c7ab376bdb9c) at Thu Dec 22 17:57:44 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://jira.spring.io/si/jira.issueviews:issue-xml/SPR-869/SPR-869.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>Spring JIRA</title>
    <link>https://jira.spring.io</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.4.11</version>
        <build-number>64026</build-number>
        <build-date>25-08-2015</build-date>
    </build-info>

<item>
            <title>[SPR-869] SqlFunction causes ClassCastException</title>
                <link>https://jira.spring.io/browse/SPR-869</link>
                <project id="10000" key="SPR">Spring Framework</project>
                    <description>&lt;p&gt;If an SqlFunction object is created &quot;bean style&quot; with the default constructor followed by calls to the appropriate setters, attempts to evaluate the function with run may lead to a ClassCastException.  The SQL expression used to produce the problem was&lt;/p&gt;

&lt;p&gt;  SELECT COUNT&lt;img class=&quot;emoticon&quot; src=&quot;https://jira.spring.io/images/icons/emoticons/star_yellow.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; FROM SOME_TABLE WHERE SOME_COL = ?&lt;/p&gt;

&lt;p&gt;and the exception is thrown when the result is cast as an Integer.&lt;/p&gt;

&lt;p&gt;Creating the object with a &quot;fat&quot; constructor works fine.  The culprit turns out to be this member variable declaration in SqlFunction:&lt;/p&gt;

&lt;p&gt;  /** The SQL return type of the function */&lt;br/&gt;
  private int retType;&lt;/p&gt;

&lt;p&gt;The variable is given the appropriate value, e.g. java.sql.Types.INTEGER in the fat constructors, but not in the default.  Furthermore, no accessors for the variable are defined.  The proposed solution is to initialize retType thusly:&lt;/p&gt;

&lt;p&gt;  private int retType = Types.INTEGER;&lt;/p&gt;

&lt;p&gt;Incidentally, the default constructor doesn&apos;t call setRowsExpected(1), which the other constructors do, but that is somewhat less serious.&lt;/p&gt;

&lt;p&gt;Cheers,&lt;br/&gt;
S&#248;ren Larsen&lt;/p&gt;</description>
            <key id="11398">SPR-869</key>
            <summary>SqlFunction causes ClassCastException</summary>
                <type id="1" iconUrl="https://jira.spring.io/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="4" iconUrl="https://jira.spring.io/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://jira.spring.io/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="juergen.hoeller">Juergen Hoeller</assignee>
                                    <reporter username="sorenlarsen">S&#248;ren Larsen</reporter>
                        <labels>
                    </labels>
                <created>Fri, 8 Apr 2005 23:21:47 +0000</created>
                <updated>Thu, 4 Aug 2005 00:58:07 +0000</updated>
                            <resolved>Wed, 3 Aug 2005 22:23:08 +0000</resolved>
                                    <version>1.1.5</version>
                                    <fixVersion>1.2.4</fixVersion>
                                    <component>Data</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="14218" author="juergen.hoeller" created="Wed, 3 Aug 2005 22:23:08 +0000"  >&lt;p&gt;Thanks for the report! Better late than never, I fixed SqlFunction&apos;s default constructor to set &quot;rowsExpected&quot; to 1 and assume Integer as return type.&lt;/p&gt;

&lt;p&gt;Juergen&lt;/p&gt;</comment>
                            <comment id="14219" author="juergen.hoeller" created="Thu, 4 Aug 2005 00:58:06 +0000"  >&lt;p&gt;I&apos;ve taken the occasion and reworked SqlFunction&apos;s internals quite a bit: It uses an internal SingleColumnRowMapper now, leveraging the smart result value extraction there.&lt;/p&gt;

&lt;p&gt;Consequently, the constructors that take a SQL return type are deprecated now (that facility was really only capable of very primitive conversion), in favor or constructors that take a result type Class (same as SingleColumnRowMapper and JdbcTemplate&apos;s queryForObject). There is also a &quot;setResultType&quot; bean property setter.&lt;/p&gt;

&lt;p&gt;In many cases, you won&apos;t need to specify a result type at all: for example, int results can be extracted from any Number object now (just like in SingleColumnRowMapper / JdbcTemplate), calling &quot;intValue()&quot; on it.&lt;/p&gt;

&lt;p&gt;This will be available in the next nightly 1.2.4 snapshot. Feel free to give it an early try!&lt;/p&gt;

&lt;p&gt;Juergen&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_10180" key="com.atlassian.jira.toolkit:dayslastcommented">
                        <customfieldname>Days since last comment</customfieldname>
                        <customfieldvalues>
                                        11 years, 22 weeks ago
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10170" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>First Response Date</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 3 Aug 2005 22:23:08 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10181" key="com.atlassian.jira.toolkit:lastusercommented">
                        <customfieldname>Last commented by a User</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>false</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10182" key="com.atlassian.jira.toolkit:lastupdaterorcommenter">
                        <customfieldname>Last updater</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>tmarshall</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10880" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i01fcn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10380" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>8364</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_10171" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>