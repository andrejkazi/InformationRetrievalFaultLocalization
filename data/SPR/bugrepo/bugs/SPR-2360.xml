<!-- 
RSS generated by JIRA (6.4.11#64026-sha1:78f6ec473a3f058bd5d6c30e9319c7ab376bdb9c) at Thu Dec 22 19:21:18 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://jira.spring.io/si/jira.issueviews:issue-xml/SPR-2360/SPR-2360.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>Spring JIRA</title>
    <link>https://jira.spring.io</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.4.11</version>
        <build-number>64026</build-number>
        <build-date>25-08-2015</build-date>
    </build-info>

<item>
            <title>[SPR-2360] aspectj-autoproxy does not detect lazy-init aspects anymore</title>
                <link>https://jira.spring.io/browse/SPR-2360</link>
                <project id="10000" key="SPR">Spring Framework</project>
                    <description>&lt;p&gt;I&apos;m using rc3 snapshot build 88.  My AspectJ annotated aspects appear to have stopped working.  See the testcase below.  I originally noticed the problem because I had an aspect using @within() which stopped intercepting method calls on my beans with the specified annotation decaired.  This exact test works fine in rc1.&lt;/p&gt;

&lt;p&gt;-------------&lt;del&gt;TestAspect&lt;/del&gt;----------------&lt;br/&gt;
@Aspect&lt;br/&gt;
public class TestAspect {&lt;/p&gt;

&lt;p&gt;	@Around(&quot;execution(public * *(..))&quot;)&lt;br/&gt;
	public Object testAroundAspect(ProceedingJoinPoint pjp) throws Throwable &lt;/p&gt;
{
		System.out.println(&quot;We&apos;re in aspect&quot;);
		return pjp.proceed();
	}
&lt;p&gt;}&lt;/p&gt;

&lt;p&gt;------------------&lt;del&gt;TestClass.java&lt;/del&gt;--------------&lt;br/&gt;
public class TestClass {&lt;br/&gt;
	public String test() &lt;/p&gt;
{
		System.out.println(&quot;Executing test&quot;);
		return null;
	}
&lt;p&gt;}&lt;/p&gt;

&lt;p&gt;----------------&lt;del&gt;Test Context&lt;/del&gt;---------------&lt;br/&gt;
 	&amp;lt;aop:aspectj-autoproxy /&amp;gt;&lt;/p&gt;

&lt;p&gt; 	&amp;lt;bean class=&quot;TestAspect&quot;/&amp;gt;&lt;/p&gt;

&lt;p&gt; 	&amp;lt;bean id=&quot;testClass&quot; class=&quot;TestClass&quot;/&amp;gt;&lt;/p&gt;</description>
            <key id="14622">SPR-2360</key>
            <summary>aspectj-autoproxy does not detect lazy-init aspects anymore</summary>
                <type id="1" iconUrl="https://jira.spring.io/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="2" iconUrl="https://jira.spring.io/images/icons/priorities/critical.png">Critical</priority>
                        <status id="6" iconUrl="https://jira.spring.io/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="juergen.hoeller">Juergen Hoeller</assignee>
                                    <reporter username="youngm">Mike Youngstrom</reporter>
                        <labels>
                    </labels>
                <created>Thu, 27 Jul 2006 05:03:51 +0000</created>
                <updated>Tue, 19 Jun 2012 03:51:07 +0000</updated>
                            <resolved>Fri, 28 Jul 2006 00:26:38 +0000</resolved>
                                    <version>2.0 RC3</version>
                                    <fixVersion>2.0 RC3</fixVersion>
                                    <component>Core:AOP</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="18807" author="robh" created="Thu, 27 Jul 2006 09:15:28 +0000"  >&lt;p&gt;Mike,&lt;/p&gt;

&lt;p&gt;I tried this locally running against a snapshot of HEAD from last night and from now and I cannot get the the code you sent to fail when copied verbatim from above into the project. Can you perhaps attach a JUnit test with code that you know fails on your installation?&lt;/p&gt;

&lt;p&gt;Rob&lt;/p&gt;</comment>
                            <comment id="18808" author="youngm" created="Thu, 27 Jul 2006 09:38:28 +0000"  >&lt;p&gt;Here is a unit test packaged as an eclipse project.  Just resolve the classpath errors and execute AspectJautoProxyTest.&lt;/p&gt;

&lt;p&gt;It fails for me.  But perhaps you have fixed it since this morning&apos;s build.&lt;/p&gt;

&lt;p&gt;Mike&lt;/p&gt;</comment>
                            <comment id="18809" author="youngm" created="Thu, 27 Jul 2006 09:39:10 +0000"  >&lt;p&gt;I tried switching out the snapshot jars with the rc1 jars and the test passes fine.&lt;/p&gt;</comment>
                            <comment id="18812" author="adrian.colyer" created="Thu, 27 Jul 2006 19:10:36 +0000"  >&lt;p&gt;I was able to reproduce this using your project :- it is caused by recent changes to lazy-init behaviour, and the fact that your config has &quot;default-lazy-init=true&quot; (that&apos;s the piece you will have been missing when you tried to reproduce this Rob).&lt;/p&gt;

&lt;p&gt;After discussion with Juergen, he is going to investigate this further...&lt;/p&gt;</comment>
                            <comment id="18813" author="juergen.hoeller" created="Thu, 27 Jul 2006 19:11:38 +0000"  >&lt;p&gt;This has been verified to be caused by the default-lazy-init flag there, which is inherited by the aspect bean. The recent change in AnnotationAwareAspectJAutoProxyCreator causes FactoryBeans to be ignored (which was the goal), but unfortunately this also has the effect of lazy-init beans being ignored.&lt;/p&gt;

&lt;p&gt;So as a short-term solution, either remove the default-lazy-init flag or specify lazy-init=&quot;false&quot; on the aspect bean.&lt;/p&gt;

&lt;p&gt;Juergen&lt;/p&gt;</comment>
                            <comment id="18817" author="juergen.hoeller" created="Fri, 28 Jul 2006 00:26:38 +0000"  >&lt;p&gt;I have generally refined the BeanFactory&apos;s default class loading behavior to load actual bean classes for type checks even for a bean definition with a lazy-init marker. This is now more or less the same as the well-known Spring 1.2 behavior again, at least from the user&apos;s perspective, affecting AspectJ aspect detection as well as BeanPostProcessor / BeanFactoryPostProcessor detection.&lt;/p&gt;

&lt;p&gt;That said, we still allow for classes with lazy-init marker to be lazily loaded in Spring 2.0: The difference is that we will try to load the class for the type check now, but catch a class loading failure and accept it in case of a lazy-init bean - simply considering that bean as not matching. So the bean will be found if the class is loadable and actually matches, while still allowing for lazy-init classes to not be present at startup time.&lt;/p&gt;

&lt;p&gt;Additionally, there&apos;s also a &quot;setAllowEagerClassLoading&quot; method now on DefaultListableBeanFactory. Turning that flag off will switch to the original behavior you encountered, with no lazy-init bean class ever loaded until the bean is explicitly requested. This might be necessary in special environments such as OSGi, where class loading is a very delicate affair (and for which we built the new Spring 2.0 in the first place).&lt;/p&gt;

&lt;p&gt;Juergen&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="11844" name="AspectJAutoProxyTest.zip" size="4355" author="youngm" created="Thu, 27 Jul 2006 09:38:28 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_10180" key="com.atlassian.jira.toolkit:dayslastcommented">
                        <customfieldname>Days since last comment</customfieldname>
                        <customfieldvalues>
                                        10 years, 22 weeks, 6 days ago
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10170" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>First Response Date</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 27 Jul 2006 09:15:28 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10181" key="com.atlassian.jira.toolkit:lastusercommented">
                        <customfieldname>Last commented by a User</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>false</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10182" key="com.atlassian.jira.toolkit:lastupdaterorcommenter">
                        <customfieldname>Last updater</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>tmarshall</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10880" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i04uqf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10380" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>28353</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_10171" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>