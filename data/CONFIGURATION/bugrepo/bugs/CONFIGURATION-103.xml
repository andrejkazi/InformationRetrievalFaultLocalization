<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Thu Dec 01 20:11:37 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/CONFIGURATION-103/CONFIGURATION-103.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[CONFIGURATION-103] [configuration] subset() method alters XMLConfiguration when invoked</title>
                <link>https://issues.apache.org/jira/browse/CONFIGURATION-103</link>
                <project id="12310467" key="CONFIGURATION">Commons Configuration</project>
                    <description>&lt;p&gt;Invoking subset() on an XMLConfiguration causes the underlying hierarchy to &lt;br/&gt;
change.  For example, using the database example on the webpage, performing &lt;br/&gt;
the following and then serializing the XMLConfiguration file will show the &lt;br/&gt;
structure has been altered:&lt;/p&gt;

&lt;p&gt;XMLConfiguration xmlConfig = new XMLConfiguration(databaseDotXmlUrl);&lt;br/&gt;
xmlConfig.subset(&quot;tables.table(0&quot;);&lt;br/&gt;
xmlConfig.save(&quot;C:/AlteredDatabase.xml&quot;);&lt;/p&gt;

&lt;p&gt;Not sure this was the intent of the method... actually the method returns a &lt;br/&gt;
new HierarchicalConfiguration object but this method has undesired side effect &lt;br/&gt;
on the original configuration.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: other&lt;br/&gt;
Platform: Other&lt;/p&gt;</environment>
        <key id="12342397">CONFIGURATION-103</key>
            <summary>[configuration] subset() method alters XMLConfiguration when invoked</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="jamock@mindspring.com">Jeffrey Mock</reporter>
                        <labels>
                    </labels>
                <created>Tue, 26 Jul 2005 08:05:05 +0000</created>
                <updated>Tue, 16 May 2006 11:23:51 +0000</updated>
                            <resolved>Tue, 16 May 2006 11:23:51 +0000</resolved>
                                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12409893" author="oliver.heger@t-online.de" created="Tue, 26 Jul 2005 15:01:21 +0000"  >&lt;p&gt;Hi,&lt;/p&gt;

&lt;p&gt;could you please attach the test configuration file you use before and after the&lt;br/&gt;
invocation of subset() to demonstrate how the structure was changed?&lt;/p&gt;

&lt;p&gt;Thanks.&lt;/p&gt;</comment>
                            <comment id="12409894" author="ebourg" created="Tue, 26 Jul 2005 17:43:23 +0000"  >&lt;ul&gt;
	&lt;li&gt;
	&lt;ul&gt;
		&lt;li&gt;
		&lt;ul&gt;
			&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/CONFIGURATION-40&quot; title=&quot;[configuration] subset() method alters XMLConfiguration when invoked&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CONFIGURATION-40&quot;&gt;&lt;del&gt;COM-2246&lt;/del&gt;&lt;/a&gt; has been marked as a duplicate of this bug. ***&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="12409895" author="jamock@mindspring.com" created="Tue, 26 Jul 2005 21:55:18 +0000"  >&lt;p&gt;Created an attachment (id=15780)&lt;br/&gt;
Source file with main()&lt;/p&gt;

&lt;p&gt;Copied the XML layout from the &quot;How To&quot; page of XML Configuration into a file&lt;br/&gt;
called &quot;resources/database.xml&quot; on my classpath.  The first three lines in the&lt;br/&gt;
go() method is what is described in the bug.  I first dump the contents of the&lt;br/&gt;
XMLConfiguration to a file, then invoke the subset() method, and finally redump&lt;br/&gt;
the contents to another XML file.  The content of the two saved XML files is&lt;br/&gt;
different.&lt;/p&gt;</comment>
                            <comment id="12409896" author="ebourg" created="Tue, 26 Jul 2005 22:39:58 +0000"  >&lt;p&gt;Oliver, I looked quickly at HierarchicalConfiguration.subset(String), it returns&lt;br/&gt;
a copy of the sub tree, correct ? Is it possible to return a configuration with&lt;br/&gt;
the selected node as root instead ? Thus any change to the subset would also&lt;br/&gt;
affect the parent configuration, just like the other subset. That may also fix&lt;br/&gt;
this issue.&lt;/p&gt;</comment>
                            <comment id="12409897" author="ebourg" created="Wed, 27 Jul 2005 00:06:01 +0000"  >&lt;p&gt;Here is an alternative implementation:&lt;/p&gt;


&lt;p&gt;    public Configuration subset(String prefix)&lt;br/&gt;
    {&lt;br/&gt;
        Collection nodes = fetchNodeList(prefix);&lt;/p&gt;

&lt;p&gt;        HierarchicalConfiguration result = new HierarchicalConfiguration();&lt;/p&gt;

&lt;p&gt;        for (Iterator it = nodes.iterator(); it.hasNext()&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;br/&gt;
        {&lt;br/&gt;
            Node node = (Node) it.next();&lt;br/&gt;
            for (Iterator children = node.getChildren().iterator();&lt;br/&gt;
children.hasNext()&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;
            {
                result.getRoot().addChild((Node) children.next());
            }
&lt;p&gt;        }&lt;/p&gt;

&lt;p&gt;        return result;&lt;br/&gt;
    }&lt;/p&gt;</comment>
                            <comment id="12409898" author="oliver.heger@t-online.de" created="Wed, 27 Jul 2005 15:08:24 +0000"  >&lt;p&gt;I will have to dig a little deeper into this. First I&apos;d like to know exactly how&lt;br/&gt;
a call to subset() changes the original configuration.&lt;/p&gt;

&lt;p&gt;Generally I agree with your patch, but we will have to check whether it causes&lt;br/&gt;
problems if one Node object is added as child to two different parent nodes (the&lt;br/&gt;
nodes contain a reference to their parent).&lt;/p&gt;

&lt;p&gt;Another approach would be to remove this special implementation of subset() in&lt;br/&gt;
HierarchicalConfiguration and rely on the implementation in&lt;br/&gt;
AbstractConfiguration. Will have to check if the tests then pass. IIRC&lt;br/&gt;
HierarchicalConfiguration.subset() had been once removed before the 1.0 release&lt;br/&gt;
and was later re-introduced because of problems with the&lt;br/&gt;
ConfigurationXMLDocument class, which later became obsolet. I somehow thought&lt;br/&gt;
that subset() after that was removed again, so I am now a bit surprised that it&lt;br/&gt;
exists in HierarchicalConfiguration at all.&lt;/p&gt;</comment>
                            <comment id="12409899" author="ebourg" created="Wed, 27 Jul 2005 18:07:13 +0000"  >&lt;p&gt;(In reply to comment #6)&lt;br/&gt;
&amp;gt; Another approach would be to remove this special implementation of subset() in&lt;br/&gt;
&amp;gt; HierarchicalConfiguration and rely on the implementation in&lt;br/&gt;
&amp;gt; AbstractConfiguration. Will have to check if the tests then pass. IIRC&lt;br/&gt;
&amp;gt; HierarchicalConfiguration.subset() had been once removed before the 1.0 release&lt;br/&gt;
&amp;gt; and was later re-introduced because of problems with the&lt;br/&gt;
&amp;gt; ConfigurationXMLDocument class, which later became obsolet. I somehow thought&lt;br/&gt;
&amp;gt; that subset() after that was removed again, so I am now a bit surprised that it&lt;br/&gt;
&amp;gt; exists in HierarchicalConfiguration at all.&lt;/p&gt;

&lt;p&gt;You are right, the implementation in AbstractConfiguration pass the subset test&lt;br/&gt;
for HierarchicalConfiguration. The benefit of this implementation is to return a&lt;br/&gt;
HierarchicalConfiguration, it implies a slight difference that is not covered by&lt;br/&gt;
our tests. For example with the following structure:&lt;/p&gt;

&lt;p&gt;foo&lt;br/&gt;
    bar = value1&lt;br/&gt;
foo&lt;br/&gt;
    bar = value2&lt;/p&gt;

&lt;p&gt;the subset on &apos;foo&apos; returns a HierarchicalConfiguration that can be queried on&lt;br/&gt;
the &apos;bar(0)&apos; and &apos;bar(1)&apos; keys. It wouldn&apos;t work if it was just a&lt;br/&gt;
SubsetConfiguration translating the keys.&lt;/p&gt;</comment>
                            <comment id="12409900" author="oliver.heger@t-online.de" created="Thu, 28 Jul 2005 03:29:41 +0000"  >&lt;p&gt;I committed a fix, which should solve the original problem (there was a bug in&lt;br/&gt;
the CloneVisitor, which also affects the clone() method).&lt;/p&gt;

&lt;p&gt;About removing the subset() method at all: I think, this would work.&lt;br/&gt;
SubsetConfiguration only adds the correct prefix and passes the key then to&lt;br/&gt;
HierarchicalConfiguration, which correctly interprets indices. The subset test&lt;br/&gt;
in TestHierarchicalConfiguration also tests such complex keys.&lt;/p&gt;

&lt;p&gt;Just adding the subset&apos;s nodes to a new HierarchicalConfiguration as you do in&lt;br/&gt;
your alternative implementation will probably cause trouble with clearing&lt;br/&gt;
property values: Here a node&apos;s parent reference is used for removing the child node.&lt;/p&gt;</comment>
                            <comment id="12409901" author="ebourg" created="Fri, 30 Sep 2005 20:26:52 +0000"  >&lt;p&gt;(In reply to comment #8)&lt;br/&gt;
&amp;gt; About removing the subset() method at all: I think, this would work.&lt;br/&gt;
&amp;gt; SubsetConfiguration only adds the correct prefix and passes the key then to&lt;br/&gt;
&amp;gt; HierarchicalConfiguration, which correctly interprets indices. The subset test&lt;br/&gt;
&amp;gt; in TestHierarchicalConfiguration also tests such complex keys.&lt;/p&gt;

&lt;p&gt;I added a test that fails if the subset() implementation is removed:&lt;/p&gt;

&lt;p&gt;    assertEquals(fields&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;, subset.getProperty(&quot;name(0)&quot;));&lt;/p&gt;

&lt;p&gt;I haven&apos;t looked why it doesn&apos;t work with a SubsetConfiguration.&lt;/p&gt;</comment>
                            <comment id="12409902" author="oliver.heger@t-online.de" created="Fri, 14 Oct 2005 04:19:53 +0000"  >&lt;p&gt;The original problem has been fixed, so I am closing this ticket now.&lt;/p&gt;

&lt;p&gt;For the discussion about the subset in HierarchicalConfiguration not being&lt;br/&gt;
connected to its original configuration I opened a different ticket: 37081.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12333642" name="ASF.LICENSE.NOT.GRANTED--WindowConfigurationTest4.java" size="1534" author="jamock@mindspring.com" created="Tue, 26 Jul 2005 21:55:18 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>35858</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 26 Jul 2005 15:01:21 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>110686</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 8 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0tfnr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>169846</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>