<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Thu Dec 01 20:10:39 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/CONFIGURATION-609/CONFIGURATION-609.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[CONFIGURATION-609] When using a VFSFileSystem on a PropertiesConfiguration, processing an include token defaults back to DefaultFileSystem</title>
                <link>https://issues.apache.org/jira/browse/CONFIGURATION-609</link>
                <project id="12310467" key="CONFIGURATION">Commons Configuration</project>
                    <description>&lt;p&gt;I have uploaded two files to HDFS.&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;bob.properties:&lt;br/&gt;
==&lt;br/&gt;
include=fred.properties&lt;br/&gt;
==&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;fred.properties&lt;br/&gt;
==&lt;br/&gt;
key=value&lt;br/&gt;
==&lt;br/&gt;
&amp;#8212;&lt;/p&gt;

&lt;p&gt;If I load fred.properties and evaluated the &quot;key&quot;, value is returned as expected. If I load bob.properties, I get a ConfigurationException.&lt;/p&gt;

&lt;p&gt;Here is the code snippet, please change setFileName() to reflect both cases:&lt;/p&gt;

&lt;p&gt;		FileSystem fsTest = new VFSFileSystem();&lt;br/&gt;
		fsTest.setFileOptionsProvider(new HDFSOptionsProvider());&lt;/p&gt;

&lt;p&gt;		Parameters params = new Parameters();&lt;br/&gt;
		FileBasedConfigurationBuilder&amp;lt;FileBasedConfiguration&amp;gt; builder =&lt;br/&gt;
		    new FileBasedConfigurationBuilder&amp;lt;FileBasedConfiguration&amp;gt;(PropertiesConfiguration.class)&lt;br/&gt;
		    .configure(params.fileBased()&lt;br/&gt;
		    	.setLocationStrategy(new FileSystemLocationStrategy())&lt;br/&gt;
		    	.setBasePath(&quot;hdfs://localhost:8020/user/myusername&quot;)&lt;br/&gt;
		        .setFileName(&quot;bob.properties&quot;)&lt;br/&gt;
		        .setFileSystem(fsTest));&lt;/p&gt;

&lt;p&gt;		Configuration config;&lt;br/&gt;
		try &lt;/p&gt;
{
			config = builder.getConfiguration();
			System.out.println(config.getString(&quot;key&quot;));
		}
&lt;p&gt; catch (ConfigurationException e) &lt;/p&gt;
{
			e.printStackTrace();
		}

&lt;p&gt;--------------------&lt;br/&gt;
HDFSOptionsProvider.java:&lt;br/&gt;
==&lt;br/&gt;
public class HDFSOptionsProvider implements FileOptionsProvider {&lt;/p&gt;

&lt;p&gt;	@Override&lt;br/&gt;
	public Map&amp;lt;String, Object&amp;gt; getOptions() &lt;/p&gt;
{
		Map&amp;lt;String, Object&amp;gt; opts = new HashMap&amp;lt;String, Object&amp;gt;();
		opts.put(&quot;DefaultProvider&quot;, HdfsFileProvider.class);
		return  opts;
	}
&lt;p&gt;}&lt;br/&gt;
==&lt;br/&gt;
-------------&lt;br/&gt;
Here is the Exception trace:&lt;br/&gt;
15/08/25 14:14:46 INFO impl.StandardFileSystemManager: Using &quot;/tmp/vfs_cache&quot; as temporary files store.&lt;br/&gt;
15/08/25 14:14:47 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable&lt;br/&gt;
org.apache.commons.configuration2.ex.ConfigurationException: Unable to load the configuration from the URL hdfs://localhost:8020/user/myusername/fred.properties&lt;br/&gt;
	at org.apache.commons.configuration2.io.DefaultFileSystem.getInputStream(DefaultFileSystem.java:56)&lt;br/&gt;
	at org.apache.commons.configuration2.io.FileHandler.load(FileHandler.java:979)&lt;br/&gt;
	at org.apache.commons.configuration2.io.FileHandler.load(FileHandler.java:740)&lt;br/&gt;
	at org.apache.commons.configuration2.PropertiesConfiguration.loadIncludeFile(PropertiesConfiguration.java:1419)&lt;br/&gt;
	at org.apache.commons.configuration2.PropertiesConfiguration.propertyLoaded(PropertiesConfiguration.java:571)&lt;br/&gt;
	at org.apache.commons.configuration2.PropertiesConfigurationLayout.load(PropertiesConfigurationLayout.java:494)&lt;br/&gt;
	at org.apache.commons.configuration2.PropertiesConfiguration.read(PropertiesConfiguration.java:509)&lt;br/&gt;
	at org.apache.commons.configuration2.io.FileHandler.loadFromReader(FileHandler.java:1124)&lt;br/&gt;
	at org.apache.commons.configuration2.io.FileHandler.loadFromTransformedStream(FileHandler.java:1110)&lt;br/&gt;
	at org.apache.commons.configuration2.io.FileHandler.loadFromStream(FileHandler.java:1049)&lt;br/&gt;
	at org.apache.commons.configuration2.io.FileHandler.load(FileHandler.java:980)&lt;br/&gt;
	at org.apache.commons.configuration2.io.FileHandler.load(FileHandler.java:963)&lt;br/&gt;
	at org.apache.commons.configuration2.io.FileHandler.load(FileHandler.java:692)&lt;br/&gt;
	at org.apache.commons.configuration2.builder.FileBasedConfigurationBuilder.initFileHandler(FileBasedConfigurationBuilder.java:312)&lt;br/&gt;
	at org.apache.commons.configuration2.builder.FileBasedConfigurationBuilder.initResultInstance(FileBasedConfigurationBuilder.java:291)&lt;br/&gt;
	at org.apache.commons.configuration2.builder.FileBasedConfigurationBuilder.initResultInstance(FileBasedConfigurationBuilder.java:60)&lt;br/&gt;
	at org.apache.commons.configuration2.builder.BasicConfigurationBuilder.createResult(BasicConfigurationBuilder.java:421)&lt;br/&gt;
	at org.apache.commons.configuration2.builder.BasicConfigurationBuilder.getConfiguration(BasicConfigurationBuilder.java:285)&lt;br/&gt;
	at com.secureops.config.TestLoadConf.main(TestLoadConf.java:33)&lt;br/&gt;
Caused by: java.io.IOException: VFS URLs can only be used with VFS APIs&lt;br/&gt;
	at org.apache.commons.configuration2.io.VFSFileSystem$VFSURLStreamHandler.openConnection(VFSFileSystem.java:368)&lt;br/&gt;
	at java.net.URL.openConnection(URL.java:975)&lt;br/&gt;
	at java.net.URL.openStream(URL.java:1041)&lt;br/&gt;
	at org.apache.commons.configuration2.io.DefaultFileSystem.getInputStream(DefaultFileSystem.java:52)&lt;br/&gt;
	... 18 more&lt;/p&gt;</description>
                <environment>&lt;p&gt;OSX using Eclipse/Maven&lt;/p&gt;</environment>
        <key id="12858598">CONFIGURATION-609</key>
            <summary>When using a VFSFileSystem on a PropertiesConfiguration, processing an include token defaults back to DefaultFileSystem</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="nuttybrewer">Patrick Ethier</reporter>
                        <labels>
                    </labels>
                <created>Tue, 25 Aug 2015 12:19:06 +0000</created>
                <updated>Thu, 24 Mar 2016 20:20:47 +0000</updated>
                            <resolved>Tue, 1 Sep 2015 14:27:29 +0000</resolved>
                                    <version>2.0</version>
                                    <fixVersion>2.0</fixVersion>
                                    <component>File reloading</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                <comments>
                            <comment id="14715391" author="oliver.heger@t-online.de" created="Wed, 26 Aug 2015 19:42:39 +0000"  >&lt;p&gt;This looks indeed like a bug. I will have a look (in the next few days). Thanks for the report.&lt;/p&gt;</comment>
                            <comment id="14715398" author="nuttybrewer" created="Wed, 26 Aug 2015 19:49:40 +0000"  >&lt;p&gt;I&apos;m still working this out locally, but switching to the 1.10 version with&lt;br/&gt;
similar code it seems to not be a problem. Only thing is, with the v1.10&lt;br/&gt;
I&apos;m need to using a configuration file descriptor to get this to work.&lt;br/&gt;
Haven&apos;t used a configuration file descriptor with v2 yet.&lt;/p&gt;

&lt;p&gt;On Wed, Aug 26, 2015 at 9:42 PM, Oliver Heger (JIRA) &amp;lt;jira@apache.org&amp;gt;&lt;/p&gt;
</comment>
                            <comment id="14725472" author="oliver.heger@t-online.de" created="Tue, 1 Sep 2015 14:27:29 +0000"  >&lt;p&gt;Fixed in subversion in revision 1700566.&lt;/p&gt;

&lt;p&gt;The problem was that the FileHandler used to load the include file was newly created and only initialized with the URL of the file to be loaded. Now the handler is created as a copy from the original FileHandler and thus inherits all properties like file system or location strategy.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 26 Aug 2015 19:42:39 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 13 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2jc53:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>