<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Thu Dec 01 20:01:32 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/CONFIGURATION-80/CONFIGURATION-80.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[CONFIGURATION-80] [configuration] ConfigurationFactory not working as expected with include path resolution</title>
                <link>https://issues.apache.org/jira/browse/CONFIGURATION-80</link>
                <project id="12310467" key="CONFIGURATION">Commons Configuration</project>
                    <description>&lt;p&gt;Documentation states that ConfigurationFactory searches includes in a directory&lt;br/&gt;
relative to the one including conf is located...&lt;/p&gt;

&lt;p&gt;Actually, some problem in various initializer methods of ConfigurationFactory&lt;br/&gt;
makes it happen a way that is not natural.&lt;/p&gt;


&lt;p&gt;ConfigurationFactory() empty constructor sets the basePath to &quot;.&quot;. This is okay,&lt;br/&gt;
but when calling setConfigurationFileName, &lt;/p&gt;

&lt;p&gt;public void setConfigurationFileName(String configurationFileName)&lt;/p&gt;
    {
        File file = new File(configurationFileName).getAbsoluteFile();
        this.configurationFileName = file.getName();
        implicitBasePath = file.getParent();
    }


&lt;p&gt;basePath is not reset to null... so a call to getBasePath will not return the&lt;br/&gt;
implicitBasePath as stated.&lt;/p&gt;

&lt;p&gt;    public String getBasePath()&lt;/p&gt;
    {
        String path = StringUtils.isEmpty(basePath) ? implicitBasePath : basePath;
        return StringUtils.isEmpty(path) ? &quot;.&quot; : path;
    }


&lt;p&gt;using ConfigurationFactory(String configurationFileName) does not help, since it&lt;br/&gt;
does not use setConfigurationFileName , so it does not set implicitBasePath&lt;/p&gt;

&lt;p&gt;    public ConfigurationFactory(String configurationFileName)&lt;/p&gt;
    {
        this.configurationFileName = configurationFileName;
    }

&lt;p&gt;A work-around solution to these problems is to set the basePath to null&lt;br/&gt;
explicitely after instanciation/setup...&lt;/p&gt;


&lt;p&gt;a possible correction is to modify the constructor and the setter like this:&lt;/p&gt;

&lt;p&gt;    public ConfigurationFactory(String configurationFileName)&lt;/p&gt;
    {  
        setConfigurationFileName(configurationFileName);
    }

&lt;p&gt;    public void setConfigurationFileName(String configurationFileName)&lt;/p&gt;
    {
        File file = new File(configurationFileName).getAbsoluteFile();
        this.configurationFileName = file.getName();
        this.basePath = null;
        implicitBasePath = file.getParent();
    }</description>
                <environment>&lt;p&gt;Operating System: All&lt;br/&gt;
Platform: All&lt;/p&gt;</environment>
        <key id="12342300">CONFIGURATION-80</key>
            <summary>[configuration] ConfigurationFactory not working as expected with include path resolution</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="fabien.nisol@videotron.ca">Fabien Nisol</reporter>
                        <labels>
                    </labels>
                <created>Sat, 11 Jun 2005 02:38:12 +0000</created>
                <updated>Tue, 16 May 2006 12:13:02 +0000</updated>
                            <resolved>Tue, 16 May 2006 12:13:02 +0000</resolved>
                                    <version>1.1</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12409542" author="fabien.nisol@videotron.ca" created="Sat, 11 Jun 2005 02:40:44 +0000"  >&lt;p&gt;Created an attachment (id=15368)&lt;br/&gt;
correction to 155408&lt;/p&gt;

&lt;p&gt;minor corrections to ConfigurationFactory(String) and&lt;br/&gt;
setConfigurationFileName()&lt;/p&gt;</comment>
                            <comment id="12409543" author="ebourg" created="Sat, 11 Jun 2005 05:54:23 +0000"  >&lt;ul&gt;
	&lt;li&gt;
	&lt;ul&gt;
		&lt;li&gt;
		&lt;ul&gt;
			&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/CONFIGURATION-68&quot; title=&quot;[configuration] ConfigurationFactory not working as expected with include path resolution&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CONFIGURATION-68&quot;&gt;&lt;del&gt;COM-2147&lt;/del&gt;&lt;/a&gt; has been marked as a duplicate of this bug. ***&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="12409544" author="hoju" created="Fri, 22 Jul 2005 00:16:47 +0000"  >&lt;p&gt;This is the only problem I ran into using commons-configuration.  To work around&lt;br/&gt;
it, I simply did something like...&lt;/p&gt;

&lt;p&gt;ConfigurationFactory factory = new ConfigurationFactory(&quot;etc/props/config.xml&quot;);&lt;br/&gt;
factory.setBasePath(&quot;etc/props&quot;);&lt;/p&gt;

&lt;p&gt;It would be nice not to have to make the setBasePath() call as it seems pretty&lt;br/&gt;
unnecessary.  Seems like this should be an easy fix.&lt;/p&gt;


&lt;p&gt;Jake&lt;/p&gt;</comment>
                            <comment id="12409545" author="fabien.nisol@videotron.ca" created="Fri, 22 Jul 2005 10:07:34 +0000"  >&lt;p&gt;If you look into the code, calling factory.setBasePath(null) will have the same&lt;br/&gt;
effect&lt;/p&gt;

&lt;p&gt;Fabien&lt;/p&gt;

&lt;p&gt;(In reply to comment #3)&lt;br/&gt;
&amp;gt; This is the only problem I ran into using commons-configuration.  To work around&lt;br/&gt;
&amp;gt; it, I simply did something like...&lt;br/&gt;
&amp;gt; &lt;br/&gt;
&amp;gt; ConfigurationFactory factory = new ConfigurationFactory(&quot;etc/props/config.xml&quot;);&lt;br/&gt;
&amp;gt; factory.setBasePath(&quot;etc/props&quot;);&lt;br/&gt;
&amp;gt; &lt;br/&gt;
&amp;gt; It would be nice not to have to make the setBasePath() call as it seems pretty&lt;br/&gt;
&amp;gt; unnecessary.  Seems like this should be an easy fix.&lt;br/&gt;
&amp;gt; &lt;br/&gt;
&amp;gt; &lt;br/&gt;
&amp;gt; Jake&lt;/p&gt;</comment>
                            <comment id="12409546" author="oliver.heger@t-online.de" created="Sun, 21 Aug 2005 03:38:17 +0000"  >&lt;p&gt;I had a look into this one and agree that there is a problem with the base path.&lt;/p&gt;

&lt;p&gt;However the proposed solution to set the base path to null whenever a file name&lt;br/&gt;
was set would break the following use case:&lt;/p&gt;

&lt;p&gt;factory.setBasePath(&quot;my base path&quot;);&lt;br/&gt;
factory.setConfigurationFileName(&quot;myFile.xml&quot;);&lt;/p&gt;

&lt;p&gt;I.e. if a base path was set first, a following call to&lt;br/&gt;
setConfigurationFileName() must not override this path.&lt;/p&gt;

&lt;p&gt;What I have tested so far is to change the getBasePath() implementation to&lt;br/&gt;
return the implicit base path (which is derived from the file name) if the base&lt;br/&gt;
path is either null or &quot;.&quot;. This should work in both cases.&lt;/p&gt;

&lt;p&gt;But after that a couple of unit tests are failing. Obviously some of our test&lt;br/&gt;
files for ConfigurationFactory rely on this wrong behavior (these files include&lt;br/&gt;
other files with a relative path like &quot;conf/test.xml&quot; instead of simply&lt;br/&gt;
&quot;test.xml&quot; - and I sometimes asked myself why they did work).&lt;/p&gt;

&lt;p&gt;So the question is how to deal with this situation. The clean solution IMO would&lt;br/&gt;
be to update the affected test files and make the change to&lt;br/&gt;
ConfigurationFactory. But I am not sure about the impact for existing code.&lt;/p&gt;

&lt;p&gt;What do others think?&lt;/p&gt;</comment>
                            <comment id="12409547" author="hoju" created="Sun, 21 Aug 2005 09:53:09 +0000"  >&lt;p&gt;Seems odd to me that one expect that file-based resources referenced from within&lt;br/&gt;
a config.xml file would need to be specified with a full relative path from&lt;br/&gt;
which the config.xml was originally loaded.  But that seems to be what you say&lt;br/&gt;
your unit tests expect.  That&apos;s very weird to me.  I wouldn&apos;t expect many people&lt;br/&gt;
to have made that assumption.  So, you are saying that you load up a config.xml&lt;br/&gt;
file as such...&lt;/p&gt;

&lt;p&gt;ConfigurationFactory factory = new ConfigurationFactory(&quot;etc/props/config.xml&quot;);&lt;/p&gt;

&lt;p&gt;And then the config.xml would look something like this?...&lt;/p&gt;

&lt;p&gt;&amp;lt;configuration&amp;gt;&lt;br/&gt;
  &amp;lt;properties fileName=&quot;etc/props/usergui.properties&quot;/&amp;gt;&lt;br/&gt;
&amp;lt;/configuration&amp;gt;&lt;/p&gt;

&lt;p&gt;First, I can&apos;t fathom anyone else making this assumption.  Second, it makes the&lt;br/&gt;
config.xml file location dependent.  Put config.xml in any other path such as&lt;br/&gt;
&quot;etc/config&quot; and all of a sudden, usergui.properties can&apos;t be found anymore&lt;br/&gt;
without changing the file to look like...&lt;/p&gt;

&lt;p&gt;&amp;lt;configuration&amp;gt;&lt;br/&gt;
  &amp;lt;properties fileName=&quot;etc/config/usergui.properties&quot;/&amp;gt;&lt;br/&gt;
&amp;lt;/configuration&amp;gt;&lt;/p&gt;

&lt;p&gt;Files referenced with a relative path within config.xml should be relative to&lt;br/&gt;
wherever config.xml happens to be.  That&apos;s clearly correct behavior and existing&lt;br/&gt;
commons-configuration behavior is clearly incorrect.  I don&apos;t think there is&lt;br/&gt;
much to think about here except fixing the bug.  Just make sure that the release&lt;br/&gt;
notes make it very clear that this change has been made.  Of course, for those&lt;br/&gt;
following my suggestion in comment #3, any change in behavior will be entirely&lt;br/&gt;
inconsequential, as opposed to the recommendation that one set the base path to&lt;br/&gt;
null, which takes advantage of existing behavior, but doesn&apos;t hold up well if&lt;br/&gt;
behavior changes.&lt;/p&gt;


&lt;p&gt;Jake&lt;/p&gt;</comment>
                            <comment id="12409548" author="oliver.heger@t-online.de" created="Mon, 22 Aug 2005 01:22:14 +0000"  >&lt;p&gt;I thought again about this problem and came to the same results. So thanks for&lt;br/&gt;
the confirmation.&lt;/p&gt;</comment>
                            <comment id="12409549" author="oliver.heger@t-online.de" created="Mon, 22 Aug 2005 02:15:12 +0000"  >&lt;p&gt;Fix applied and a new test case added. The test configuration files that rely on&lt;br/&gt;
the wrong behavior were updated, too.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12333555" name="ASF.LICENSE.NOT.GRANTED--ConfigurationFactory.java" size="25074" author="fabien.nisol@videotron.ca" created="Sat, 11 Jun 2005 02:40:44 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>35316</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Sat, 11 Jun 2005 05:54:23 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>33935</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 16 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0tfmv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>169842</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>