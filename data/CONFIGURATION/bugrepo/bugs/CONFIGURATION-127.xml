<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Thu Dec 01 19:45:29 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/CONFIGURATION-127/CONFIGURATION-127.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[CONFIGURATION-127] [configuration] Lists in a CompositeConfiguration</title>
                <link>https://issues.apache.org/jira/browse/CONFIGURATION-127</link>
                <project id="12310467" key="CONFIGURATION">Commons Configuration</project>
                    <description>&lt;p&gt;Not sure whether this is a bug, but at least it&apos;s an issue where the&lt;br/&gt;
documentation differs from the actul behavior:&lt;/p&gt;

&lt;p&gt;The CompositeConfiguration javadoc states:&lt;br/&gt;
&quot;If you add Configuration1, and then Configuration2, any properties shared will&lt;br/&gt;
mean that Configuration1 will be returned.... If Configuration1 doesn&apos;t have the&lt;br/&gt;
property, then Configuration2 will be checked.&quot;&lt;/p&gt;

&lt;p&gt;So this would mean, if a use getList or getStringArray I only get the list&lt;br/&gt;
elements from conf1 but not those from conf2, if the requested property is&lt;br/&gt;
contained in both. In reality, however, I get a combined list of the values&lt;br/&gt;
specified in conf1 + conf2 + any others.&lt;/p&gt;

&lt;p&gt;I think it would be better to behave according to the documentation and to&lt;br/&gt;
return only the elements from the first matching configuration + any dynamically&lt;br/&gt;
added elements from the InMemoryConfiguration.&lt;/p&gt;

&lt;p&gt;So, is this a bug, and will it be fixed?&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: All&lt;br/&gt;
Platform: All&lt;/p&gt;</environment>
        <key id="12341426">CONFIGURATION-127</key>
            <summary>[configuration] Lists in a CompositeConfiguration</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="christian@siefkes.net">Christian Siefkes</reporter>
                        <labels>
                    </labels>
                <created>Wed, 28 Apr 2004 22:30:36 +0000</created>
                <updated>Tue, 16 May 2006 11:23:51 +0000</updated>
                            <resolved>Tue, 16 May 2006 11:23:51 +0000</resolved>
                                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12406525" author="dep4b" created="Thu, 29 Apr 2004 05:45:26 +0000"  >&lt;p&gt;Can you submit a unit test that demonstrates the problem?  Basically getList &lt;br/&gt;
should work just like getString does..  So, if you declared that conf 1 &lt;br/&gt;
overrides conf 2, then you would get conf1..  if you said conf 1 was additive &lt;br/&gt;
to conf2, then you would get both..&lt;/p&gt;

&lt;p&gt;Eric&lt;/p&gt;</comment>
                            <comment id="12406526" author="christian@siefkes.net" created="Thu, 29 Apr 2004 16:18:57 +0000"  >&lt;p&gt;This I don&apos;t understand &amp;#8211; how can I specify whether conf1 overrides conf2 or&lt;br/&gt;
whether it is additive?&lt;/p&gt;

&lt;p&gt;All is see in the online javadocs for CompositeConfiguration is the single&lt;br/&gt;
&quot;addConfiguration(Configuration config)&quot; method, and there you cannot specify&lt;br/&gt;
whether it should override or add; neither can you specify this in the&lt;br/&gt;
constructor. If there was such an option, it would be great, but currently I&lt;br/&gt;
don&apos;t know it...&lt;/p&gt;

&lt;p&gt;From the documentation I understand that contained configurations are consulted&lt;br/&gt;
in the order they were added, and the first match is returned (the first, not&lt;br/&gt;
the last one, so newly added configs neither override nor add, but are only&lt;br/&gt;
consulted as a fallback if previously configs don&apos;t contain this property). For&lt;br/&gt;
getString etc. this work as expected because a result is returned as soon as a&lt;br/&gt;
match is found.&lt;/p&gt;

&lt;p&gt;But getList is different &amp;#8211; it doesn&apos;t stop when a match is found but iterates&lt;br/&gt;
over all configurations and adds the list elements from all of them &amp;#8211; you can&lt;br/&gt;
easily check this by looking at the code.&lt;/p&gt;</comment>
                            <comment id="12406527" author="dep4b" created="Wed, 5 May 2004 05:30:14 +0000"  >&lt;p&gt;Actually, I think you are right..  What you need for the override versus add &lt;br/&gt;
behavior is to use the ConfigurationFactory.  It deals with sorting all of &lt;br/&gt;
that stuff out when the CompositeConfiguration is returned.&lt;/p&gt;</comment>
                            <comment id="12406528" author="christian@siefkes.net" created="Fri, 14 May 2004 23:16:32 +0000"  >&lt;p&gt;I have a patch that solves the problem. Add this method to CompositeConfiguration:&lt;/p&gt;

&lt;p&gt;    /**&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Adds a configuration. A call to&lt;/li&gt;
	&lt;li&gt;{@link CompositeConfiguration#addConfiguration(Configuration)}
&lt;p&gt; is&lt;/p&gt;&lt;/li&gt;
	&lt;li&gt;equalivant to calling this method with &amp;lt;code&amp;gt;append&amp;lt;/code&amp;gt; set to&lt;/li&gt;
	&lt;li&gt;&amp;lt;code&amp;gt;true&amp;lt;/code&amp;gt;.&lt;br/&gt;
     *&lt;/li&gt;
	&lt;li&gt;@param config the configuration to add&lt;/li&gt;
	&lt;li&gt;@param append if &amp;lt;code&amp;gt;true&amp;lt;/code&amp;gt; list/array entries are added at the&lt;/li&gt;
	&lt;li&gt;end of existing lists; otherwise they are only used as a fallback, i.e.&lt;/li&gt;
	&lt;li&gt;if no list/array entry with the same key exists in previously added&lt;/li&gt;
	&lt;li&gt;configurations (for non-list/array entries the first match is used in&lt;/li&gt;
	&lt;li&gt;any case, so there is no difference)&lt;br/&gt;
     */&lt;br/&gt;
    public void addConfiguration(final Configuration config,&lt;br/&gt;
            final boolean append) {&lt;br/&gt;
        if (!append) {&lt;br/&gt;
            // getList &lt;b&gt;does&lt;/b&gt; append, so if this isn&apos;t the requested behavior&lt;br/&gt;
            // we delete any entries from the new configuration that are&lt;br/&gt;
            // already present&lt;br/&gt;
            final Iterator keys = getKeys();&lt;br/&gt;
            String key;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;            while (keys.hasNext()) &lt;/p&gt;
{
                key = (String) keys.next();
                config.clearProperty(key);
            }
&lt;p&gt;        }&lt;/p&gt;

&lt;p&gt;        // delegate&lt;br/&gt;
        addConfiguration(config);&lt;br/&gt;
    }&lt;/p&gt;


&lt;p&gt;This way users can either call addConfiguration(conf) resp.&lt;br/&gt;
addConfiguration(conf, true) to get the append behavior: list elements from&lt;br/&gt;
different configurations will be joined.&lt;/p&gt;

&lt;p&gt;Or they can call addConfiguration(conf, false) to get the list elements from the&lt;br/&gt;
first matching configuration only.&lt;/p&gt;

&lt;p&gt;It&apos;s probably not the optimal solution but at least it fixes this bug without&lt;br/&gt;
introducing incompatibilites.&lt;/p&gt;

&lt;p&gt;BTW, it there any changes that a 1.0 version will come out soon? Or at least a&lt;br/&gt;
new -devX version that will be published at &lt;a href=&quot;http://www.ibiblio.org/maven/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://www.ibiblio.org/maven/&lt;/a&gt; ? That&lt;br/&gt;
would be very useful for Maven users (such as me)...&lt;/p&gt;</comment>
                            <comment id="12406529" author="ebourg" created="Tue, 18 May 2004 18:09:50 +0000"  >&lt;p&gt;I don&apos;t think we want to remove elements from the added configuration here, if&lt;br/&gt;
the configuration is then saved we will lose information.&lt;/p&gt;</comment>
                            <comment id="12406530" author="christian@siefkes.net" created="Tue, 18 May 2004 18:23:55 +0000"  >&lt;p&gt;OK, might be better to make a copy of the passed-in configuration before&lt;br/&gt;
deleting elements to avoid that the original is destroyed.&lt;/p&gt;

&lt;p&gt;Alternatively addConfiguration could be left as is; and getList could be&lt;br/&gt;
modified to stop at the first match (aside from the InMemoryConfig). This way we&lt;br/&gt;
would get the documented behavior, but we&apos;ll lose the possibility to differ&lt;br/&gt;
between override and append modes.&lt;/p&gt;</comment>
                            <comment id="12406531" author="ebourg" created="Tue, 18 May 2004 18:33:47 +0000"  >&lt;p&gt;Some thoughts about this issue, maybe some refactoring is needed:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;remove the getList methods from CompositeConfiguration and rely on the default&lt;br/&gt;
implementation of AbstractConfiguration, that means the first list found is&lt;br/&gt;
returned just like the other properties.&lt;/li&gt;
	&lt;li&gt;rename CompositeConfiguration into CascadeConfiguration. CascadeConfiguration&lt;br/&gt;
would have 2 modes, a &quot;first declared element win&quot; and a &quot;last declared element&lt;br/&gt;
win&quot; mode.&lt;/li&gt;
	&lt;li&gt;create a UnionConfiguration or CombinedConfiguration similar to&lt;br/&gt;
CompositeConfiguration but with an additive semantic to the addConfiguration()&lt;br/&gt;
method.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Does this cover all use cases ?&lt;/p&gt;</comment>
                            <comment id="12406532" author="christian@siefkes.net" created="Tue, 18 May 2004 18:55:04 +0000"  >&lt;p&gt;I suppose you still have to provide a specialized getList implementation because&lt;br/&gt;
the default implementation would probably stop when finding a match in the&lt;br/&gt;
InMemoryConfiguration. But if the user has used _add_Property to add list&lt;br/&gt;
elements, they would expect the elements from the first matching&lt;br/&gt;
non-InMemoryConfiguration to be returned as well.&lt;/p&gt;

&lt;p&gt;Otherwise that sould very good; and I think it would cover all relevant cases.&lt;/p&gt;</comment>
                            <comment id="12406533" author="ebourg" created="Fri, 4 Jun 2004 20:10:29 +0000"  >&lt;p&gt;getList() now returns the elements from the first matching configuration and the&lt;br/&gt;
elements from the InMemoryConfiguration. It&apos;s a simple copy though, changes to&lt;br/&gt;
the list will not affect the lists in the original configurations.&lt;/p&gt;</comment>
                            <comment id="12406534" author="christian@siefkes.net" created="Mon, 7 Jun 2004 20:34:54 +0000"  >&lt;p&gt;Now it works as documented.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>28660</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 29 Apr 2004 05:45:26 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>33916</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 27 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0tfdr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>169801</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>