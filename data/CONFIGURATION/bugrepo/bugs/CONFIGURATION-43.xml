<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Thu Dec 01 19:57:34 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/CONFIGURATION-43/CONFIGURATION-43.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[CONFIGURATION-43] [configuration] BaseConfiguration.addProperty() and MapConfiguration.addProperty() do not behave the same</title>
                <link>https://issues.apache.org/jira/browse/CONFIGURATION-43</link>
                <project id="12310467" key="CONFIGURATION">Commons Configuration</project>
                    <description>&lt;p&gt;Hello,&lt;/p&gt;

&lt;p&gt;the contract of Configuration.addProperty(), namely to add the value to the list&lt;br/&gt;
of values for that property, is not held by MapConfiguration.addProperty() where&lt;br/&gt;
the previous value is simply replaced by the new one.&lt;/p&gt;

&lt;p&gt;Example 1 with a BaseConfiguration (OK):&lt;br/&gt;
conf = new BaseConfiguration();&lt;br/&gt;
conf.addProperty( &quot;key&quot;, &quot;value1&quot; ); // &quot;key&quot; --&amp;gt; &quot;value1&quot;&lt;br/&gt;
conf.addProperty( &quot;key&quot;, &quot;value2&quot; ); // &quot;key&quot; --&amp;gt; [ &quot;value1&quot;, &quot;value2&quot; ]&lt;/p&gt;

&lt;p&gt;Example 2 with a MapConfiguration (BAD):&lt;br/&gt;
conf = new BaseConfiguration();&lt;br/&gt;
conf.addProperty( &quot;key&quot;, &quot;value1&quot; ); // &quot;key&quot; --&amp;gt; &quot;value1&quot;&lt;br/&gt;
conf.addProperty( &quot;key&quot;, &quot;value2&quot; ); // &quot;key&quot; --&amp;gt; &quot;value2&quot; : CONTRACT NOT RESPECTED!&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: other&lt;br/&gt;
Platform: Other&lt;/p&gt;</environment>
        <key id="12342750">CONFIGURATION-43</key>
            <summary>[configuration] BaseConfiguration.addProperty() and MapConfiguration.addProperty() do not behave the same</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="smarc@gmx.net">smarc</reporter>
                        <labels>
                    </labels>
                <created>Tue, 29 Nov 2005 02:02:02 +0000</created>
                <updated>Sat, 22 Aug 2009 19:36:39 +0000</updated>
                            <resolved>Tue, 10 Apr 2007 14:46:23 +0000</resolved>
                                    <version>1.1</version>
                                    <fixVersion>1.2</fixVersion>
                                        <due></due>
                            <votes>1</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12410955" author="smarc@gmx.net" created="Tue, 29 Nov 2005 15:54:15 +0000"  >&lt;p&gt;(In reply to comment #0)&lt;/p&gt;

&lt;p&gt;little correction, should read:&lt;/p&gt;

&lt;p&gt;&amp;gt; Example 1 with a BaseConfiguration (OK):&lt;br/&gt;
&amp;gt; conf1 = new BaseConfiguration();&lt;br/&gt;
&amp;gt; conf1.addProperty( &quot;key&quot;, &quot;value1&quot; ); // &quot;key&quot; --&amp;gt; &quot;value1&quot;&lt;br/&gt;
&amp;gt; conf1.addProperty( &quot;key&quot;, &quot;value2&quot; ); // &quot;key&quot; --&amp;gt; [ &quot;value1&quot;, &quot;value2&quot; ]&lt;br/&gt;
&amp;gt; &lt;br/&gt;
&amp;gt; Example 2 with a MapConfiguration (BAD):&lt;br/&gt;
&amp;gt; conf2 = new MapConfiguration( new HashMap() );&lt;br/&gt;
&amp;gt; conf2.addProperty( &quot;key&quot;, &quot;value1&quot; ); // &quot;key&quot; --&amp;gt; &quot;value1&quot;&lt;br/&gt;
&amp;gt; conf2.addProperty( &quot;key&quot;, &quot;value2&quot; ); // &quot;key&quot; --&amp;gt; &quot;value2&quot; : CONTRACT NOT&lt;br/&gt;
RESPECTED!&lt;/p&gt;</comment>
                            <comment id="12410956" author="oliver.heger@t-online.de" created="Tue, 29 Nov 2005 21:39:46 +0000"  >&lt;p&gt;Looking at the source of MapConfiguration properties with multiple values seem&lt;br/&gt;
to be treated correctly.&lt;/p&gt;

&lt;p&gt;To be sure I ran the following test case:&lt;/p&gt;

&lt;p&gt;    public void testAddProperty()&lt;/p&gt;
    {
        Configuration config = new MapConfiguration(new HashMap());
        config.addProperty(&quot;key&quot;, &quot;value1&quot;);
        config.addProperty(&quot;key&quot;, &quot;value2&quot;);
        assertEquals(&quot;Property has only a single value&quot;, 2,
config.getList(&quot;key&quot;).size());
    }

&lt;p&gt;This works for me. So, could you please double check? Or didn&apos;t I understand&lt;br/&gt;
your problem correctly?&lt;/p&gt;</comment>
                            <comment id="12410957" author="smarc@gmx.net" created="Fri, 2 Dec 2005 23:40:13 +0000"  >&lt;p&gt;I created the same test as you (copy/paste) and the assertion failed: size()&lt;br/&gt;
returns 1. As I tried to explain it in the bug description, adding properties to&lt;br/&gt;
existing values simply overwrites the preceeding ones.&lt;/p&gt;

&lt;p&gt;I had a look at the code: AbstractConfiguration defines addProperty() which&lt;br/&gt;
calls the abstract addPropertyDirect(), which in turn is implemented in&lt;br/&gt;
MapConfiguration as follows:&lt;/p&gt;

&lt;p&gt;    protected void addPropertyDirect(String key, Object obj)&lt;/p&gt;
    {
        map.put(key, obj);
    }

&lt;p&gt;As Map.put() overwrites any existing values, the contract of addProperty is not&lt;br/&gt;
respected.&lt;/p&gt;

&lt;p&gt;I downloaded the binaries and sources from the apache website, current the&lt;br/&gt;
version is 1.1.&lt;/p&gt;

&lt;p&gt;So as it is working for you, I decided to look at the SVN version. The code for&lt;br/&gt;
addPropertyDirect seems to be better up there:&lt;/p&gt;

&lt;p&gt;    protected void addPropertyDirect(String key, Object value)&lt;br/&gt;
    {&lt;br/&gt;
        Object previousValue = getProperty(key);&lt;/p&gt;

&lt;p&gt;        if (previousValue == null)&lt;/p&gt;
        {
            map.put(key, value);
        }
&lt;p&gt;        else if (previousValue instanceof List)&lt;/p&gt;
        {
            // the value is added to the existing list
            ((List) previousValue).add(value);
        }
&lt;p&gt;        else&lt;/p&gt;
        {
            // the previous value is replaced by a list containing the previous
value and the new value
            List list = new ArrayList();
            list.add(previousValue);
            list.add(value);

            map.put(key, list);
        }
&lt;p&gt;    }&lt;/p&gt;

&lt;p&gt;So I think the bug I&apos;m describing has been fixed, but is not currently available&lt;br/&gt;
in the latest release... When is the next release planned for?&lt;/p&gt;</comment>
                            <comment id="12410958" author="oliver.heger@t-online.de" created="Sat, 3 Dec 2005 00:30:57 +0000"  >&lt;p&gt;We are in the process of getting the next release out. You can find the latest&lt;br/&gt;
release candidate here:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://people.apache.org/~oheger/commons-configuration-1.2RC2/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://people.apache.org/~oheger/commons-configuration-1.2RC2/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;(Your issue should have been fixed in this version.)&lt;/p&gt;

&lt;p&gt;If there are no unexpected issues, commons-configuration 1.2 final should be&lt;br/&gt;
available really soon now. There won&apos;t be much difference to the release&lt;br/&gt;
candidate mentioned above.&lt;/p&gt;

&lt;p&gt;Okay, I am closing this ticket now.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>37667</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 29 Nov 2005 21:39:46 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>33950</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 1 week, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0upgv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>177267</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>