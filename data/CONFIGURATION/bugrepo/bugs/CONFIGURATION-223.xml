<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Thu Dec 01 20:01:24 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/CONFIGURATION-223/CONFIGURATION-223.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[CONFIGURATION-223] PropertiesConfigurationLayout broke the autoSave behaviour of PropertiesConfiguration</title>
                <link>https://issues.apache.org/jira/browse/CONFIGURATION-223</link>
                <project id="12310467" key="CONFIGURATION">Commons Configuration</project>
                    <description>&lt;p&gt;When using  PropertiesConfiguration with autoSave &quot;true&quot; the PropertiesConfigurationLayout causes invalid properties files to be saved.&lt;/p&gt;

&lt;p&gt;When using addProperty(&quot;key&quot;, &quot;value&quot;); where key does not exist yet in the configuration the EVENT_ADD_PROPERTY event that updates the PropertiesConfigurationLayout with the new &quot;key&quot; is issued only after the possiblySave() method is invoked so the new property will not be saved.&lt;/p&gt;

&lt;p&gt;When using setProperty(&quot;key&quot;, &quot;value&quot;); where key does not exist yet in the configuration the EVENT_SET_PROPERTY event that updates the PropertiesConfigurationLayout with the new &quot;key&quot; is issued only after the possiblySave() method is invoked so the new property will not be saved.&lt;/p&gt;

&lt;p&gt;The way it is implemented now makes content of the saved file depending on PropertiesConfigurationLayout content that depends on an event that will be issued only after the file was properly updated. This creates a circular dependency that cannot work.&lt;/p&gt;
</description>
                <environment>&lt;p&gt;1.3RC1&lt;/p&gt;</environment>
        <key id="12348732">CONFIGURATION-223</key>
            <summary>PropertiesConfigurationLayout broke the autoSave behaviour of PropertiesConfiguration</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.png">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="oliver.heger@t-online.de">Oliver Heger</assignee>
                                    <reporter username="garu">Gabriele Garuglieri</reporter>
                        <labels>
                    </labels>
                <created>Mon, 28 Aug 2006 12:45:21 +0000</created>
                <updated>Sat, 22 Aug 2009 19:36:43 +0000</updated>
                            <resolved>Wed, 30 Aug 2006 19:21:32 +0000</resolved>
                                                    <fixVersion>1.3</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12431060" author="oliver.heger@t-online.de" created="Mon, 28 Aug 2006 20:32:00 +0000"  >&lt;p&gt;Will have a closer look at this issue.&lt;/p&gt;

&lt;p&gt;Perhaps the problem could be solved when AbstractFileConfiguration did not override addPropertyDirect(), but addProperty() and setProperty() (for calling the possiblySave() method). This would also have the advantage that adding of properties with multiple values would cause only one save() operation instead of one per property value.&lt;/p&gt;</comment>
                            <comment id="12431218" author="garu" created="Tue, 29 Aug 2006 10:47:06 +0000"  >&lt;p&gt;I guess it should work, but this would change the operations behaviour, making them more ore less &quot;atomic&quot;.&lt;br/&gt;
Understanding all the possible side effects of this change was too far from my actual knowledge of all internal subtleties and i couldn&apos;t afford the time to develop a patch for this.&lt;/p&gt;

&lt;p&gt;Anyway i attach a patch with some testcases you can use to verify the problem.&lt;/p&gt;

&lt;p&gt;Regards,  Gabriele&lt;/p&gt;

&lt;p&gt;PS: this broke all my JMX work on properties persistence... &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/sad.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="12431362" author="oliver.heger@t-online.de" created="Tue, 29 Aug 2006 20:33:17 +0000"  >&lt;p&gt;Thanks for the patch, this is really helpful. I changed AbstractFileConfiguration in the way mentioned above and everything seems to work. I will do some more testing.&lt;/p&gt;

&lt;p&gt;You are right that the behavior of these methods is now slightly different, but in this case I think it is an improvement. Calling addProperty() or setProperty() is now considered a single change and will result in only one auto save operation. This is fine IMO.&lt;/p&gt;

&lt;p&gt;Sorry for your JMX work. What makes me worrying is the fact that this significant bug was not detected by our unit test suite, though we have a pretty high code coverage. Obviously there is still room for improvement.&lt;/p&gt;</comment>
                            <comment id="12431661" author="oliver.heger@t-online.de" created="Wed, 30 Aug 2006 19:21:32 +0000"  >&lt;p&gt;The fix was committed. Everything seems to work now. Please double-check.&lt;/p&gt;

&lt;p&gt;Thanks.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12339761" name="223-test.patch" size="6887" author="garu" created="Tue, 29 Aug 2006 10:47:05 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 28 Aug 2006 20:32:00 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>33927</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 15 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uofb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>177098</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>