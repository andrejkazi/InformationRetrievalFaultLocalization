<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Wed Nov 30 23:22:30 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/LANG-727/LANG-727.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[LANG-727] ToStringBuilderTest.testReflectionHierarchyArrayList fails with IBM JDK 6</title>
                <link>https://issues.apache.org/jira/browse/LANG-727</link>
                <project id="12310481" key="LANG">Commons Lang</project>
                    <description>&lt;p&gt;The unit test fails when running with IBM JDK 6:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Failed tests:&#160;
&#160;&#160;testReflectionHierarchyArrayList(org.apache.commons.lang3.builder.ToStringBuilderTest):&#160;null&#160;
expected:&amp;lt;....ArrayList@115b115b[[elementData={&amp;lt;null&amp;gt;,&amp;lt;null&amp;gt;,&amp;lt;null&amp;gt;,&amp;lt;null&amp;gt;,&amp;lt;null&amp;gt;,&amp;lt;null&amp;gt;,&amp;lt;null&amp;gt;,null&amp;gt;,null&amp;gt;,null&amp;gt;},size=0],modCount=0]&amp;gt;
but was:&amp;lt;....ArrayList@115b115b[[firstIndex=0,lastIndex=0,array={&amp;lt;null&amp;gt;,&amp;lt;null&amp;gt;,&amp;lt;null&amp;gt;,&amp;lt;null&amp;gt;,&amp;lt;null&amp;gt;,&amp;lt;null&amp;gt;,&amp;lt;null&amp;gt;,null&amp;gt;,null&amp;gt;,null&amp;gt;}],modCount=0]&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Actually the test is wrong, because it makes wrong assumptions about the implementation of ArrayList in the runtime.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12514171">LANG-727</key>
            <summary>ToStringBuilderTest.testReflectionHierarchyArrayList fails with IBM JDK 6</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="5" iconUrl="https://issues.apache.org/jira/images/icons/priorities/trivial.png">Trivial</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="joehni">Joerg Schaible</assignee>
                                    <reporter username="joehni">Joerg Schaible</reporter>
                        <labels>
                    </labels>
                <created>Fri, 15 Jul 2011 06:58:19 +0000</created>
                <updated>Wed, 16 Nov 2011 06:56:36 +0000</updated>
                            <resolved>Sat, 6 Aug 2011 15:44:14 +0000</resolved>
                                    <version>3.0</version>
                                    <fixVersion>3.0.1</fixVersion>
                                    <component>lang.builder.*</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="13071496" author="bayard" created="Wed, 27 Jul 2011 03:03:35 +0000"  >&lt;p&gt;Looking at the code:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
        assertEquals(baseStr + &lt;span class=&quot;code-quote&quot;&gt;&quot;[elementData={&amp;lt;&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;&amp;gt;,&amp;lt;&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;&amp;gt;,&amp;lt;&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;&amp;gt;,&amp;lt;&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;&amp;gt;,&amp;lt;&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;&amp;gt;,&amp;lt;&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;&amp;gt;,&amp;lt;&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;&amp;gt;,&amp;lt;&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;&amp;gt;,&amp;lt;&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;&amp;gt;,&amp;lt;&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;&amp;gt;},size=0,modCount=0]&quot;&lt;/span&gt;, ToStringBuilder.reflectionToString(base, &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;, &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;));
        assertEquals(baseStr + &lt;span class=&quot;code-quote&quot;&gt;&quot;[size=0]&quot;&lt;/span&gt;, ToStringBuilder.reflectionToString(base, &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;, &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;));
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I think the 2nd test should pass as there&apos;s only one item. So just the first one to fix. I think we can use StringUtils.contains, ie:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
        &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; result = ToStringBuilder.reflectionToString(base, &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;, &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;);
        assertTrue( StringUtils.startsWith(result, baseStr + &lt;span class=&quot;code-quote&quot;&gt;&quot;[&quot;&lt;/span&gt;) );
        assertTrue( StringUtils.contains(result, &lt;span class=&quot;code-quote&quot;&gt;&quot;[elementData={&amp;lt;&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;&amp;gt;,&amp;lt;&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;&amp;gt;,&amp;lt;&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;&amp;gt;,&amp;lt;&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;&amp;gt;,&amp;lt;&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;&amp;gt;,&amp;lt;&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;&amp;gt;,&amp;lt;&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;&amp;gt;,&amp;lt;&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;&amp;gt;,&amp;lt;&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;&amp;gt;,&amp;lt;&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;&amp;gt;}&quot;&lt;/span&gt; ) );
        assertTrue( StringUtils.contains(result, &lt;span class=&quot;code-quote&quot;&gt;&quot;size=0&quot;&lt;/span&gt;) );
        assertTrue( StringUtils.contains(result, &lt;span class=&quot;code-quote&quot;&gt;&quot;modCount=0&quot;&lt;/span&gt;) );
        assertTrue( StringUtils.endsWith(result, &lt;span class=&quot;code-quote&quot;&gt;&quot;]&quot;&lt;/span&gt;) );
        assertEquals(baseStr + &lt;span class=&quot;code-quote&quot;&gt;&quot;[size=0]&quot;&lt;/span&gt;, ToStringBuilder.reflectionToString(base, &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;, &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;));
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Is that something you could easily test in JDK 6 and commit?&lt;/p&gt;

&lt;p&gt;I also suspect that we should hard code the elementData size by doing ArrayList(10).&lt;/p&gt;</comment>
                            <comment id="13071764" author="mbenson" created="Wed, 27 Jul 2011 14:30:12 +0000"  >&lt;p&gt;Alternatively, when we know that we&apos;re making assumptions about a class&apos;s inner implementation, we could upgrade the test to JUnit 4 and add an assumption at the beginning of the test wrt the particular JVM vendor.&lt;/p&gt;</comment>
                            <comment id="13072564" author="bayard" created="Thu, 28 Jul 2011 22:19:19 +0000"  >&lt;p&gt;It&apos;s a bad assumption &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13072591" author="mbenson" created="Thu, 28 Jul 2011 23:08:58 +0000"  >&lt;p&gt;right, so the test will be skipped whenever the assumption proves to have been incorrect...&lt;/p&gt;</comment>
                            <comment id="13076061" author="bayard" created="Tue, 2 Aug 2011 06:15:33 +0000"  >&lt;p&gt;I&apos;ve applied the code change I proposed.&lt;/p&gt;

&lt;p&gt;svn ci -m &quot;Rearranging the testReflectionHierarchyArrayList test per &lt;a href=&quot;https://issues.apache.org/jira/browse/LANG-727&quot; title=&quot;ToStringBuilderTest.testReflectionHierarchyArrayList fails with IBM JDK 6&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LANG-727&quot;&gt;&lt;del&gt;LANG-727&lt;/del&gt;&lt;/a&gt;; shouldn&apos;t make assumptions about ArrayList now&quot;&lt;br/&gt;
Sending        src/test/java/org/apache/commons/lang3/builder/ToStringBuilderTest.java&lt;br/&gt;
Transmitting file data .&lt;br/&gt;
Committed revision 1153037.&lt;/p&gt;</comment>
                            <comment id="13076085" author="joehni" created="Tue, 2 Aug 2011 07:45:31 +0000"  >&lt;p&gt;Sorry to say, but it will still fail. See the error message. On IBM JDK there is no &quot;elementData&quot; member at all.&lt;/p&gt;</comment>
                            <comment id="13078436" author="joehni" created="Tue, 2 Aug 2011 21:13:17 +0000"  >&lt;p&gt;Actually I am not sure what the test shall demonstrate. Is it a special type construction that is arbitrarily present in ArrayList or does it demonstrate that it can also handle an ArrayList. If it is the latter then we have to check for a different String representation with IBM JDK 6 runtime, because it exposes implementation details of the type.&lt;/p&gt;</comment>
                            <comment id="13078443" author="mbenson" created="Tue, 2 Aug 2011 21:21:38 +0000"  >&lt;p&gt;I maintain that this test just verifies expectations of the code when running under a certain set of assumptions, including &quot;the ArrayList implementation in use has an elementData member.&quot;  If we know that that means the Sun JDK, we should just turn the test off under other circumstances.  It&apos;s not like we don&apos;t have the vendor info readily available; this &lt;em&gt;is&lt;/em&gt; Commons Lang, after all.&lt;/p&gt;</comment>
                            <comment id="13078586" author="bayard" created="Wed, 3 Aug 2011 04:48:06 +0000"  >&lt;p&gt;1) Doh &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; I&apos;ll revert the commit.&lt;br/&gt;
2) Happy with your Sun JDK only approach Matt.&lt;br/&gt;
3) I assume the test is to show it can handle ArrayList too.&lt;/p&gt;</comment>
                            <comment id="13078587" author="bayard" created="Wed, 3 Aug 2011 04:49:52 +0000"  >&lt;p&gt;svn ci -m &quot;Rolling back r1153037 and r1153038 - the changes didn&apos;t help&quot;&lt;br/&gt;
Sending        src/test/java/org/apache/commons/lang3/builder/ToStringBuilderTest.java&lt;br/&gt;
Transmitting file data .&lt;br/&gt;
Committed revision 1153343.&lt;/p&gt;</comment>
                            <comment id="13079801" author="joehni" created="Fri, 5 Aug 2011 06:35:01 +0000"  >&lt;p&gt;If you postpone this issue, don&apos;t forget to drop it again from changes.xml also &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13079977" author="mbenson" created="Fri, 5 Aug 2011 13:51:02 +0000"  >&lt;p&gt;I presume the property we&apos;d need to check would be &lt;b&gt;java.vendor&lt;/b&gt; as opposed to &lt;b&gt;java.vm.vendor&lt;/b&gt;, but I&apos;d be glad for a second opinion.  Note that the test also passes on an Apple JDK, so I&apos;d prefer we disable it only on IBM for now until/unless we encounter another classlib that gives us the same problem.&lt;/p&gt;

&lt;p&gt;Joerg, can you give us the java.vendor values for whichever JDKs fail?  Or, for example, does the test pass on an earlier IBM JDK?  If so, can you give me whatever property values I need to distinguish the environment in which we expect a failure?&lt;/p&gt;

&lt;p&gt;Thanks!&lt;/p&gt;</comment>
                            <comment id="13079997" author="joehni" created="Fri, 5 Aug 2011 14:45:43 +0000"  >&lt;p&gt;java.specification.version: 1.6&lt;br/&gt;
java.vm.vendor: IBM Corporation&lt;/p&gt;

&lt;p&gt;IBM JDK 1.5 works. Maybe we can compare the strings and if they&apos;re not equal, we look for the JDK. For this one we can print a known issue to sysout, for all others we should fail.&lt;/p&gt;</comment>
                            <comment id="13080001" author="mbenson" created="Fri, 5 Aug 2011 14:55:45 +0000"  >&lt;p&gt;We &lt;em&gt;could&lt;/em&gt; do it that way, though it would at least make the test less concise.  So is it your opinion that the java.vm.vendor is the important thing here, rather than the java.vendor?  I would have thought that &lt;b&gt;java&lt;/b&gt; would signify the class library in use while &lt;b&gt;vm&lt;/b&gt; would signify only that (the VM).  WDYT?  What is the value of java.vendor?&lt;/p&gt;</comment>
                            <comment id="13080068" author="joehni" created="Fri, 5 Aug 2011 16:49:38 +0000"  >&lt;p&gt;java.vendor is the same. Actually we don&apos;t have to take this issue too serious. The implementation can handle the ArrayList also for IBM JDK 6. The internals are different but it provides proper information. It&apos;s the test that is flaky with its assumptions. Therefore I&apos;d add a comment to state the fact that the result depends on the implementation details of ArrayList that is vendor/version specific. IBM JDK 6 is known for the difference and is currently the only known one with different implementation.&lt;/p&gt;</comment>
                            <comment id="13080415" author="joehni" created="Sat, 6 Aug 2011 15:43:56 +0000"  >&lt;p&gt;Committed revision 1154530.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 27 Jul 2011 03:03:35 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>65852</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 17 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0d5h3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>74663</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>