<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Wed Nov 30 23:10:52 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/LANG-75/LANG-75.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[LANG-75] NumberUtils.createBigDecimal(&quot;&quot;) NPE in Sun 1.3.1_08</title>
                <link>https://issues.apache.org/jira/browse/LANG-75</link>
                <project id="12310481" key="LANG">Commons Lang</project>
                    <description>&lt;p&gt;Hello,&lt;/p&gt;

&lt;p&gt;The NumberUtils.createXXX methods all have the following pattern:&lt;/p&gt;

&lt;p&gt;public static XXX createXXX(String str) {&lt;br/&gt;
   if (str == null) &lt;/p&gt;
{
      return null;
   }&lt;br/&gt;
&lt;br/&gt;
In the case of BigDecimal, passing in a &quot;&quot; to new BigDecimal(String) in Sun&lt;br/&gt;
1.3.1_08 blows up like this:&lt;br/&gt;
&lt;br/&gt;
java.lang.StringIndexOutOfBoundsException: String index out of range: 0&lt;br/&gt;
	at java.lang.String.charAt(String.java:582)&lt;br/&gt;
	at java.math.BigDecimal.&amp;lt;init&amp;gt;(BigDecimal.java:124)&lt;br/&gt;
	at org.apache.commons.lang.math.NumberUtils.createBigDecimal(NumberUtils.java:4&lt;br/&gt;
78)&lt;br/&gt;
	at org.apache.commons.lang.math.NumberUtilsTest.testCreateBigDecimal(NumberUtil&lt;br/&gt;
sTest.java:209)&lt;br/&gt;
&lt;br/&gt;
Under Sun 1.4.2, you get a NumberFormatException if the length of the string is&lt;br/&gt;
0 (no trim()). The unit tests expect a NumberFormatException when you pass in &quot;&quot;.&lt;br/&gt;
&lt;br/&gt;
So... to make this all nice on 1.3, should all of the guard clauses become:&lt;br/&gt;
&lt;br/&gt;
(1)&lt;br/&gt;
&lt;br/&gt;
   if (StringUtil.isEmpty(str)) {      return null;   }

&lt;p&gt;(2)&lt;/p&gt;

&lt;p&gt;   if (StringUtil.isBlank(str)) &lt;/p&gt;
{
      return null;
   }&lt;br/&gt;
&lt;br/&gt;
(3)&lt;br/&gt;
&lt;br/&gt;
   if (str == null) {      return null;   }
&lt;p&gt;   if (StringUtil.isEmpty(str)) &lt;/p&gt;
{
      return str;
   }
&lt;p&gt;?&lt;/p&gt;

&lt;p&gt;I think (2) would be good since it would not blow up on &quot;&quot; AND &quot; &quot; but I am not&lt;br/&gt;
familiar with the various invocation contexts, so, please opine.&lt;/p&gt;

&lt;p&gt;Thanks,&lt;br/&gt;
Gary&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: other&lt;br/&gt;
Platform: Other&lt;/p&gt;</environment>
        <key id="12340874">LANG-75</key>
            <summary>NumberUtils.createBigDecimal(&quot;&quot;) NPE in Sun 1.3.1_08</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="garydgregory">Gary Gregory</reporter>
                        <labels>
                    </labels>
                <created>Sat, 26 Jul 2003 10:20:13 +0000</created>
                <updated>Wed, 16 Oct 2013 08:54:58 +0000</updated>
                            <resolved>Tue, 16 May 2006 12:36:56 +0000</resolved>
                                                    <fixVersion>2.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12404753" author="phil@steitz.com" created="Sat, 26 Jul 2003 22:30:57 +0000"  >&lt;p&gt;I would favor keeping the current contract in place, patching to make things&lt;br/&gt;
work in JDK &amp;lt; 1.4.  My understanding of the current contract is&lt;/p&gt;

&lt;p&gt;&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/information.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;   null |-&amp;gt; null&lt;/p&gt;

&lt;p&gt;(ii)  valid representable numeric string |-&amp;gt; value represented&lt;/p&gt;

&lt;p&gt;(iii) invalid string |-&amp;gt; NumberFormatException&lt;/p&gt;

&lt;p&gt;&quot;&quot; and &quot; &quot; fall under (iii). (Need to add tests for &quot; &quot;.)&lt;/p&gt;

&lt;p&gt;One way to achieve this would be to change the guard on the createXxx methods to: &lt;/p&gt;

&lt;p&gt;(4)&lt;/p&gt;

&lt;p&gt;  if (str == null) &lt;/p&gt;
{
      return null;
  }&lt;br/&gt;
  if (StringUtils.isBlank(str)) {
      throw new NumberFormatException(&quot;A blank string is not a valid Xxx.&quot;);
  }  &lt;br/&gt;
&lt;br/&gt;
Or even (following createNumber)&lt;br/&gt;
&lt;br/&gt;
(5)&lt;br/&gt;
&lt;br/&gt;
  if (str == null) {
      return null;
  }
&lt;p&gt;  if (str.length() == 0) &lt;/p&gt;
{
            throw new NumberFormatException(&quot;\&quot;\&quot; is not a valid Xxx.&quot;);
  }

&lt;p&gt;This should work, but we would have to add tests to verify that &quot; &quot; throws&lt;br/&gt;
NumberformatException in all cases, all JDKs when the conversion is attempted.&lt;/p&gt;

&lt;p&gt;Phil&lt;/p&gt;</comment>
                            <comment id="12404754" author="scolebourne@joda.org" created="Sat, 26 Jul 2003 22:48:55 +0000"  >&lt;p&gt;I agree with Phil&apos;s comments, and option 4&lt;/p&gt;</comment>
                            <comment id="12404755" author="phil@steitz.com" created="Sun, 27 Jul 2003 01:46:44 +0000"  >&lt;p&gt;I have added tests for &quot; &quot; locally and run against 1.4.2, 1.3.1_08 and 1.2_2_016&lt;br/&gt;
and found that all tests (including &quot; &quot;) give expected results with current code&lt;br/&gt;
in all cases with the one exception of createBigDecimal on 1.3.1_08. I see this&lt;br/&gt;
as a JDK bug. Therefore I think that my option (4) is overkill, introducing a&lt;br/&gt;
needless function call and string search for each activation to handle an&lt;br/&gt;
isolated JDK bug. &lt;/p&gt;

&lt;p&gt;I would recommend option (5), possibly applied only to createBigDecimal (i.e.&lt;br/&gt;
leave the other methods alone).  &lt;/p&gt;
</comment>
                            <comment id="12404756" author="ggregory@seagullsw.com" created="Sun, 27 Jul 2003 02:18:23 +0000"  >&lt;p&gt;Fixes commited as suggested but with the guard clause factored in a method. &lt;br/&gt;
The tests pass on:&lt;/p&gt;

&lt;p&gt;java version &quot;1.3.1_08&quot;&lt;br/&gt;
Java(TM) 2 Runtime Environment, Standard Edition (build 1.3.1_08-b03)&lt;br/&gt;
Java HotSpot(TM) Client VM (build 1.3.1_08-b03, mixed mode)&lt;/p&gt;

&lt;p&gt;java version &quot;1.4.2&quot;&lt;br/&gt;
Java(TM) 2 Runtime Environment, Standard Edition (build 1.4.2-b28)&lt;br/&gt;
Java HotSpot(TM) Client VM (build 1.4.2-b28, mixed mode)&lt;/p&gt;
</comment>
                            <comment id="12404757" author="ggregory@seagullsw.com" created="Sun, 27 Jul 2003 02:21:00 +0000"  >&lt;p&gt;Ah! It looks like we are stepping on each others Bugzilla toes &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;Feel free to change the NumberUtils code as you best see fit but do note the&lt;br/&gt;
added bullet-proofing I&apos;ve added to the unit tests, I believe these changes&lt;br/&gt;
should stay in.&lt;/p&gt;</comment>
                            <comment id="12404758" author="phil@steitz.com" created="Sun, 27 Jul 2003 06:38:34 +0000"  >&lt;p&gt;Sorry to keep going back and forth on this, but I think that just patching&lt;br/&gt;
createBigDecimal is sufficient.  I am attaching a patch to do this.  The new&lt;br/&gt;
(better!) tests all succeed with this patch under 1.4.2, 1.3.1_08 and 1.2_2_016.&lt;/p&gt;

&lt;p&gt;I am OK with either Gary&apos;s mods or the more limited patch attached below.  Both&lt;br/&gt;
solve the problem.   &lt;/p&gt;</comment>
                            <comment id="12404759" author="phil@steitz.com" created="Sun, 27 Jul 2003 06:41:31 +0000"  >&lt;p&gt;Created an attachment (id=7530)&lt;br/&gt;
NumberUtils patch fixing only createBigDecimal&lt;/p&gt;</comment>
                            <comment id="12404760" author="scolebourne@joda.org" created="Tue, 29 Jul 2003 04:41:07 +0000"  >&lt;p&gt;OK, I&apos;ve had a look at this.&lt;/p&gt;

&lt;p&gt;I agree with Phil&apos;s last comments that the extra checking is generally not &lt;br/&gt;
required, and that we should treat this as a JDK bug workaround. (Performance &lt;br/&gt;
matters too)&lt;/p&gt;

&lt;p&gt;So, I&apos;ve removed the validate method and retested on JDK1.2.2, 1.3.1 and 1.4.1 &lt;br/&gt;
and all is fine.&lt;/p&gt;</comment>
                            <comment id="12404761" author="ggregory@seagullsw.com" created="Tue, 29 Jul 2003 05:04:16 +0000"  >&lt;p&gt;Great, thanks for tidying things up.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12332434" name="ASF.LICENSE.NOT.GRANTED--numberUtilsPatch.txt" size="3840" author="phil@steitz.com" created="Sun, 27 Jul 2003 06:41:31 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>21904</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Sat, 26 Jul 2003 22:30:57 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>147034</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            13 years, 20 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0d6xr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>74900</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>