<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Wed Nov 30 23:13:28 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/LANG-140/LANG-140.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[LANG-140] [lang] DurationFormatUtils.formatPeriod() returns the wrong result</title>
                <link>https://issues.apache.org/jira/browse/LANG-140</link>
                <project id="12310481" key="LANG">Commons Lang</project>
                    <description>&lt;p&gt;/**&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;lib: commons-lang-2.1.jar&lt;/li&gt;
	&lt;li&gt;&lt;/li&gt;
	&lt;li&gt;this class run result.&lt;/li&gt;
	&lt;li&gt;Result:&lt;/li&gt;
	&lt;li&gt;Date1-&amp;gt;Date2=2006/01/26 18:47:34 000-&amp;gt;2006/02/26 10:47:34 000===0000&amp;rdquo;N01&lt;br/&gt;
&#140;&#142;-1&amp;ldquo;&#250; 16:00:00 000&lt;/li&gt;
	&lt;li&gt;Date1-&amp;gt;Date2=2006/01/26 18:47:34 000-&amp;gt;2006/02/26 10:47:34 000===0000/01/-&lt;br/&gt;
1 16:00:00 000&lt;/li&gt;
	&lt;li&gt;want result:&lt;/li&gt;
	&lt;li&gt;Date1-&amp;gt;Date2=2006/01/26 18:47:34 000-&amp;gt;2006/02/26 10:47:34 000===0000&amp;rdquo;N00&#140;&#142;&lt;br/&gt;
30&amp;ldquo;&#250; 16:00:00&lt;/li&gt;
	&lt;li&gt;Date1-&amp;gt;Date2=2006/01/26 18:47:34 000-&amp;gt;2006/02/26 10:47:34&lt;br/&gt;
000===0000/00/30 16:00:00&lt;/li&gt;
	&lt;li&gt;&lt;/li&gt;
	&lt;li&gt;&lt;/li&gt;
	&lt;li&gt;the results are wrong.&lt;/li&gt;
	&lt;li&gt;&lt;p&gt; */&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;import java.text.SimpleDateFormat;&lt;br/&gt;
import java.util.Calendar;&lt;br/&gt;
import java.util.Date;&lt;/p&gt;

&lt;p&gt;import org.apache.commons.lang.time.DurationFormatUtils;&lt;/p&gt;

&lt;p&gt;public class Test {&lt;/p&gt;

&lt;p&gt;    static SimpleDateFormat formatter = new SimpleDateFormat(&quot;yyyy/MM/dd &lt;br/&gt;
HH:mm:ss SSS&quot;);&lt;/p&gt;


&lt;p&gt;    public static void main(String[] args) &lt;/p&gt;
{
        Date date1 = newDate(2006, 1, 26, 18, 47, 34);
        Date date2 = newDate(2006, 2, 26, 10, 47, 34);
        System.out.println(&quot;Date1-&amp;gt;Date2=&quot; + 
                formatter.format(date1) + &quot;-&amp;gt;&quot; + formatter.format(date2) 
+ &quot;===&quot; +  
                DurationFormatUtils.formatPeriod(date1.getTime(), date2.getTime
(), &quot;yyyy&amp;rdquo;NMM&#140;&#142;dd&amp;ldquo;&#250; HH:mm:ss SSS&quot;) );

        System.out.println(&quot;Date1-&amp;gt;Date2=&quot; + 
                formatter.format(date1) + &quot;-&amp;gt;&quot; + formatter.format(date2) 
+ &quot;===&quot; +  
                DurationFormatUtils.formatPeriod(date1.getTime(), date2.getTime
(), &quot;yyyy/MM/dd HH:mm:ss SSS&quot;) );
    
    }

&lt;p&gt;    public static Date newDate(int y, int m, int d, int h, int mi, int s) &lt;/p&gt;
{
        Calendar calendar1 = Calendar.getInstance();
        calendar1.clear();
        calendar1.set(y, m - 1, d, h, mi, s);
        Date date1 = calendar1.getTime();
        return date1;
    }

&lt;p&gt;}&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: Windows XP&lt;br/&gt;
Platform: PC&lt;/p&gt;</environment>
        <key id="12342874">LANG-140</key>
            <summary>[lang] DurationFormatUtils.formatPeriod() returns the wrong result</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="bayard">Henri Yandell</assignee>
                                    <reporter username="yuhere@gmail.com">yu.peng</reporter>
                        <labels>
                    </labels>
                <created>Thu, 26 Jan 2006 22:41:00 +0000</created>
                <updated>Tue, 6 Feb 2007 23:47:17 +0000</updated>
                            <resolved>Mon, 19 Jun 2006 19:49:40 +0000</resolved>
                                                    <fixVersion>2.2</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12411327" author="bayard" created="Thu, 9 Mar 2006 16:18:53 +0000"  >&lt;p&gt;So it&apos;s claiming it&apos;s 1 month minus 1 day and not 30 days. Ugh.&lt;/p&gt;

&lt;p&gt;Looking into it, the issue is that when the code rolls back in hours, it rolls&lt;br/&gt;
the days back - even if 0. It needs to roll months back if days are 0 (and so on&lt;br/&gt;
back up to years).&lt;/p&gt;</comment>
                            <comment id="12411328" author="bayard" created="Thu, 9 Mar 2006 16:21:38 +0000"  >&lt;p&gt;Not that easy though. Needs to be, for this particular case:&lt;/p&gt;


&lt;p&gt;If days = 0, then roll month back (from 1 to 0) and set days to the maximum&lt;br/&gt;
number of days in the preceding month (which is January and thus 30). &lt;/p&gt;

&lt;p&gt;It gets ugly when you get down to the seconds, as their rollback effect becomes&lt;br/&gt;
an increasingly nested loop.&lt;/p&gt;</comment>
                            <comment id="12411329" author="ggregory@seagullsw.com" created="Fri, 10 Mar 2006 02:34:19 +0000"  >&lt;p&gt;In the context of Ticket 33825&lt;br/&gt;
(&lt;a href=&quot;http://issues.apache.org/bugzilla/show_bug.cgi?id=33825&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/bugzilla/show_bug.cgi?id=33825&lt;/a&gt;), one can consider&lt;br/&gt;
Joda-Time.&lt;/p&gt;</comment>
                            <comment id="12411330" author="yuhere@gmail.com" created="Fri, 10 Mar 2006 17:28:52 +0000"  >&lt;p&gt;Created an attachment (id=17861)&lt;br/&gt;
period &lt;/p&gt;

&lt;p&gt;there is a &quot;period&quot; method in this file , that method can return the period&lt;br/&gt;
String , can&apos;t format it , because the some format methods are use &apos;package&apos;&lt;br/&gt;
defined. I hope the &quot;period&quot; method can add into the common_lang lib,and&lt;br/&gt;
provides the format function.&lt;/p&gt;</comment>
                            <comment id="12411331" author="bayard" created="Mon, 17 Apr 2006 13:22:52 +0000"  >&lt;p&gt;Created an attachment (id=18111)&lt;br/&gt;
Unit test for this bug.&lt;/p&gt;</comment>
                            <comment id="12412097" author="bayard" created="Wed, 17 May 2006 13:04:38 +0000"  >&lt;p&gt;Hooking Period.java up, it gives a couple of errors:&lt;/p&gt;

&lt;p&gt;Testsuite: org.apache.commons.lang.time.TimeTestSuite&lt;br/&gt;
Tests run: 54, Failures: 2, Errors: 0, Time elapsed: 5.777 sec&lt;/p&gt;

&lt;p&gt;Testcase: testFormatPeriodISO(org.apache.commons.lang.time.DurationFormatUtilsTest):    FAILED&lt;br/&gt;
expected:&amp;lt;......&amp;gt; but was:&amp;lt;...3...&amp;gt;&lt;br/&gt;
junit.framework.ComparisonFailure: expected:&amp;lt;......&amp;gt; but was:&amp;lt;...3...&amp;gt;&lt;br/&gt;
        at org.apache.commons.lang.time.DurationFormatUtilsTest.testFormatPeriodISO(DurationFormatUtilsTest.java:285)&lt;br/&gt;
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;br/&gt;
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)&lt;br/&gt;
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)&lt;/p&gt;


&lt;p&gt;Testcase: testFormatPeriod(org.apache.commons.lang.time.DurationFormatUtilsTest):       FAILED&lt;br/&gt;
expected:&amp;lt;6...&amp;gt; but was:&amp;lt;...&amp;gt;&lt;br/&gt;
junit.framework.ComparisonFailure: expected:&amp;lt;6...&amp;gt; but was:&amp;lt;...&amp;gt;&lt;br/&gt;
        at org.apache.commons.lang.time.DurationFormatUtilsTest.testFormatPeriod(DurationFormatUtilsTest.java:319)&lt;br/&gt;
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;br/&gt;
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)&lt;br/&gt;
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)&lt;/p&gt;</comment>
                            <comment id="12412098" author="bayard" created="Wed, 17 May 2006 13:06:14 +0000"  >&lt;p&gt;Period.java put into the source. Other tests unfortunately error.&lt;/p&gt;</comment>
                            <comment id="12412711" author="yuhere@gmail.com" created="Mon, 22 May 2006 07:52:24 +0000"  >&lt;p&gt;How can I get the DurationFormatUtilsTest.java and fixed DurationFormatUtils.java.&lt;/p&gt;</comment>
                            <comment id="12416757" author="bayard" created="Mon, 19 Jun 2006 19:49:40 +0000"  >
&lt;p&gt;Fix committed. Played with it while on holiday and found that there was a nice simple fix (least all the unit tests pass with this fix and it seems to make sense). The nightly build appears to be down currently, so the way to get to the code would be to svn co &lt;a href=&quot;https://svn.apache.org/repos/asf/jakarta/commons/proper/lang/trunk&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://svn.apache.org/repos/asf/jakarta/commons/proper/lang/trunk&lt;/a&gt; and build a jar using ant or maven.&lt;/p&gt;

&lt;p&gt;svn ci -m &quot;Added unit test for &lt;a href=&quot;https://issues.apache.org/jira/browse/LANG-140&quot; title=&quot;[lang] DurationFormatUtils.formatPeriod() returns the wrong result&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LANG-140&quot;&gt;&lt;del&gt;LANG-140&lt;/del&gt;&lt;/a&gt; - thanks to Yu Peng for the test case&quot; src/t&lt;br/&gt;
est/org/apache/commons/lang/time/DurationFormatUtilsTest.java &lt;br/&gt;
Sending        src/test/org/apache/commons/lang/time/DurationFormatUtilsTest.java&lt;br/&gt;
Transmitting file data .&lt;br/&gt;
Committed revision 415316.&lt;/p&gt;

&lt;p&gt; svn ci -m &quot;Committing fix for &lt;a href=&quot;https://issues.apache.org/jira/browse/LANG-140&quot; title=&quot;[lang] DurationFormatUtils.formatPeriod() returns the wrong result&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LANG-140&quot;&gt;&lt;del&gt;LANG-140&lt;/del&gt;&lt;/a&gt;. By reversing the order of field calculation,&lt;br/&gt;
 Yu Peng&apos;s bug goes away&quot; src/java/org/apache/commons/lang/time/DurationFormatUtils.java &lt;br/&gt;
Sending        src/java/org/apache/commons/lang/time/DurationFormatUtils.java&lt;br/&gt;
Transmitting file data .&lt;br/&gt;
Committed revision 415317.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12334005" name="ASF.LICENSE.NOT.GRANTED--38401.patch" size="1333" author="bayard" created="Mon, 17 Apr 2006 13:22:52 +0000"/>
                            <attachment id="12334004" name="ASF.LICENSE.NOT.GRANTED--Period.java" size="3971" author="yuhere@gmail.com" created="Fri, 10 Mar 2006 17:28:52 +0000"/>
                            <attachment id="12334216" name="LANG-140.patch" size="4043" author="bayard" created="Wed, 17 May 2006 13:06:14 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>38401</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 9 Mar 2006 16:18:53 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>34115</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 25 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0d6jb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>74835</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>