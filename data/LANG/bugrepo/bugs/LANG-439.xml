<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Wed Nov 30 23:47:02 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/LANG-439/LANG-439.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[LANG-439] StringEscapeUtils.escapeHTML() does not escape chars (0x00-0x20)</title>
                <link>https://issues.apache.org/jira/browse/LANG-439</link>
                <project id="12310481" key="LANG">Commons Lang</project>
                    <description>&lt;p&gt;I encountered this problem when I sent html from the server to a client using AjaxRequest. HTML was escaped wrapped in CDATA. I thought it was pretty safe. See my xml fragment below:&lt;br/&gt;
//------------------------------------------------------------------------------------------&lt;br/&gt;
&amp;lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&amp;gt;&lt;br/&gt;
&amp;lt;ajax-fragment&amp;gt;&lt;br/&gt;
&amp;lt;html-rows&amp;gt;&lt;br/&gt;
&amp;lt;![CDATA[&lt;br/&gt;
&amp;lt;div style=&quot;padding-left: 1px;&quot; class=&quot;columnContent4  column4&quot;&amp;gt;&lt;br/&gt;
&amp;lt;span  column-id=&quot;Message&quot;  class=&quot;cellContent&quot;  onmouseover=&quot;w12450823.onDwell(event); w12450823.onCellSelectionOnMouseOver(event);&quot;  onclick=&quot;w12450823.onCellSelectionOnClick(event)&quot;  &amp;gt;May 29 10:48:29 rdia643 su: - 2 nitroqa-nss&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&lt;br/&gt;
]]&amp;gt;&lt;br/&gt;
&amp;lt;/html-rows&amp;gt;&lt;br/&gt;
&amp;lt;/ajax-fragment&amp;gt;&lt;br/&gt;
//------------------------------------------------------------------------------------------&lt;br/&gt;
However in FF2 there was js error:&lt;br/&gt;
//-------------------------------------------------------------------------------------------- &lt;br/&gt;
Error: not well-formed&lt;br/&gt;
Source Code:&lt;br/&gt;
&amp;lt;span  column-id=&quot;Message&quot;  class=&quot;cellContent &quot;  onmouseover=&quot;w12450823.onDwell(event); w12450823.onCellSelectionOnMouseOver(event); &quot; onclick=&quot;w12450823.onCellSelectionOnClick(event)&quot;  &amp;gt;May 29 10:48:29 rdia643 su: - 2 nitroqa-nss&amp;lt;/span&amp;gt;&amp;lt;/div&lt;br/&gt;
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------^&lt;br/&gt;
I figured out that StringEscapeUtils.escapeHTML() did not escape one of the characters. it was a &apos;\b&apos;(ascii 8).&lt;br/&gt;
I had to change to org.apache.commons.lang.Entities.excape() method:&lt;br/&gt;
public void escape(Writer writer, String str) throws IOException {&lt;br/&gt;
	int len = str.length();&lt;br/&gt;
	for (int i = 0; i &amp;lt; len; i++) {&lt;br/&gt;
		char c = str.charAt&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/information.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;;&lt;br/&gt;
		String entityName = this.entityName(c);&lt;br/&gt;
		if (entityName == null) {&lt;br/&gt;
			if ((c &amp;lt; 0x20 &amp;amp;&amp;amp; c != 9 &amp;amp;&amp;amp; c != 10 &amp;amp;&amp;amp; c != 13) || c &amp;gt;&amp;gt; 0x7F) &lt;/p&gt;
{
				writer.write(&quot;&amp;amp;#&quot;);
				writer.write(Integer.toString(c, 10));
				writer.write(&apos;;&apos;);
			}
&lt;p&gt;			else &lt;/p&gt;
{
				writer.write(c);
			}
&lt;p&gt;		}&lt;br/&gt;
		else &lt;/p&gt;
{
			writer.write(&apos;&amp;amp;&apos;);
			writer.write(entityName);
			writer.write(&apos;;&apos;);
		}
&lt;p&gt;	}&lt;br/&gt;
}&lt;/p&gt;

&lt;p&gt;//---------------------------------------------------------------------------------------&lt;br/&gt;
It can be tested with unittest:&lt;/p&gt;

&lt;p&gt;import java.io.Reader;&lt;br/&gt;
import java.io.StringReader;&lt;/p&gt;

&lt;p&gt;import junit.framework.TestCase;&lt;br/&gt;
import org.apache.commons.lang.StringEscapeUtils;&lt;br/&gt;
import org.jdom.input.SAXBuilder;&lt;/p&gt;

&lt;p&gt;public class StringEscapeUtilsTest extends TestCase {&lt;/p&gt;

&lt;p&gt;public void testPR73092() throws Exception {&lt;br/&gt;
	StringBuilder test = new StringBuilder(50);&lt;br/&gt;
	for (int i = 0; i &amp;lt;= 50; i++) &lt;/p&gt;
{
		test.append((char)i);
	}

&lt;p&gt;	StringBuilder result = new StringBuilder(&quot;&amp;lt;test&amp;gt;\n&amp;lt;![CDATA[\n&quot;);&lt;br/&gt;
	result.append(StringEscapeUtils.escapeHtml(test.toString()));&lt;br/&gt;
	result.append(&quot;\n]]&amp;gt;\n&amp;lt;/test&amp;gt;\n&quot;);&lt;/p&gt;

&lt;p&gt;	validate(new StringReader(result.toString()));&lt;/p&gt;

&lt;p&gt;	result = new StringBuilder(&quot;&amp;lt;test&amp;gt;\n&amp;lt;![CDATA[\n&quot;);&lt;br/&gt;
	result.append(test.toString());&lt;br/&gt;
	result.append(&quot;\n]]&amp;gt;\n&amp;lt;/test&amp;gt;\n&quot;);&lt;/p&gt;

&lt;p&gt;	try &lt;/p&gt;
{
		validate(new StringReader(result.toString()));
		fail(&quot;expected to blow up&quot;);
	}
&lt;p&gt;	catch (Exception e) &lt;/p&gt;
{
		//
	}
&lt;p&gt;}&lt;/p&gt;

&lt;p&gt;/** make sure that xml is well-formed */&lt;br/&gt;
private static void validate(Reader xmlSource) throws Exception &lt;/p&gt;
{
	SAXBuilder saxBuilder = new SAXBuilder();
	saxBuilder.build(xmlSource);
}

}</description>
                <environment>&lt;p&gt;java5&lt;/p&gt;</environment>
        <key id="12397175">LANG-439</key>
            <summary>StringEscapeUtils.escapeHTML() does not escape chars (0x00-0x20)</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="psivolob">Pavel Sivolobtchik</reporter>
                        <labels>
                    </labels>
                <created>Fri, 30 May 2008 14:16:19 +0000</created>
                <updated>Thu, 17 Dec 2009 03:41:00 +0000</updated>
                            <resolved>Sun, 19 Jul 2009 18:49:34 +0000</resolved>
                                    <version>2.4</version>
                                    <fixVersion>3.0</fixVersion>
                                    <component>lang.*</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12603482" author="bayard" created="Mon, 9 Jun 2008 06:51:58 +0000"  >&lt;p&gt;I thought we&apos;d hit this for escapeXml before and the spec said that such characters were not escaped.&lt;/p&gt;</comment>
                            <comment id="12603496" author="jochen@apache.org" created="Mon, 9 Jun 2008 07:55:35 +0000"  >&lt;p&gt;It is crystal clear, that escapeXml &lt;b&gt;must&lt;/b&gt; not escape such characters, but should throw an exception.&lt;/p&gt;

&lt;p&gt;I haven&apos;t got any idea for HTML documents. I&apos;d be in favour for the same handling as XML, though, for practical reasons. Whoever needs these binary characters should use BASE64 or something similar. At least I&apos;d wait for an explicit hint, that escaped 0x00 characters &lt;b&gt;are&lt;/b&gt; valid in HTML.&lt;/p&gt;

&lt;p&gt;However, I must admit, that I do not like the current implementation. Simply &lt;b&gt;ignoring&lt;/b&gt; such characters is, IMO, worse than trying to escape them. IMO, we should throw an exception, if we find characters that we suspect to be invalid.&lt;/p&gt;
</comment>
                            <comment id="12603569" author="psivolob" created="Mon, 9 Jun 2008 13:57:56 +0000"  >&lt;p&gt;actualy 9(tab),10(newline),13(c-return) are valid chars. But only these 3 are valid from the range from 0 to 0x20&lt;/p&gt;</comment>
                            <comment id="12733036" author="bayard" created="Sun, 19 Jul 2009 18:49:34 +0000"  >&lt;p&gt;Closing as &lt;a href=&quot;https://issues.apache.org/jira/browse/LANG-505&quot; title=&quot;Rewrite StringEscapeUtils&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LANG-505&quot;&gt;&lt;del&gt;LANG-505&lt;/del&gt;&lt;/a&gt; has given the user the ability to customize their escaping, and &lt;a href=&quot;https://issues.apache.org/jira/browse/LANG-515&quot; title=&quot;Define standard escape/unescape behaviours&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LANG-515&quot;&gt;&lt;del&gt;LANG-515&lt;/del&gt;&lt;/a&gt; drives deciding what our standard default pattern should be.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12425706">LANG-505</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12399345">LANG-448</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 9 Jun 2008 06:51:58 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>34093</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 20 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0d607:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>74749</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>