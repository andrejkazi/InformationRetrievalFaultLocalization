<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sat Nov 19 22:16:38 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/COLLECTIONS-360/COLLECTIONS-360.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[COLLECTIONS-360] FilterListIterator#hasNext throws exception (associate with JUnit tests)</title>
                <link>https://issues.apache.org/jira/browse/COLLECTIONS-360</link>
                <project id="12310465" key="COLLECTIONS">Commons Collections</project>
                    <description>&lt;p&gt;Hi,&lt;/p&gt;

&lt;p&gt;I found the some of the iterator classes does not fulfill the iterator specification of JDK.&lt;/p&gt;

&lt;p&gt;e.g. hasNext() should never throw exception.&lt;/p&gt;

&lt;p&gt;Here is an automatically generated junit test (I am now writing a tool)&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void test233() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; Throwable {
    java.lang.&lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt; var6 = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; java.lang.&lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;(0);
    org.apache.commons.collections.list.GrowthList var7 = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; org.apache.commons.collections.list.GrowthList(var6);
    org.apache.commons.collections.Predicate var9 = org.apache.commons.collections.PredicateUtils.anyPredicate((java.util.Collection)var7);
    java.lang.&lt;span class=&quot;code-object&quot;&gt;Long&lt;/span&gt; var10 = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; java.lang.&lt;span class=&quot;code-object&quot;&gt;Long&lt;/span&gt;(10L);
    org.apache.commons.collections.iterators.FilterListIterator var13 = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; org.apache.commons.collections.iterators.FilterListIterator(var9);
    &lt;span class=&quot;code-comment&quot;&gt;//&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; line &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; exception!
&lt;/span&gt;    var13.hasNext();
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;could you please check it to confirm whether it is bug or I misunderstand the specification of apache common collections?&lt;/p&gt;

&lt;p&gt;thanks,&lt;/p&gt;</description>
                <environment>&lt;p&gt;ubuntu&lt;/p&gt;</environment>
        <key id="12472288">COLLECTIONS-360</key>
            <summary>FilterListIterator#hasNext throws exception (associate with JUnit tests)</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jochen@apache.org">Jochen Wiedmann</assignee>
                                    <reporter username="saizhang">Sai Zhang</reporter>
                        <labels>
                    </labels>
                <created>Mon, 23 Aug 2010 19:29:56 +0000</created>
                <updated>Sun, 9 Nov 2014 14:31:45 +0000</updated>
                            <resolved>Tue, 1 Mar 2011 22:17:27 +0000</resolved>
                                    <version>3.2</version>
                                    <fixVersion>4.0-alpha1</fixVersion>
                    <fixVersion>4.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12970749" author="isaprykin" created="Mon, 13 Dec 2010 08:56:42 +0000"  >&lt;p&gt;As far as I understand expression &quot;&lt;tt&gt;FilterListIterator(var9)&lt;/tt&gt;&quot; resolves into &lt;tt&gt;FilterListIterator(Predicate&amp;lt;? super E&amp;gt; predicate)&lt;/tt&gt; constructor. Here&apos;s what it&apos;s javadoc is saying:&lt;/p&gt;
&lt;blockquote&gt;&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Constructs a new &amp;lt;code&amp;gt;FilterListIterator&amp;lt;/code&amp;gt; that will not function
until {@link #setListIterator(ListIterator) setListIterator} is invoked.

@param predicate  the predicate to use.&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;
&lt;p&gt;So if a &lt;tt&gt;ListIterator&lt;/tt&gt; isn&apos;t specified than &lt;a href=&quot;http://download.oracle.com/javase/6/docs/api/java/lang/NullPointerException.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;NullPointerException&lt;/a&gt;(your case) is thrown.&lt;br/&gt;
I think, you&apos;re partialy right - &lt;tt&gt;FilterListIterator&lt;/tt&gt; implements &lt;tt&gt;Iterator&lt;/tt&gt; interface and &lt;a href=&quot;http://download.oracle.com/javase/6/docs/api/java/util/Iterator.html#hasNext()&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;Iterator.hasNext()&lt;/a&gt; doesn&apos;t specify any exceptions to be thrown.&lt;/p&gt;

&lt;p&gt;If it&apos;s really an issue maybe these two constructors  - &lt;tt&gt;FilterListIterator(Predicate&amp;lt;? super E&amp;gt; predicate)&lt;/tt&gt; and &lt;tt&gt;FilterListIterator(ListIterator&amp;lt;? extends E&amp;gt; iterator )&lt;/tt&gt; should be deprecated?&lt;/p&gt;</comment>
                            <comment id="12975276" author="miccagiann" created="Mon, 27 Dec 2010 16:09:27 +0000"  >&lt;p&gt;I can confirm that the line &quot;var13.hasNext();&quot; from the above unitTest throws a NullPointerException and that&apos;s because iterator has the value NULL. So in order to fix this bug wouldn&apos;t it be a good idea before we checked the private variable iterator if is null in the functions of FilterListIterator where it is called? &lt;/p&gt;</comment>
                            <comment id="12975754" author="miccagiann" created="Wed, 29 Dec 2010 10:26:37 +0000"  >&lt;p&gt;Functions that have been modified: setNextObject(), setPreviousObject().&lt;/p&gt;</comment>
                            <comment id="12975986" author="miccagiann" created="Thu, 30 Dec 2010 08:46:01 +0000"  >&lt;p&gt;I would like to ask if anyone who has worked with this issue has any unit Tests so as to be sure that this implementation work 100%... Thanks!&lt;/p&gt;</comment>
                            <comment id="13001149" author="jochen@apache.org" created="Tue, 1 Mar 2011 22:17:27 +0000"  >&lt;p&gt;Diagnosis: Agreed that the contract of hasNext() forbids throwing an NPE and this is a bug.&lt;br/&gt;
Also agreeing with Igor that the constructors allowing such behaviour are essentially broken. Nevertheless we have them and so we must support them for binary compatibility.&lt;br/&gt;
Hence eliminating the NPE for the FilterListIterator.&lt;/p&gt;

&lt;p&gt;Zhang writes that &quot;some of the iterator classes&quot; have this problem. OTOH, this is nowhere made clear. Feel free to reopen, should you find any more classes in question.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12467106" name="FilterListIterator.java" size="8806" author="miccagiann" created="Wed, 29 Dec 2010 10:26:37 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 13 Dec 2010 08:56:42 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>18643</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 38 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0shyn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>164387</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>