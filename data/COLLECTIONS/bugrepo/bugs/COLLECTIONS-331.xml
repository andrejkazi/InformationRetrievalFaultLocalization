<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sat Nov 19 23:19:49 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/COLLECTIONS-331/COLLECTIONS-331.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[COLLECTIONS-331] CollatingIterator NPE when Comparator is null</title>
                <link>https://issues.apache.org/jira/browse/COLLECTIONS-331</link>
                <project id="12310465" key="COLLECTIONS">Commons Collections</project>
                    <description>&lt;p&gt;Run the attached Test against commons-collections-3.2.1. While the JavaDoc for CollatingIterator claims &lt;/p&gt;

&lt;p&gt;&lt;tt&gt;@param comp  the comparator to use to sort, or null to use natural sort order&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;the test fails, because the comparator is null.&lt;/p&gt;

&lt;p&gt;Fixing this requires a change in &lt;tt&gt;org.apache.commons.collections.iterators.CollatingIterator.least()&lt;/tt&gt;: &lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (comparator.compare(curObject,leastObject) &amp;lt; 0) { ...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;could be replaced with&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; c = comparator==&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;?((Comparable)curObject).compareTo(leastObject):comparator.compare(curObject,leastObject);
&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (c &amp;lt; 0) { ...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;


&lt;p&gt;The workaround is to provide a comparator, of course.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12428785">COLLECTIONS-331</key>
            <summary>CollatingIterator NPE when Comparator is null</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jochen@apache.org">Jochen Wiedmann</assignee>
                                    <reporter username="krkoska">Michael Krkoska</reporter>
                        <labels>
                    </labels>
                <created>Wed, 24 Jun 2009 14:32:05 +0000</created>
                <updated>Sun, 9 Nov 2014 14:31:31 +0000</updated>
                            <resolved>Tue, 8 Mar 2011 22:33:02 +0000</resolved>
                                    <version>3.2</version>
                                    <fixVersion>4.0-alpha1</fixVersion>
                    <fixVersion>4.0</fixVersion>
                                    <component>Iterator</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                    <timeoriginalestimate seconds="300">5m</timeoriginalestimate>
                            <timeestimate seconds="300">5m</timeestimate>
                                        <comments>
                            <comment id="12723579" author="krkoska" created="Wed, 24 Jun 2009 14:33:41 +0000"  >&lt;p&gt;JUnit4 Testcase showing bug&lt;/p&gt;</comment>
                            <comment id="12723952" author="krkoska" created="Thu, 25 Jun 2009 08:44:04 +0000"  >&lt;p&gt;This patch fixes the bug by using ComparableComparator if the comparator is null. &lt;br/&gt;
Testcase is adapted as well.&lt;/p&gt;</comment>
                            <comment id="12850022" author="bayard" created="Fri, 26 Mar 2010 06:35:52 +0000"  >&lt;p&gt;Confirm on the bug. &lt;/p&gt;

&lt;p&gt;Issue is that ComparableComparator can&apos;t be used if the objects aren&apos;t Comparable.&lt;/p&gt;

&lt;p&gt;Now that things are generified this won&apos;t even compile. Specifically this is that CollatingIterator&amp;lt;E&amp;gt; and ComparableComparator&amp;lt;E extends Comparable&amp;lt;? super E&amp;gt;&amp;gt; don&apos;t match.&lt;/p&gt;

&lt;p&gt;One option would be to throw exception if not comparable, but use comparable comparator if E is comparable.&lt;/p&gt;</comment>
                            <comment id="13004265" author="jochen@apache.org" created="Tue, 8 Mar 2011 22:33:02 +0000"  >&lt;p&gt;Agree with Hen&apos;s assessment that the use of Comparable.compareTo might likely cause a bunch of other problems.&lt;/p&gt;

&lt;p&gt;I have verified, that this bug exists in every revision since CollatingIterator was verified. In other words, we don&apos;t need to care for upwards compatibility, there can&apos;t be any code floating around that depends on the use of &quot;natural sort order&quot;.&lt;/p&gt;

&lt;p&gt;Consequently I decided to&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;throw an NPE in least() with a message describing the problem, if no Comparator is present. (This meets the current behaviour, so it is upwards compatible.)&lt;/li&gt;
	&lt;li&gt;change the documentation of the default constructor to require a call to setComparator&lt;/li&gt;
	&lt;li&gt;remove all references to &quot;natural sort order&quot; and replace them with the recommendation to use ComparableComparator, if required&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13423542" author="hudson" created="Thu, 26 Jul 2012 23:07:49 +0000"  >&lt;p&gt;Integrated in commons-collections #69 (See &lt;a href=&quot;https://builds.apache.org/job/commons-collections/69/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/commons-collections/69/&lt;/a&gt;)&lt;br/&gt;
    Add change for 3.2.2 also for 4.0 release, fix javadoc for &lt;a href=&quot;https://issues.apache.org/jira/browse/COLLECTIONS-331&quot; title=&quot;CollatingIterator NPE when Comparator is null&quot; class=&quot;issue-link&quot; data-issue-key=&quot;COLLECTIONS-331&quot;&gt;&lt;del&gt;COLLECTIONS-331&lt;/del&gt;&lt;/a&gt;. (Revision 1366195)&lt;/p&gt;

&lt;p&gt;     Result = SUCCESS&lt;br/&gt;
tn : &lt;a href=&quot;http://svn.apache.org/viewvc/?view=rev&amp;amp;rev=1366195&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewvc/?view=rev&amp;amp;rev=1366195&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/commons/proper/collections/trunk/src/changes/changes.xml&lt;/li&gt;
	&lt;li&gt;/commons/proper/collections/trunk/src/main/java/org/apache/commons/collections/iterators/CollatingIterator.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12411771" name="COLLECTIONS-331.patch" size="2859" author="krkoska" created="Thu, 25 Jun 2009 08:44:04 +0000"/>
                            <attachment id="12411653" name="CollatingIteratorTest.java" size="751" author="krkoska" created="Wed, 24 Jun 2009 14:33:41 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 26 Mar 2010 06:35:52 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>18672</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 17 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0si3r:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>164410</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>