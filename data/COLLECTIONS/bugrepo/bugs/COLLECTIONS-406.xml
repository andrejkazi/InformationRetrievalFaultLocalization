<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sat Nov 19 22:25:07 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/COLLECTIONS-406/COLLECTIONS-406.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[COLLECTIONS-406] ListUtils.subtract is very slow </title>
                <link>https://issues.apache.org/jira/browse/COLLECTIONS-406</link>
                <project id="12310465" key="COLLECTIONS">Commons Collections</project>
                    <description>&lt;p&gt;Hi,&lt;/p&gt;

&lt;p&gt;ListUtils.subtract is very slow when subtracting two large lists.  The&lt;br/&gt;
root cause of this problem is similar to the root cause of the&lt;br/&gt;
previously fixed &lt;a href=&quot;https://issues.apache.org/jira/browse/COLLECTIONS-328&quot; title=&quot;ListUtils.intersect is slow&quot; class=&quot;issue-link&quot; data-issue-key=&quot;COLLECTIONS-328&quot;&gt;&lt;del&gt;COLLECTIONS-328&lt;/del&gt;&lt;/a&gt; in ListUtils, i.e., quadratic&lt;br/&gt;
complexity instead of linear complexity.&lt;/p&gt;

&lt;p&gt;I am encountering this problem in version 3.2.1 and also in revision&lt;br/&gt;
1342815 (May 25th 2012).  I have attached a test that exposes this&lt;br/&gt;
problem and a simple patch.  On my machine, for the attached test,&lt;br/&gt;
this patch provides a 95X speedup.&lt;/p&gt;

&lt;p&gt;To run the test, just do:&lt;/p&gt;

&lt;p&gt;$ java Test&lt;/p&gt;

&lt;p&gt;Currently, the code for ListUtils.subtract is:&lt;/p&gt;

&lt;p&gt;final ArrayList&amp;lt;E&amp;gt; result = new ArrayList&amp;lt;E&amp;gt;(list1);&lt;br/&gt;
for (E e : list2) &lt;/p&gt;
{
    result.remove(e);
}
&lt;p&gt;return result;&lt;/p&gt;

&lt;p&gt;which is quadratic, because result.remove(e) has linear complexity.&lt;/p&gt;

&lt;p&gt;The attached patch makes the remove() be constant complexity by&lt;br/&gt;
removing from an org.apache.commons.collections.bag.HashBag.  I use&lt;br/&gt;
HashBag and not HashSet because ListUtils.subtract needs to respect&lt;br/&gt;
the cardinality when there are repeated objects in the list.&lt;/p&gt;

&lt;p&gt;As mentioned in &lt;a href=&quot;https://issues.apache.org/jira/browse/COLLECTIONS-328&quot; title=&quot;ListUtils.intersect is slow&quot; class=&quot;issue-link&quot; data-issue-key=&quot;COLLECTIONS-328&quot;&gt;&lt;del&gt;COLLECTIONS-328&lt;/del&gt;&lt;/a&gt; discussion, for small lists, there is&lt;br/&gt;
some overhead for creating the HashBag.  This can be fixed with a&lt;br/&gt;
threshold, but I did not implement it in my patch because the&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/COLLECTIONS-328&quot; title=&quot;ListUtils.intersect is slow&quot; class=&quot;issue-link&quot; data-issue-key=&quot;COLLECTIONS-328&quot;&gt;&lt;del&gt;COLLECTIONS-328&lt;/del&gt;&lt;/a&gt; patch does not implement it.&lt;/p&gt;

&lt;p&gt;Unlike the patch for &lt;a href=&quot;https://issues.apache.org/jira/browse/COLLECTIONS-328&quot; title=&quot;ListUtils.intersect is slow&quot; class=&quot;issue-link&quot; data-issue-key=&quot;COLLECTIONS-328&quot;&gt;&lt;del&gt;COLLECTIONS-328&lt;/del&gt;&lt;/a&gt;, my patch does not choose the&lt;br/&gt;
list to iterate over based on size, because of the cardinality&lt;br/&gt;
requirement in subtract.  This means the code could be made even&lt;br/&gt;
faster if we could use something like a LinkedHashBag but neither&lt;br/&gt;
Apache Collections nor standard Java libraries have such a class.&lt;br/&gt;
Even so, this patch is still a lot faster than the original version.&lt;/p&gt;

&lt;p&gt;Is this truly a bug, or am I missing something here?  If so, can you&lt;br/&gt;
please confirm if the patch is correct?&lt;/p&gt;

&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Adrian&lt;/p&gt;

</description>
                <environment>&lt;p&gt;java 1.6.0_24&lt;br/&gt;
Ubuntu 11.10&lt;/p&gt;</environment>
        <key id="12558285">COLLECTIONS-406</key>
            <summary>ListUtils.subtract is very slow </summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="adriannistor">Adrian Nistor</reporter>
                        <labels>
                    </labels>
                <created>Sun, 27 May 2012 19:52:30 +0000</created>
                <updated>Sun, 9 Nov 2014 14:31:41 +0000</updated>
                            <resolved>Sun, 3 Jun 2012 10:25:40 +0000</resolved>
                                    <version>3.2.1</version>
                                    <fixVersion>4.0-alpha1</fixVersion>
                    <fixVersion>4.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                <comments>
                            <comment id="13288136" author="tn" created="Sun, 3 Jun 2012 10:25:40 +0000"  >&lt;p&gt;Thanks for reporting this issue and providing a patch.&lt;/p&gt;

&lt;p&gt;The patch has been applied in r1345644 together with unit tests for the subtract method (was missing before).&lt;/p&gt;</comment>
                            <comment id="13288138" author="hudson" created="Sun, 3 Jun 2012 10:35:11 +0000"  >&lt;p&gt;Integrated in commons-collections #20 (See &lt;a href=&quot;https://builds.apache.org/job/commons-collections/20/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/commons-collections/20/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/COLLECTIONS-406&quot; title=&quot;ListUtils.subtract is very slow &quot; class=&quot;issue-link&quot; data-issue-key=&quot;COLLECTIONS-406&quot;&gt;&lt;del&gt;COLLECTIONS-406&lt;/del&gt;&lt;/a&gt; Improved ListUtils.subtract to O&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/thumbs_down.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; performance. Thanks to Adrian Nistor for reporting and providing a patch. (Revision 1345644)&lt;/p&gt;

&lt;p&gt;     Result = SUCCESS&lt;br/&gt;
tn : &lt;a href=&quot;http://svn.apache.org/viewvc/?view=rev&amp;amp;rev=1345644&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewvc/?view=rev&amp;amp;rev=1345644&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/commons/proper/collections/trunk/src/main/java/org/apache/commons/collections/ListUtils.java&lt;/li&gt;
	&lt;li&gt;/commons/proper/collections/trunk/src/test/java/org/apache/commons/collections/TestListUtils.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12529905" name="Test.java" size="716" author="adriannistor" created="Sun, 27 May 2012 19:53:31 +0000"/>
                            <attachment id="12529904" name="patch.diff" size="1162" author="adriannistor" created="Sun, 27 May 2012 19:53:31 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Sun, 3 Jun 2012 10:25:40 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>292952</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 24 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0shrb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>164354</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>