<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun Nov 20 02:13:58 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/COLLECTIONS-80/COLLECTIONS-80.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[COLLECTIONS-80] [Patch] [Collections] ExtendedProperties.interpolate does not do recursive substitution</title>
                <link>https://issues.apache.org/jira/browse/COLLECTIONS-80</link>
                <project id="12310465" key="COLLECTIONS">Commons Collections</project>
                    <description>&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;Patch&amp;#93;&lt;/span&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;Collections&amp;#93;&lt;/span&gt; ExtendedProperties.interpolate does not do recursive&lt;br/&gt;
substitution in commons-collections-2.1, but it probably should, when used with&lt;br/&gt;
getString(...).&lt;/p&gt;

&lt;p&gt;Example:&lt;/p&gt;

&lt;p&gt;firefish.home=/tmp/firefish&lt;br/&gt;
database.dir=$&lt;/p&gt;
{firefish.home}
&lt;p&gt;/samples/cfengine&lt;br/&gt;
database.file=$&lt;/p&gt;
{database.dir}
&lt;p&gt;/db.xml&lt;/p&gt;

&lt;p&gt;extendedProps.getString(&quot;database.file&quot;)&lt;/p&gt;

&lt;p&gt;I found out that this can be fixed with the patch below, which is simply a copy&lt;br/&gt;
and paste from the CVS of org.apache.commons.configuration.AbstractConfiguration.&lt;/p&gt;

&lt;p&gt;	/**&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;interpolate key names to handle $
{key} stuff&lt;br/&gt;
	 *&lt;br/&gt;
	 * @param base string to interpolate&lt;br/&gt;
	 *&lt;br/&gt;
	 * @return returns the key name with the ${key}
&lt;p&gt; substituted&lt;br/&gt;
	 */&lt;br/&gt;
	protected String interpolate(String base)&lt;br/&gt;
	// copied from org.apache.commons.configuration.AbstractConfiguration&lt;/p&gt;
	{
		return (interpolateHelper(base, null));
	}&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;	/**&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Recursive handler for multple levels of interpolation.&lt;br/&gt;
	 *&lt;/li&gt;
	&lt;li&gt;When called the first time, priorVariables should be null.&lt;br/&gt;
	 *&lt;/li&gt;
	&lt;li&gt;@param base string with the $
{key}
&lt;p&gt; variables&lt;/p&gt;&lt;/li&gt;
	&lt;li&gt;@param priorVariables serves two purposes: to allow checking for&lt;/li&gt;
	&lt;li&gt;loops, and creating a meaningful exception message should a loop&lt;/li&gt;
	&lt;li&gt;occur.  It&apos;s 0&apos;th element will be set to the value of base from&lt;/li&gt;
	&lt;li&gt;the first call.  All subsequent interpolated variables are added&lt;/li&gt;
	&lt;li&gt;afterward.&lt;br/&gt;
	 *&lt;/li&gt;
	&lt;li&gt;@return the string with the interpolation taken care of&lt;br/&gt;
	 */&lt;br/&gt;
	protected String interpolateHelper(String base, List priorVariables)&lt;br/&gt;
	// copied from org.apache.commons.configuration.AbstractConfiguration&lt;br/&gt;
	{&lt;br/&gt;
		if (base == null)
		{
			return null;
		}&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;		// on the first call initialize priorVariables&lt;br/&gt;
		// and add base as the first element&lt;br/&gt;
		if (priorVariables == null)&lt;/p&gt;
		{
			priorVariables = new ArrayList();
			priorVariables.add(base);
		}

&lt;p&gt;		int begin = -1;&lt;br/&gt;
		int end = -1;&lt;br/&gt;
		int prec = 0 - END_TOKEN.length();&lt;br/&gt;
		String variable = null;&lt;br/&gt;
		StringBuffer result = new StringBuffer();&lt;/p&gt;

&lt;p&gt;		// FIXME: we should probably allow the escaping of the start token&lt;br/&gt;
		while (((begin = base.indexOf(START_TOKEN, prec + END_TOKEN.length()))&lt;br/&gt;
			&amp;gt; -1)&lt;br/&gt;
			&amp;amp;&amp;amp; ((end = base.indexOf(END_TOKEN, begin)) &amp;gt; -1))&lt;br/&gt;
		{&lt;br/&gt;
			result.append(base.substring(prec + END_TOKEN.length(), begin));&lt;br/&gt;
			variable = base.substring(begin + START_TOKEN.length(), end);&lt;/p&gt;

&lt;p&gt;			// if we&apos;ve got a loop, create a useful exception message and throw&lt;br/&gt;
			if (priorVariables.contains(variable))&lt;br/&gt;
			{&lt;br/&gt;
				String initialBase = priorVariables.remove(0).toString();&lt;br/&gt;
				priorVariables.add(variable);&lt;br/&gt;
				StringBuffer priorVariableSb = new StringBuffer();&lt;/p&gt;

&lt;p&gt;				// create a nice trace of interpolated variables like so:&lt;br/&gt;
				// var1-&amp;gt;var2-&amp;gt;var3&lt;br/&gt;
				for (Iterator it = priorVariables.iterator(); it.hasNext()&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;br/&gt;
				{&lt;br/&gt;
					priorVariableSb.append(it.next());&lt;br/&gt;
					if (it.hasNext())&lt;/p&gt;
					{
						priorVariableSb.append(&quot;-&amp;gt;&quot;);
					}
&lt;p&gt;				}&lt;/p&gt;

&lt;p&gt;				throw new IllegalStateException(&lt;br/&gt;
					&quot;infinite loop in property interpolation of &quot;&lt;br/&gt;
						+ initialBase&lt;br/&gt;
						+ &quot;: &quot;&lt;br/&gt;
						+ priorVariableSb.toString());&lt;br/&gt;
			}&lt;br/&gt;
			// otherwise, add this variable to the interpolation list.&lt;br/&gt;
			else&lt;/p&gt;
			{
				priorVariables.add(variable);
			}

&lt;p&gt;			//QUESTION: getProperty or getPropertyDirect&lt;br/&gt;
			Object value = getProperty(variable);&lt;br/&gt;
			if (value != null)&lt;br/&gt;
			{&lt;br/&gt;
				result.append(interpolateHelper(value.toString(),&lt;br/&gt;
					priorVariables));&lt;/p&gt;

&lt;p&gt;				// pop the interpolated variable off the stack&lt;br/&gt;
				// this maintains priorVariables correctness for&lt;br/&gt;
				// properties with multiple interpolations, e.g.&lt;br/&gt;
				// prop.name=$&lt;/p&gt;
{some.other.prop1}
&lt;p&gt;/blahblah/$&lt;/p&gt;
{some.other.prop2}
&lt;p&gt;				priorVariables.remove(priorVariables.size() - 1);&lt;br/&gt;
			}&lt;br/&gt;
			else if (defaults != null &amp;amp;&amp;amp; defaults.getString(variable,&lt;br/&gt;
				null) != null)&lt;/p&gt;
			{
				result.append(defaults.getString(variable));
			}
&lt;p&gt;			else&lt;/p&gt;
			{
				//variable not defined - so put it back in the value
				result.append(START_TOKEN).append(variable).append(END_TOKEN);
			}
&lt;p&gt;			prec = end;&lt;br/&gt;
		}&lt;br/&gt;
		result.append(base.substring(prec + END_TOKEN.length(), base.length()));&lt;/p&gt;

&lt;p&gt;		return result.toString();&lt;br/&gt;
	}&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: other&lt;br/&gt;
Platform: Other&lt;/p&gt;</environment>
        <key id="12341157">COLLECTIONS-80</key>
            <summary>[Patch] [Collections] ExtendedProperties.interpolate does not do recursive substitution</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="whoschek@lbl.gov">hoschek</reporter>
                        <labels>
                    </labels>
                <created>Tue, 16 Dec 2003 12:15:45 +0000</created>
                <updated>Sat, 15 Mar 2008 21:36:00 +0000</updated>
                            <resolved>Sat, 15 Mar 2008 21:36:00 +0000</resolved>
                                    <version>2.1</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12405659" author="scolebourne@joda.org" created="Tue, 30 Dec 2003 02:19:15 +0000"  >&lt;p&gt;Change made, thanks.&lt;/p&gt;

&lt;p&gt;Hopefully &lt;span class=&quot;error&quot;&gt;&amp;#91;configuration&amp;#93;&lt;/span&gt; will replace this class soon.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>25553</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 30 Dec 2003 02:19:15 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>18918</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 48 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0sjg7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>164628</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>