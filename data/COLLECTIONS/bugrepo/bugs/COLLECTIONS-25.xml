<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun Nov 20 00:44:40 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/COLLECTIONS-25/COLLECTIONS-25.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[COLLECTIONS-25] [collections][PATCH] OutOfMemoryError test case for MapUtils.verbosePrint.</title>
                <link>https://issues.apache.org/jira/browse/COLLECTIONS-25</link>
                <project id="12310465" key="COLLECTIONS">Commons Collections</project>
                    <description>&lt;p&gt;The attached patch adds a test case to TestMapUtils that demonstrates infinite&lt;br/&gt;
recursion in MapUtils.verbosePrint.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: other&lt;br/&gt;
Platform: Other&lt;/p&gt;</environment>
        <key id="12340954">COLLECTIONS-25</key>
            <summary>[collections][PATCH] OutOfMemoryError test case for MapUtils.verbosePrint.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="janekdb@yahoo.co.uk">Janek Bogucki</reporter>
                        <labels>
                    </labels>
                <created>Wed, 10 Sep 2003 04:02:35 +0000</created>
                <updated>Sat, 15 Mar 2008 21:35:57 +0000</updated>
                            <resolved>Sat, 15 Mar 2008 21:35:57 +0000</resolved>
                                    <version>Nightly Builds</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12405025" author="janekdb@yahoo.co.uk" created="Wed, 10 Sep 2003 04:03:40 +0000"  >&lt;p&gt;Created an attachment (id=8120)&lt;br/&gt;
demonstrates infinite&lt;br/&gt;
patch demonstrating recursion in MapUtils.verbosePrint&lt;/p&gt;</comment>
                            <comment id="12405026" author="scolebourne@joda.org" created="Wed, 10 Sep 2003 05:02:49 +0000"  >&lt;p&gt;All we need now is the fix for the newly demonstrated bug....&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="12405027" author="phil@steitz.com" created="Wed, 10 Sep 2003 11:47:28 +0000"  >&lt;p&gt;Is this really a bug??&lt;/p&gt;

&lt;p&gt;As a user, I would personally not complain about a documented limitation/warning&lt;br/&gt;
that this method should not be used for maps that may contain cyclic object&lt;br/&gt;
graphs.  I agree that infinite recursions are evil, but if you want to ask for&lt;br/&gt;
recursive traversals... As the javadoc states, &quot;When the value is a Map,&lt;br/&gt;
recursive behaviour occurs.&quot;&lt;/p&gt;

&lt;p&gt;Otherwise what are the choices?&lt;/p&gt;

&lt;p&gt;1. limit the depth of the recursion&lt;/p&gt;

&lt;p&gt;2. hold an array of visited nodes and check each new node against the visited&lt;br/&gt;
list to prevent cycles&lt;/p&gt;

&lt;p&gt;3. put some other absolute limit on the number of nodes visited&lt;/p&gt;

&lt;p&gt;Options 1 and 3 are ugly.  I suppose that I could live with 2., but do we really&lt;br/&gt;
need to do this?&lt;/p&gt;

&lt;p&gt;I suppose we could also consider dumping the recursive contract &amp;#8211; i.e., just&lt;br/&gt;
iterate and print the map entries, eliminating the quoted line above from the&lt;br/&gt;
javadoc.&lt;/p&gt;</comment>
                            <comment id="12405028" author="amamment" created="Wed, 10 Sep 2003 23:56:02 +0000"  >&lt;p&gt;As the result of a previous submission of patches (&lt;a href=&quot;https://issues.apache.org/jira/browse/COLLECTIONS-82&quot; title=&quot;[collections] Map.debugPrint improvements&quot; class=&quot;issue-link&quot; data-issue-key=&quot;COLLECTIONS-82&quot;&gt;&lt;del&gt;COM-635&lt;/del&gt;&lt;/a&gt;) I already had &lt;br/&gt;
planned some work to prevent this kind of recursion.  I attach a patch which &lt;br/&gt;
actually does multiple things....&lt;/p&gt;

&lt;p&gt;1) Modifies test cases to make duplicate any tests available for debugPrint &lt;br/&gt;
apply to verbosePrint and vice-versa (there were a few tests present for one &lt;br/&gt;
and not the other, and it seemed easy to do).  &lt;/p&gt;

&lt;p&gt;2) Updates verbosePrintInternal to also pass an internal stack of previously &lt;br/&gt;
visited maps.  If a previously visited map is seen again, the text &quot;(ancestor&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;i&amp;#93;&lt;/span&gt; Map) is printed out as the value of the Map, where i refers to level of &lt;br/&gt;
ancestor - the parent of the current Map is 0, the parent&apos;s parent 1, and so &lt;br/&gt;
on.... &lt;/p&gt;

&lt;p&gt;3) Modified the test in the previously attached patch (&amp;lt;a &lt;br/&gt;
href=&quot;showattachment.cgi?attach_id=8120&quot;&amp;gt;attachment=8120&amp;lt;/a&amp;gt;); effectively &lt;br/&gt;
replacing it with an alternate version that tests for the behaviour mentioned &lt;br/&gt;
in #2 above.  If the test is executed on unmodified code, an OutOfMemory error &lt;br/&gt;
should be generated as previously.  Also added an equivalent test for &lt;br/&gt;
verbosePrint.  &lt;/p&gt;

&lt;p&gt;Area of Concern 1 - the mechanism used for preventing infinitely recursive &lt;br/&gt;
printing makes sense to me.  However, the exact notation for the text to print &lt;br/&gt;
out when an ancestor map is included within the current map was something that &lt;br/&gt;
I made up.  Anyone have better suggestions?  I just tried to go with something &lt;br/&gt;
like the &quot;(this Map)&quot; text used for identifying the current map when one is &lt;br/&gt;
included within itself.&lt;/p&gt;

&lt;p&gt;Area of Concern 2 - The code recursively passes a stack of previously &lt;br/&gt;
navigated maps along with the recursive call to print child maps.  Each &lt;br/&gt;
element of the child&apos;s values is checked for existence in the stack in order &lt;br/&gt;
to determine if the notation listed above should be used.  However, the check &lt;br/&gt;
is done with Stack.contains().  Is this guaranteed to work?  I &lt;br/&gt;
assume .contains calls .equals on members of the stack to determine if any &lt;br/&gt;
specific element is already present.  I&apos;m not sure what the guarantees are &lt;br/&gt;
when you call .equals on a self-referencing Map.  It worked for the testcase &lt;br/&gt;
with a TreeMap on the IBM JDK 1.3, but will it work in general?    &lt;/p&gt;</comment>
                            <comment id="12405029" author="amamment" created="Wed, 10 Sep 2003 23:57:50 +0000"  >&lt;p&gt;Created an attachment (id=8130)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;Patch&amp;#93;&lt;/span&gt; Updates to verbosePrintInternal to handle recursion - deprecates previous patch&lt;/p&gt;</comment>
                            <comment id="12405030" author="scolebourne@joda.org" created="Thu, 18 Sep 2003 03:19:14 +0000"  >&lt;p&gt;Patch applied, however Stack uses .equals() as you mentioned, and we should be &lt;br/&gt;
using == really. But its an unusual case, so I&apos;m not that bothered.&lt;/p&gt;

&lt;p&gt;Thanks&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12332514" name="ASF.LICENSE.NOT.GRANTED--TestMapUtils-verbosePrint-recursion.patch" size="1287" author="janekdb@yahoo.co.uk" created="Wed, 10 Sep 2003 04:03:40 +0000"/>
                            <attachment id="12332515" name="ASF.LICENSE.NOT.GRANTED--patch.txt" size="13818" author="amamment" created="Wed, 10 Sep 2003 23:57:50 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>23041</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 10 Sep 2003 05:02:49 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>18973</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            13 years, 11 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0sjsf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>164683</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>