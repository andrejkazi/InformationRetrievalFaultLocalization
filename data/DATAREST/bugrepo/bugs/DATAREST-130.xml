<!-- 
RSS generated by JIRA (6.4.11#64026-sha1:78f6ec473a3f058bd5d6c30e9319c7ab376bdb9c) at Thu Dec 22 16:58:17 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://jira.spring.io/si/jira.issueviews:issue-xml/DATAREST-130/DATAREST-130.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>Spring JIRA</title>
    <link>https://jira.spring.io</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.4.11</version>
        <build-number>64026</build-number>
        <build-date>25-08-2015</build-date>
    </build-info>

<item>
            <title>[DATAREST-130] Updating value to NULL using Spring Data REST and PUT Method</title>
                <link>https://jira.spring.io/browse/DATAREST-130</link>
                <project id="10901" key="DATAREST">Spring Data REST</project>
                    <description>&lt;p&gt;Github Author: probsts&lt;br/&gt;
Github Last-Updated: 2013-06-07T13:10:40Z&lt;br/&gt;
This issue was automatically imported from github&lt;/p&gt;

&lt;p&gt;We are using a Spring Data REST CRUD repository (1.0.0.RELEASE).  On a PUT, it seems there is no way to set a property to null.  If you send a null property (see JSON below), it is ignored.&lt;/p&gt;

&lt;p&gt;{&lt;br/&gt;
&quot;address1&quot;: null&lt;br/&gt;
}&lt;/p&gt;

&lt;p&gt;I&apos;ve tracked the code down to the following lines in spring-data-rest-webmvc RepositoryRestController.java.  This code does not differentiate whether the client has explicitly sent a property with a null value (in which case, you want to set the property to null) as opposed to the client not sending the property at all (in which case, it should be ignored).&lt;/p&gt;

&lt;p&gt;if(null != (incomingVal = attrMeta.get(incoming))) {&lt;br/&gt;
  attrMeta.set(incomingVal, entity);&lt;br/&gt;
}&lt;/p&gt;

&lt;p&gt;How would someone update a property to null?  It seems like this is a real need.&lt;/p&gt;</description>
                <environment></environment>
        <key id="50559">DATAREST-130</key>
            <summary>Updating value to NULL using Spring Data REST and PUT Method</summary>
                <type id="1" iconUrl="https://jira.spring.io/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="4" iconUrl="https://jira.spring.io/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://jira.spring.io/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="8">Complete</resolution>
                                        <assignee username="gregturn">Greg Turnquist</assignee>
                                    <reporter username="thomasd">Thomas Darimont</reporter>
                        <labels>
                    </labels>
                <created>Tue, 27 Aug 2013 01:33:01 +0000</created>
                <updated>Thu, 6 Mar 2014 13:53:09 +0000</updated>
                            <resolved>Mon, 13 Jan 2014 09:51:30 +0000</resolved>
                                                    <fixVersion>2.0 RC1 (Codd)</fixVersion>
                                        <due></due>
                            <votes>1</votes>
                                    <watches>4</watches>
                                                                <comments>
                            <comment id="93630" author="ww4" created="Tue, 17 Sep 2013 00:14:32 +0000"  >&lt;p&gt;Seeing the same behavior with 1.0.0.RELEASE, 1.1.0.M1, and the current 2.0.0.BUILD-SNAPSHOT.&lt;/p&gt;

&lt;p&gt;Agree with Thomas that this is a real need. Are we doing it incorrectly? &lt;img class=&quot;emoticon&quot; src=&quot;https://jira.spring.io/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="93874" author="ww4" created="Wed, 25 Sep 2013 01:42:37 +0000"  >&lt;p&gt;OK, did some digging into 2.0.0.BUILD-SNAPSHOT, based on Thomas&apos; report above.&lt;/p&gt;

&lt;p&gt;In 2.0.0.BUILD-SNAPSHOT, the relevant class is org.springframework.data.rest.core.support.DomainObjectMerger. There&apos;s a merge method that has the following code (similar to what Thomas found):&lt;/p&gt;

&lt;p/&gt;
&lt;div id=&quot;syntaxplugin&quot; class=&quot;syntaxplugin&quot; style=&quot;border: 1px dashed #bbb; border-radius: 5px !important; overflow: auto; max-height: 30em;&quot;&gt;
&lt;table cellspacing=&quot;0&quot; cellpadding=&quot;0&quot; border=&quot;0&quot; width=&quot;100%&quot; style=&quot;font-size: 1em; line-height: 1.4em !important; font-weight: normal; font-style: normal; color: black;&quot;&gt;
		&lt;tbody &gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;  margin-top: 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;if (null != fromVal &amp;amp;&amp;amp; !fromVal.equals(targetWrapper.getProperty(persistentProperty))) {&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;    targetWrapper.setProperty(persistentProperty, fromVal);&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   margin-bottom: 10px;  width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;}&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
			&lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;p/&gt;

&lt;p&gt;I was able to PUT null values into properties by replacing the above with this:&lt;/p&gt;

&lt;p/&gt;
&lt;div id=&quot;syntaxplugin&quot; class=&quot;syntaxplugin&quot; style=&quot;border: 1px dashed #bbb; border-radius: 5px !important; overflow: auto; max-height: 30em;&quot;&gt;
&lt;table cellspacing=&quot;0&quot; cellpadding=&quot;0&quot; border=&quot;0&quot; width=&quot;100%&quot; style=&quot;font-size: 1em; line-height: 1.4em !important; font-weight: normal; font-style: normal; color: black;&quot;&gt;
		&lt;tbody &gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;  margin-top: 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;if (fromVal == null &amp;amp;&amp;amp; !entity.isIdProperty(persistentProperty)) {&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;    targetWrapper.setProperty(persistentProperty, null);&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;} else if (fromVal != null &amp;amp;&amp;amp; !fromVal.equals(targetWrapper.getProperty(persistentProperty))) {&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;    targetWrapper.setProperty(persistentProperty, fromVal);&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   margin-bottom: 10px;  width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;}&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
			&lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;p/&gt;

&lt;p&gt;I&apos;m happy to submit a pull request if the desired behavior is for nulls to actually null out the database fields (as opposed to null-as-ignore), but I don&apos;t know whether it is.&lt;/p&gt;

&lt;p&gt;If it &lt;b&gt;is&lt;/b&gt; the desired behavior, I think it will be important to make this very clear to users upgrading to 2.0.0, since it has the potential to be destructive. (I&apos;m thinking of a user thinking they&apos;re doing a partial update of a persistent entity, only to find out that the missing properties wipe things out in the DB.)&lt;/p&gt;

&lt;p&gt;If it&apos;s &lt;b&gt;not&lt;/b&gt; the desired behavior, then it would be helpful indeed to understand the proper way to null properties out.&lt;/p&gt;</comment>
                            <comment id="93914" author="ww4" created="Wed, 25 Sep 2013 14:26:56 +0000"  >&lt;p&gt;According to REST in Practice (which I know Oliver&apos;s a big fan of), PUT is idempotent, and expects the entire resource representation (p. 70). PATCH is for partial updates, though I don&apos;t know if it&apos;s more for sets of instructions or for the null-as-ignore thing that SDR currently does. At any rate it seems that PUT shouldn&apos;t ignore the nulls.&lt;/p&gt;
</comment>
                            <comment id="94012" author="ww4" created="Fri, 27 Sep 2013 14:21:09 +0000"  >&lt;p&gt;I&apos;ve created a pull request for this issue; please review:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/spring-projects/spring-data-rest/pull/121&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/spring-projects/spring-data-rest/pull/121&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="97194" author="gregturn" created="Thu, 9 Jan 2014 18:53:02 +0000"  >&lt;p&gt;I added some tests to a local branch I will look at applying when this gets merged.&lt;/p&gt;</comment>
                            <comment id="97273" author="gregturn" created="Mon, 13 Jan 2014 09:51:10 +0000"  >&lt;p&gt;Added test cases and merged to master.&lt;/p&gt;</comment>
                            <comment id="99929" author="antapos" created="Thu, 6 Mar 2014 13:53:09 +0000"  >&lt;p&gt;This issue has not been resolved for associations. The code in method DomainObjectMerger should be changed according as the following code excerpt:&lt;/p&gt;

&lt;p&gt;            public void doWithAssociation(Association&amp;lt;? extends PersistentProperty&amp;lt;?&amp;gt;&amp;gt; association) {&lt;/p&gt;

&lt;p&gt;                PersistentProperty&amp;lt;?&amp;gt; persistentProperty = association.getInverse();&lt;br/&gt;
                Object fromVal = fromWrapper.getProperty(persistentProperty);&lt;/p&gt;

&lt;p&gt;                if (nullPolicy == APPLY_NULLS || (fromVal != null &amp;amp;&amp;amp; !fromVal.equals(targetWrapper.getProperty(persistentProperty)))) &lt;/p&gt;
{
                    targetWrapper.setProperty(persistentProperty, fromVal);
                }
&lt;p&gt;            }&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_10170" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>First Response Date</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 17 Sep 2013 00:14:32 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10280" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>37052</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10182" key="com.atlassian.jira.toolkit:lastupdaterorcommenter">
                        <customfieldname>Last updater</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>antapos</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10880" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i005q7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10380" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>938</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10381" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Ranking</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>36754</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10120" key="com.atlassian.jira.plugin.system.customfieldtypes:url">
                        <customfieldname>Reference URL</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[https://api.github.com/repos/SpringSource/spring-data-rest/issues/98]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10480" key="com.pyxis.greenhopper.jira:gh-sprint">
                        <customfieldname>Sprint</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="30">42 - 2014 Kickoff</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10171" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>