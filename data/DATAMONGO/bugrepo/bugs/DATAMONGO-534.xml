<!-- 
RSS generated by JIRA (6.4.11#64026-sha1:78f6ec473a3f058bd5d6c30e9319c7ab376bdb9c) at Thu Dec 22 15:33:01 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://jira.spring.io/si/jira.issueviews:issue-xml/DATAMONGO-534/DATAMONGO-534.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>Spring JIRA</title>
    <link>https://jira.spring.io</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.4.11</version>
        <build-number>64026</build-number>
        <build-date>25-08-2015</build-date>
    </build-info>

<item>
            <title>[DATAMONGO-534] The GridFs query execution does not return sorted resources, when the sorting fields are defined in the query definition</title>
                <link>https://jira.spring.io/browse/DATAMONGO-534</link>
                <project id="10701" key="DATAMONGO">Spring Data MongoDB</project>
                    <description>&lt;p&gt;The sorting fields of a &lt;tt&gt;Query&lt;/tt&gt; instance are disregarded during the query execution using an instance of &lt;tt&gt;GridFsOperations&lt;/tt&gt;. The result sets of the found GridFS files are not sorted no matter of the existence of the sorting fields in the preceding query. I expected the resources to be sorted according to the instructions of the corresponding sorting fields.&lt;/p&gt;

&lt;p&gt;Example (a dummy one):&lt;/p&gt;

&lt;p&gt;Prerequisites:&lt;/p&gt;

&lt;p&gt;1. At least 2 files have been stored using GridFs&lt;br/&gt;
2. We have certain meta-data fields, which are used as part of the criteria, but we will miss, since they are irrelevant to the example.&lt;/p&gt;

&lt;p/&gt;
&lt;div id=&quot;syntaxplugin&quot; class=&quot;syntaxplugin&quot; style=&quot;border: 1px dashed #bbb; border-radius: 5px !important; overflow: auto; max-height: 30em;&quot;&gt;
&lt;table cellspacing=&quot;0&quot; cellpadding=&quot;0&quot; border=&quot;0&quot; width=&quot;100%&quot; style=&quot;font-size: 1em; line-height: 1.4em !important; font-weight: normal; font-style: normal; color: black;&quot;&gt;
		&lt;tbody &gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;  margin-top: 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;@Autowired&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;private GridFsOperations ops;&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&amp;nbsp;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;Query query = Query.query(Criteria.where(...));&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;query = query.sort().on(&quot;uploadDate&quot;, Order.DESCENDING);&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&amp;nbsp;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   margin-bottom: 10px;  width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;final List&amp;lt;GridFSDBFile&amp;gt; files = ops.find(query);&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
			&lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;p/&gt;

&lt;p&gt;The results in the list, named &lt;tt&gt;files&lt;/tt&gt;, will not be sorted according to the standard &lt;tt&gt;GridFsDbFile&lt;/tt&gt; attribute &lt;tt&gt;uploadDate&lt;/tt&gt;. I believe that the reason lies into the default implementation of the &lt;tt&gt;GridFsOperations&lt;/tt&gt;, more precisely in the class &lt;tt&gt;GridFsTemplate&lt;/tt&gt;. There the method &lt;tt&gt;getMappedQuery(Query)&lt;/tt&gt;, which is used for a basic mapping facility from &lt;tt&gt;Query&lt;/tt&gt; to &lt;tt&gt;DBObject&lt;/tt&gt; is implemented like this:&lt;/p&gt;

&lt;p/&gt;
&lt;div id=&quot;syntaxplugin&quot; class=&quot;syntaxplugin&quot; style=&quot;border: 1px dashed #bbb; border-radius: 5px !important; overflow: auto; max-height: 30em;&quot;&gt;
&lt;table cellspacing=&quot;0&quot; cellpadding=&quot;0&quot; border=&quot;0&quot; width=&quot;100%&quot; style=&quot;font-size: 1em; line-height: 1.4em !important; font-weight: normal; font-style: normal; color: black;&quot;&gt;
		&lt;tbody &gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;  margin-top: 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;private DBObject getMappedQuery(Query query) {&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;	return query == null ? null : queryMapper.getMappedObject(query.getQueryObject(), null);&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   margin-bottom: 10px;  width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;}&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
			&lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;p/&gt;

&lt;p&gt;I believe that this is the problematic call, since I debugged the &lt;tt&gt;DBObject&lt;/tt&gt; returned from the invocation of the &lt;tt&gt;queryMapper.getMappedObject(&#8230;)&lt;/tt&gt; and it never contained any sorting fields no matter that they were part of if the transformed &lt;tt&gt;Query&lt;/tt&gt; instance. I think that if one goes through the &lt;tt&gt;MongoTemplate&lt;/tt&gt; find-ers implementations, she / he may find the mapping implementation there way better than what is currently available with the GridFs implementation.&lt;/p&gt;</description>
                <environment>Ubuntu 12.04, Oracle JDK 1.7u4, Spring stack</environment>
        <key id="45347">DATAMONGO-534</key>
            <summary>The GridFs query execution does not return sorted resources, when the sorting fields are defined in the query definition</summary>
                <type id="1" iconUrl="https://jira.spring.io/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="5" iconUrl="https://jira.spring.io/images/icons/priorities/trivial.png">Trivial</priority>
                        <status id="6" iconUrl="https://jira.spring.io/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="olivergierke">Oliver Gierke</assignee>
                                    <reporter username="emil.simeonov">Emil Simeonov</reporter>
                        <labels>
                            <label>data</label>
                            <label>gridfs</label>
                            <label>mongo</label>
                            <label>mongodb</label>
                            <label>spring</label>
                    </labels>
                <created>Sat, 8 Sep 2012 13:45:30 +0000</created>
                <updated>Thu, 21 Nov 2013 06:23:27 +0000</updated>
                            <resolved>Sun, 13 Oct 2013 03:46:07 +0000</resolved>
                                    <version>1.1 RC1</version>
                                    <fixVersion>1.4 M1 (Codd)</fixVersion>
                                        <due></due>
                            <votes>1</votes>
                                    <watches>4</watches>
                                    <timeoriginalestimate seconds="0">0d</timeoriginalestimate>
                            <timeestimate seconds="0">0d</timeestimate>
                                        <comments>
                            <comment id="83504" author="olivergierke" created="Wed, 12 Sep 2012 04:32:52 +0000"  >&lt;p&gt;I am afraid we cannot do anything about this as the MongoDB Java driver currently does not support sorting on GridFS access. Sorting is usually done through the cursor returned by MongoDB but the GridFS API already returns the list of files. See &lt;a href=&quot;https://jira.mongodb.org/browse/JAVA-431&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;this ticket&lt;/a&gt; for details.&lt;/p&gt;</comment>
                            <comment id="83623" author="olivergierke" created="Mon, 17 Sep 2012 06:05:07 +0000"  >&lt;p&gt;I&apos;ve documented the current restriction alongside the fix for &lt;a href=&quot;https://jira.spring.io/browse/DATAMONGO-528&quot; title=&quot;Document GridFS support&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DATAMONGO-528&quot;&gt;&lt;del&gt;DATAMONGO-528&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="85561" author="phil-schneider" created="Wed, 28 Nov 2012 07:04:45 +0000"  >&lt;p&gt;I provided a possible fix on the java driver. As soon as it is fixed in the java driver it could be fixed here too:&lt;br/&gt;
&lt;a href=&quot;https://jira.mongodb.org/browse/JAVA-431&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://jira.mongodb.org/browse/JAVA-431&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="94458" author="echelon" created="Sat, 12 Oct 2013 23:11:44 +0000"  >&lt;p&gt;The MongoDB Java driver supports the sorting on GridFS access as per this JIRA ticket and available since 2.11.0 version &lt;a href=&quot;https://jira.mongodb.org/browse/JAVA-431&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://jira.mongodb.org/browse/JAVA-431&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Can we please include the sorting support through Spring APIs as well ? &lt;/p&gt;

&lt;p&gt;Thanks,&lt;br/&gt;
-Hiten Patel&lt;/p&gt;</comment>
                            <comment id="94462" author="olivergierke" created="Sun, 13 Oct 2013 03:46:08 +0000"  >&lt;p&gt;Sorry, it seems we have missed the changes on the ticket referred to. Feel free to ping us earlier if you see movement on tickets we&apos;re actually waiting for.&lt;/p&gt;

&lt;p&gt;I&apos;ve upgraded to the latest driver (&lt;a href=&quot;https://jira.spring.io/browse/DATAMONGO-777&quot; title=&quot;Upgrade to Mongo Java Driver in 2.11&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DATAMONGO-777&quot;&gt;&lt;del&gt;DATAMONGO-777&lt;/del&gt;&lt;/a&gt;) and implemented the fix. Feel free to grab the snapshots from our repos.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_10170" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>First Response Date</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 12 Sep 2012 04:32:52 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10280" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>32270</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10182" key="com.atlassian.jira.toolkit:lastupdaterorcommenter">
                        <customfieldname>Last updater</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>tmarshall</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10880" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i007gv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10380" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1226</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10381" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Ranking</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>31970</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10480" key="com.pyxis.greenhopper.jira:gh-sprint">
                        <customfieldname>Sprint</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="23">The Road to Codd M1</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10171" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>