<!-- 
RSS generated by JIRA (6.4.11#64026-sha1:78f6ec473a3f058bd5d6c30e9319c7ab376bdb9c) at Thu Dec 22 15:42:29 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://jira.spring.io/si/jira.issueviews:issue-xml/DATAMONGO-153/DATAMONGO-153.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>Spring JIRA</title>
    <link>https://jira.spring.io</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.4.11</version>
        <build-number>64026</build-number>
        <build-date>25-08-2015</build-date>
    </build-info>

<item>
            <title>[DATAMONGO-153] Parent - Child Relationship Issues</title>
                <link>https://jira.spring.io/browse/DATAMONGO-153</link>
                <project id="10701" key="DATAMONGO">Spring Data MongoDB</project>
                    <description>&lt;p&gt;I have a Parent with Children.  Each child maintains a reference to its parent.&lt;/p&gt;

&lt;p&gt;Issues show up when:&lt;/p&gt;

&lt;p&gt;1) I have a @DBRef referencing the parent in the child class&lt;br/&gt;
   Removing this @DBRef solves the issue&lt;br/&gt;
2) take Example of Country and State&lt;/p&gt;

&lt;p&gt;@Document(collection = &quot;country&quot;)&lt;br/&gt;
public class Country {&lt;br/&gt;
 @DBRef(collection=&quot;state&quot;)&lt;br/&gt;
  private List&amp;lt;State&amp;gt; states = new ArrayList&amp;lt;State&amp;gt;();&lt;/p&gt;


&lt;p&gt;@Document(collection = &quot;state&quot;)&lt;br/&gt;
public class State {&lt;br/&gt;
 //@DBRef&lt;br/&gt;
 private Country country;&lt;/p&gt;

&lt;p&gt;Then...&lt;/p&gt;

&lt;p&gt;   Country countryInDB = get(mongoOperation, &quot;country&quot;, &quot;name&quot;, ctry,Country.class);&lt;br/&gt;
   State stateInDB = get(mongoOperation, &quot;state&quot;, &quot;name&quot;, state, State.class);&lt;/p&gt;

&lt;p&gt;    if (countryInDB == null) &lt;/p&gt;
{
      countryInDB = new Country(ctry);
      mongoOperation.save(countryInDB);
    }

&lt;p&gt;    if (stateInDB == null) &lt;/p&gt;
{
      countryInDB = get(mongoOperation, &quot;country&quot;, &quot;name&quot;, ctry,Country.class);
      stateInDB = new State(state, countryInDB,
          &quot;VS&quot;, 1200L);
      mongoOperation.save(stateInDB);
      countryInDB.getStates().add(stateInDB);
     
      mongoOperation.save(countryInDB);
      //Why do I have to execute the following two lines to save properly???????
      //Without the following lines save doesn&apos;t work - state is already saved. why i have to save it a second time?
      stateInDB = get(mongoOperation, &quot;state&quot;, &quot;name&quot;, state, State.class);
      mongoOperation.save(stateInDB);
    }

&lt;p&gt;Complete package is enclosed as attachment.&lt;/p&gt;</description>
                <environment>Windows/Sun Java 1.6</environment>
        <key id="40508">DATAMONGO-153</key>
            <summary>Parent - Child Relationship Issues</summary>
                <type id="1" iconUrl="https://jira.spring.io/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://jira.spring.io/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://jira.spring.io/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jbrisbin">Jon Brisbin</assignee>
                                    <reporter username="vinaysoni">vinay soni</reporter>
                        <labels>
                            <label>Parent-Child</label>
                    </labels>
                <created>Wed, 25 May 2011 14:19:22 +0000</created>
                <updated>Mon, 25 Mar 2013 09:31:07 +0000</updated>
                            <resolved>Fri, 26 Aug 2011 08:01:21 +0000</resolved>
                                                    <fixVersion>1.0 M3</fixVersion>
                                    <component>Mapping</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                    <timeoriginalestimate seconds="0">0d</timeoriginalestimate>
                            <timeestimate seconds="0">0d</timeestimate>
                                        <comments>
                            <comment id="71695" author="vinaysoni" created="Thu, 26 May 2011 06:38:30 +0000"  >&lt;p&gt;Forgot to include the code for the get method:&lt;/p&gt;

&lt;p&gt; public static &amp;lt;T&amp;gt; T get(MongoOperations mongoOperation,&lt;br/&gt;
      String collectionName, String colname, String colValue, Class&amp;lt;T&amp;gt; classs) &lt;/p&gt;
{

    Object obj = mongoOperation.findOne( new Query(Criteria
        .where(colname).is(colValue)), classs);
    return classs.cast(obj);

  }</comment>
                            <comment id="71723" author="thomas.risberg" created="Fri, 24 Jun 2011 09:43:54 +0000"  >&lt;p&gt;oops, closed the wrong issue&lt;/p&gt;</comment>
                            <comment id="71764" author="jbrisbin" created="Mon, 11 Jul 2011 05:43:16 +0000"  >&lt;p&gt;I just set up a new project using this source code (with the latest version of Spring Data MongoDB, v1.0.0.M3) and the tests passed successfully. The city name was printed as it looks like it was supposed to. Could you please provide more information on how I get this to fail on the latest code? Thanks.&lt;/p&gt;</comment>
                            <comment id="71893" author="olivergierke" created="Fri, 26 Aug 2011 08:01:20 +0000"  >&lt;p&gt;Closed due to inactivity.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="18939" name="test.zip" size="9015" author="vinaysoni" created="Wed, 25 May 2011 14:19:22 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_10170" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>First Response Date</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 24 Jun 2011 09:43:54 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10280" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>28167</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10182" key="com.atlassian.jira.toolkit:lastupdaterorcommenter">
                        <customfieldname>Last updater</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>tmarshall</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10880" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i01c8n:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10380" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>7860</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10381" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Ranking</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>8295</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_10171" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>