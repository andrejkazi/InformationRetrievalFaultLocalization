<!-- 
RSS generated by JIRA (6.4.11#64026-sha1:78f6ec473a3f058bd5d6c30e9319c7ab376bdb9c) at Fri Dec 23 11:47:25 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://jira.spring.io/si/jira.issueviews:issue-xml/SEC-402/SEC-402.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>Spring JIRA</title>
    <link>https://jira.spring.io</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.4.11</version>
        <build-number>64026</build-number>
        <build-date>25-08-2015</build-date>
    </build-info>

<item>
            <title>[SEC-402] SwitchUserProcessingFilter&apos;s switchUserUrl</title>
                <link>https://jira.spring.io/browse/SEC-402</link>
                <project id="10040" key="SEC">Spring Security</project>
                    <description>&lt;p&gt;During using SwitchUserProcessingFilter,we have to configure the following xml info.&lt;/p&gt;

&lt;p&gt;   &amp;lt;bean id=&quot;filterInvocationInterceptor&quot; class=&quot;org.acegisecurity.intercept.web.FilterSecurityInterceptor&quot;&amp;gt;&lt;br/&gt;
      &amp;lt;property name=&quot;objectDefinitionSource&quot;&amp;gt;&lt;br/&gt;
         &amp;lt;value&amp;gt;&lt;br/&gt;
			    CONVERT_URL_TO_LOWERCASE_BEFORE_COMPARISON&lt;br/&gt;
			    PATTERN_TYPE_APACHE_ANT&lt;br/&gt;
			    /index.jsp=ROLE_ANONYMOUS,ROLE_USER&lt;br/&gt;
			    /hello.htm=ROLE_ANONYMOUS,ROLE_USER&lt;br/&gt;
			    /logoff.jsp=ROLE_ANONYMOUS,ROLE_USER&lt;br/&gt;
			    /switchuser.jsp=ROLE_SUPERVISOR&lt;br/&gt;
			    /j_acegi_switch_user=ROLE_SUPERVISOR&lt;br/&gt;
			    /acegilogin.jsp*=ROLE_ANONYMOUS,ROLE_USER&lt;br/&gt;
				/**=ROLE_USER&lt;br/&gt;
         &amp;lt;/value&amp;gt;&lt;br/&gt;
      &amp;lt;/property&amp;gt;&lt;br/&gt;
   &amp;lt;/bean&amp;gt;&lt;/p&gt;

&lt;p&gt;   &amp;lt;bean id=&quot;switchUserProcessingFilter&quot; class=&quot;org.acegisecurity.ui.switchuser.SwitchUserProcessingFilter&quot;&amp;gt;&lt;br/&gt;
      &amp;lt;property name=&quot;userDetailsService&quot; ref=&quot;jdbcDaoImpl&quot; /&amp;gt;&lt;br/&gt;
	  &amp;lt;property name=&quot;switchUserUrl&quot;&amp;gt;&amp;lt;value&amp;gt;/j_acegi_switch_user&amp;lt;/value&amp;gt;&amp;lt;/property&amp;gt;&lt;br/&gt;
	  &amp;lt;property name=&quot;exitUserUrl&quot;&amp;gt;&amp;lt;value&amp;gt;/j_acegi_exit_user&amp;lt;/value&amp;gt;&amp;lt;/property&amp;gt;&lt;br/&gt;
	  &amp;lt;property name=&quot;targetUrl&quot;&amp;gt;&amp;lt;value&amp;gt;/secure/index.htm&amp;lt;/value&amp;gt;&amp;lt;/property&amp;gt;&lt;br/&gt;
   &amp;lt;/bean&amp;gt;    &lt;/p&gt;

&lt;p&gt;As far as I know,  FilterSecurityInterceptor have no chance to process  /j_acegi_switch_user=ROLE_SUPERVISOR.Why?&lt;br/&gt;
For example,in contacts demo based form authentication, when scott user logins the system,then he can use &lt;a href=&quot;http://localhost:8080/contactsforchapter5form/j_acegi_switch_user?j_username=marissa&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://localhost:8080/contactsforchapter5form/j_acegi_switch_user?j_username=marissa&lt;/a&gt; URL, all of us don&apos;t want see this case.&lt;/p&gt;

&lt;p&gt;In the SwitchUserProcessingFilter source code, it&apos;s doFilter() method contains the content:&lt;/p&gt;

&lt;p&gt;        if (requiresSwitchUser(httpRequest)) {&lt;br/&gt;
            // if set, attempt switch and store original&lt;br/&gt;
            Authentication targetUser = attemptSwitchUser(httpRequest);&lt;/p&gt;

&lt;p&gt;            // update the current context to the new target user&lt;br/&gt;
            SecurityContextHolder.getContext().setAuthentication(targetUser);&lt;/p&gt;

&lt;p&gt;            // redirect to target url&lt;br/&gt;
            httpResponse.sendRedirect(httpResponse.encodeRedirectURL(httpRequest.getContextPath() + targetUrl));&lt;/p&gt;

&lt;p&gt;            return;&lt;/p&gt;

&lt;p&gt;Here, sendRedirect() make FilterSecurityInterceptor having no chance to finish authorization on &quot;/j_acegi_switch_user&quot;, &lt;br/&gt;
because &quot;FilterSecurityInterceptor &quot; url has changed to targetUrl.&lt;/p&gt;</description>
                <environment>acegi 1.03/acegi contacts demo</environment>
        <key id="15560">SEC-402</key>
            <summary>SwitchUserProcessingFilter&apos;s switchUserUrl</summary>
                <type id="1" iconUrl="https://jira.spring.io/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://jira.spring.io/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://jira.spring.io/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="vishal.puri">Vishal Puri</assignee>
                                    <reporter username="worldheart">Shifei Luo</reporter>
                        <labels>
                    </labels>
                <created>Sun, 26 Nov 2006 13:25:37 +0000</created>
                <updated>Sat, 6 Feb 2016 06:32:19 +0000</updated>
                            <resolved>Thu, 26 Apr 2007 14:00:15 +0000</resolved>
                                    <version>1.0.4</version>
                    <version>2.0.0 M1</version>
                                    <fixVersion>1.0.4</fixVersion>
                                    <component>Core</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="21067" author="worldheart" created="Sun, 26 Nov 2006 13:27:44 +0000"  >&lt;p&gt;Here, sendRedirect() make FilterSecurityInterceptor having no chance to finish authorization on &quot;/j_acegi_switch_user&quot;,&lt;br/&gt;
because &quot;FilterSecurityInterceptor &quot; url has changed to targetUrl. &lt;/p&gt;

&lt;p&gt;Above &quot;FilterSecurityInterceptor &quot; should be &quot;/j_acegi_switch_user&quot;.&lt;/p&gt;

&lt;p&gt;Sorry.&lt;/p&gt;</comment>
                            <comment id="23448" author="vishal.puri" created="Thu, 26 Apr 2007 13:59:07 +0000"  >&lt;p&gt;This Issue was already logged as a &lt;a href=&quot;http://opensource.atlassian.com/projects/spring/browse/SEC-376&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://opensource.atlassian.com/projects/spring/browse/SEC-376&lt;/a&gt; and is resolved already. Hence, it&apos;s being closed.&lt;/p&gt;</comment>
                            <comment id="23449" author="vishal.puri" created="Thu, 26 Apr 2007 14:00:15 +0000"  >&lt;p&gt;Same as &lt;a href=&quot;http://opensource.atlassian.com/projects/spring/browse/SEC-376and&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://opensource.atlassian.com/projects/spring/browse/SEC-376and&lt;/a&gt; is already resolved. Hence being closed.&lt;/p&gt;</comment>
                            <comment id="126375" author="issuemaster" created="Sat, 6 Feb 2016 06:32:19 +0000"  >&lt;p&gt;This issue has been migrated to &lt;a href=&quot;https://github.com/spring-projects/spring-security/issues/665&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/spring-projects/spring-security/issues/665&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_10170" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>First Response Date</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 26 Apr 2007 13:59:07 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10280" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>20437</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10880" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0272v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10380" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>12856</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10381" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Ranking</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>12658</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_10171" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>