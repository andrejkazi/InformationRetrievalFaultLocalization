<!-- 
RSS generated by JIRA (6.4.11#64026-sha1:78f6ec473a3f058bd5d6c30e9319c7ab376bdb9c) at Fri Dec 23 10:23:56 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://jira.spring.io/si/jira.issueviews:issue-xml/SEC-2832/SEC-2832.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>Spring JIRA</title>
    <link>https://jira.spring.io</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.4.11</version>
        <build-number>64026</build-number>
        <build-date>25-08-2015</build-date>
    </build-info>

<item>
            <title>[SEC-2832] CSRF Request attributes not updated on authentication</title>
                <link>https://jira.spring.io/browse/SEC-2832</link>
                <project id="10040" key="SEC">Spring Security</project>
                    <description>&lt;p&gt;The CsrfFilter sets request attributes on each request, exposing the current CsrfToken for later use.  However, if authentication happens during this request, the SessionManagementFilter will cause the CsrfAuthenticationStrategy to fire which will generate a new token.  However, the request attributes are not updated.  As a result, if there is a form being rendered in the response using the CsrfRequestDataValueProcessor, it will use the old CsrfToken instead of the newly generated one.  As a result, when the form is submitted, the request will fail due to CSRF protection.&lt;/p&gt;</description>
                <environment></environment>
        <key id="61991">SEC-2832</key>
            <summary>CSRF Request attributes not updated on authentication</summary>
                <type id="1" iconUrl="https://jira.spring.io/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="4" iconUrl="https://jira.spring.io/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://jira.spring.io/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="8">Complete</resolution>
                                        <assignee username="rwinch">Rob Winch</assignee>
                                    <reporter username="stillglade">Benjamin Burgess</reporter>
                        <labels>
                    </labels>
                <created>Wed, 28 Jan 2015 06:36:14 +0000</created>
                <updated>Sat, 6 Feb 2016 06:27:33 +0000</updated>
                            <resolved>Tue, 24 Feb 2015 15:35:27 +0000</resolved>
                                    <version>3.2.5</version>
                    <version>4.0.0.RC1</version>
                                    <fixVersion>3.2.6</fixVersion>
                    <fixVersion>4.0.0.RC2</fixVersion>
                                    <component>Web</component>
                        <due></due>
                            <votes>3</votes>
                                    <watches>5</watches>
                                    <timeoriginalestimate seconds="3600">1h</timeoriginalestimate>
                            <timeestimate seconds="3600">1h</timeestimate>
                                        <comments>
                            <comment id="112025" author="stillglade" created="Wed, 28 Jan 2015 07:16:36 +0000"  >&lt;p&gt;The 167 pull request simply updates the CsrfAuthenticationStrategy to set the new token into the request attributes.  This should be sufficient for 3.2.6.&lt;/p&gt;

&lt;p&gt;Maybe for 4.0, a more dramatic refactoring could be done to bring the setting of these attributes into common code that both the CsrfFilter and CsrfAuthenticationStrategy could use.  For example, maybe the SaveOnAccessCsrfToken private class in the CsrfFilter could be moved out as a protected final class.  Then the setting of the request attributes could be moved into it instead (the constructor could do it).  Then the CsrfAuthenticationStrategy could reuse that class instead of directly saving its newly generated token to the repository, bringing the lazy-saving of the token functionality as well as unifying the setting of the request attributes into one location.&lt;/p&gt;</comment>
                            <comment id="112026" author="stillglade" created="Wed, 28 Jan 2015 07:36:06 +0000"  >&lt;p&gt;Actually, &lt;a href=&quot;https://jira.spring.io/browse/SEC-2404&quot; title=&quot;CsrfAuthenticationStrategy to add valid token to HTTP request after clearing the one in HTTP session&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SEC-2404&quot;&gt;&lt;del&gt;SEC-2404&lt;/del&gt;&lt;/a&gt; seems to be reporting this same issue, but it looks like it wasn&apos;t actually fixed even though it is marked as such.  In fact, the proposed snippet of code in that issue is similar to what I was suggesting as a refactored fix for 4.0.&lt;/p&gt;

&lt;p&gt;Either way, the priority on this should be high as opposed to how &lt;a href=&quot;https://jira.spring.io/browse/SEC-2404&quot; title=&quot;CsrfAuthenticationStrategy to add valid token to HTTP request after clearing the one in HTTP session&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SEC-2404&quot;&gt;&lt;del&gt;SEC-2404&lt;/del&gt;&lt;/a&gt; was reported.&lt;/p&gt;</comment>
                            <comment id="112787" author="rwinch" created="Tue, 24 Feb 2015 15:34:44 +0000"  >&lt;p&gt;Thanks for the report and pointing out the existing issue. Looking at the &quot;fix&quot; for &lt;a href=&quot;https://jira.spring.io/browse/SEC-2404&quot; title=&quot;CsrfAuthenticationStrategy to add valid token to HTTP request after clearing the one in HTTP session&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SEC-2404&quot;&gt;&lt;del&gt;SEC-2404&lt;/del&gt;&lt;/a&gt; I clearly was missing what was wrong.&lt;/p&gt;

&lt;p&gt;The priority of minor fits because there is an &quot;easy workaround&quot;. Specifically, in most instances after a logout (or any state changing action) a redirect should occur. This means that the token will be repopulated by the CsrfFilter.&lt;/p&gt;

&lt;p&gt;This is now resolved in 3.2.6 and 4.0.0.RC2 which will be out later this week&lt;/p&gt;</comment>
                            <comment id="125866" author="issuemaster" created="Sat, 6 Feb 2016 06:27:33 +0000"  >&lt;p&gt;This issue has been migrated to &lt;a href=&quot;https://github.com/spring-projects/spring-security/issues/3056&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/spring-projects/spring-security/issues/3056&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10151">
                    <name>Relate</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="51895">SEC-2404</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_10170" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>First Response Date</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 24 Feb 2015 15:34:44 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10280" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10684" key="com.atlassian.jira.plugin.system.customfieldtypes:url">
                        <customfieldname>Pull Request URL</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[https://github.com/spring-projects/spring-security/pull/167]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10880" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i085wv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10380" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10381" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Ranking</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_10171" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>