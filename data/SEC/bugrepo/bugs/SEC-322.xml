<!-- 
RSS generated by JIRA (6.4.11#64026-sha1:78f6ec473a3f058bd5d6c30e9319c7ab376bdb9c) at Fri Dec 23 11:33:07 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://jira.spring.io/si/jira.issueviews:issue-xml/SEC-322/SEC-322.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>Spring JIRA</title>
    <link>https://jira.spring.io</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.4.11</version>
        <build-number>64026</build-number>
        <build-date>25-08-2015</build-date>
    </build-info>

<item>
            <title>[SEC-322] SavedRequest : ClassCastException when calling parameters.get(paramName)</title>
                <link>https://jira.spring.io/browse/SEC-322</link>
                <project id="10040" key="SEC">Spring Security</project>
                    <description>&lt;p&gt;If you are using WebSphere and IBM JSF, the following problem happens:&lt;br/&gt;
The fact that WebSphere container puts non-string array objects into the request parameter maps such as String object&lt;br/&gt;
causes ClassCastException when ExceptionTranslator instanciates a new SavedRequest instance, &lt;br/&gt;
which executes the following code in its constructor(Line #113):&lt;/p&gt;

&lt;p&gt;//SavedRequest class&lt;br/&gt;
.&lt;br/&gt;
.&lt;br/&gt;
.&lt;br/&gt;
// Parameters&lt;br/&gt;
Map parameters = request.getParameterMap();&lt;br/&gt;
Iterator paramNames = parameters.keySet().iterator();&lt;/p&gt;

&lt;p&gt;while (paramNames.hasNext()) {&lt;br/&gt;
	String paramName = (String) paramNames.next();&lt;br/&gt;
	String[] paramValues = (String[]) parameters.get(paramName);&lt;br/&gt;
	this.addParameter(paramName, paramValues);&lt;br/&gt;
}&lt;br/&gt;
.&lt;br/&gt;
.&lt;br/&gt;
.&lt;/p&gt;

&lt;p&gt;Since it&apos;s happening in the constructor, I can&apos;t override this behavior,so &lt;br/&gt;
I have to write my own SavedRequest class that does string-array type check before casting the returned value from the parameter map.&lt;/p&gt;

&lt;p&gt;//Custom SavedRequest class&lt;br/&gt;
.&lt;br/&gt;
.&lt;br/&gt;
.&lt;br/&gt;
// Parameters&lt;br/&gt;
Map parameters = request.getParameterMap();&lt;br/&gt;
Iterator paramNames = parameters.keySet().iterator();&lt;br/&gt;
while (paramNames.hasNext()) {&lt;br/&gt;
	String paramName = (String) paramNames.next();&lt;br/&gt;
	Object o =  parameters.get(paramName);&lt;br/&gt;
	if(o instanceof String[])&lt;/p&gt;
{
		String[] paramValues = (String[])o;
		this.addParameter(paramName, paramValues);
	}
&lt;p&gt;	else&lt;/p&gt;
{
		//log
		.
		.
		.
	}
&lt;p&gt;}&lt;br/&gt;
.&lt;br/&gt;
.&lt;br/&gt;
.&lt;/p&gt;

&lt;p&gt;The bad thing was I also had to modify other classes which referenced the original SavedRequest object.&lt;/p&gt;

&lt;p&gt;Do you think you can fix this issue in the next release?&lt;/p&gt;</description>
                <environment>IBM WebSphere and IBM JSF</environment>
        <key id="14571">SEC-322</key>
            <summary>SavedRequest : ClassCastException when calling parameters.get(paramName)</summary>
                <type id="1" iconUrl="https://jira.spring.io/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="4" iconUrl="https://jira.spring.io/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://jira.spring.io/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="balex">Ben Alex</assignee>
                                    <reporter username="chanta">Tomo Izumi</reporter>
                        <labels>
                    </labels>
                <created>Wed, 19 Jul 2006 23:15:12 +0000</created>
                <updated>Sat, 6 Feb 2016 06:31:32 +0000</updated>
                            <resolved>Mon, 13 Nov 2006 12:21:59 +0000</resolved>
                                    <version>1.0.1</version>
                    <version>1.0.2</version>
                                    <fixVersion>1.0.3</fixVersion>
                                    <component>Core</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="20792" author="balex" created="Mon, 13 Nov 2006 12:17:38 +0000"  >&lt;p&gt;&lt;a href=&quot;http://java.sun.com/j2ee/1.4/docs/api/javax/servlet/ServletRequest.html#getParameterMap(&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://java.sun.com/j2ee/1.4/docs/api/javax/servlet/ServletRequest.html#getParameterMap(&lt;/a&gt;) states expressly:&lt;/p&gt;

&lt;p&gt;&quot;an immutable java.util.Map containing parameter names as keys and parameter values as map values. The keys in the parameter map are of type String. The values in the parameter map are of type String array.&quot;&lt;/p&gt;

&lt;p&gt;So I am uncertain why WebSphere apparently behaves otherwise.&lt;/p&gt;</comment>
                            <comment id="20793" author="balex" created="Mon, 13 Nov 2006 12:21:59 +0000"  >&lt;p&gt;Added conditional as suggested by reporter, logging if non-array returned.&lt;/p&gt;

&lt;p&gt;Checked into SVN, tests pass.&lt;/p&gt;</comment>
                            <comment id="21051" author="chanta" created="Fri, 24 Nov 2006 00:06:26 +0000"  >&lt;p&gt;Ben,&lt;/p&gt;

&lt;p&gt;It was jsf-ibm.jar  that was causing this problem, not the WebSphere container itself.&lt;br/&gt;
If you use Rational Web Development  Platform v6.0.1 and its JSF implementation, you will run into this problem.&lt;br/&gt;
Hopefully it will be fixed in v6.0.1.1.&lt;/p&gt;

&lt;p&gt;Tomo &lt;/p&gt;</comment>
                            <comment id="126286" author="issuemaster" created="Sat, 6 Feb 2016 06:31:32 +0000"  >&lt;p&gt;This issue has been migrated to &lt;a href=&quot;https://github.com/spring-projects/spring-security/issues/583&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/spring-projects/spring-security/issues/583&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_10170" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>First Response Date</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 13 Nov 2006 12:17:38 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10280" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>20514</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10880" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i01w9j:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10380" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>11104</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10381" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Ranking</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>11083</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_10171" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>