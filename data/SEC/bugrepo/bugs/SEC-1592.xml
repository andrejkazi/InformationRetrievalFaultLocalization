<!-- 
RSS generated by JIRA (6.4.11#64026-sha1:78f6ec473a3f058bd5d6c30e9319c7ab376bdb9c) at Fri Dec 23 11:20:36 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://jira.spring.io/si/jira.issueviews:issue-xml/SEC-1592/SEC-1592.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>Spring JIRA</title>
    <link>https://jira.spring.io</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.4.11</version>
        <build-number>64026</build-number>
        <build-date>25-08-2015</build-date>
    </build-info>

<item>
            <title>[SEC-1592] CAS proxy receptor requests must not pass through the filter chain</title>
                <link>https://jira.spring.io/browse/SEC-1592</link>
                <project id="10040" key="SEC">Spring Security</project>
                    <description>&lt;p&gt;I configured spring-security-cas in my webapp for generating proxy tickets.&lt;/p&gt;

&lt;p&gt;During ticket validation we provide a pgtUrl parameter and then the CAS server tries&lt;br/&gt;
to connect to our webapp (using the configured proxyReceptorUrl) to determine is this&lt;br/&gt;
URL is a valid end-point but it result in a 404 because the request is passed trough&lt;br/&gt;
the servlet but is not handled (because no controller is mapped for this URL).&lt;/p&gt;

&lt;p&gt;If we set the grails.plugins.springsecurity.rejectIfNoRule parameter &lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; to true or if I mark this&lt;br/&gt;
proxy receptor URL with the role &quot;IS_AUTHENTICATED_REMEMBERED&quot; then it works:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;the ping request &lt;span class=&quot;error&quot;&gt;&amp;#91;2&amp;#93;&lt;/span&gt; result in a 302 (redirection to CAS because the request needs to be authenticated)&lt;/li&gt;
	&lt;li&gt;the pgtId/pgtIou request result also in a 302 (therefore without the proper XML fragment) but the mapping is stored&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;This works because the CAS server is not strict about the expected XML fragment,&lt;br/&gt;
only the a proper status code is mandatory &lt;span class=&quot;error&quot;&gt;&amp;#91;2&amp;#93;&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;Current workaround is to create a controller for this URL with anonymous access and&lt;br/&gt;
always respond with a 200 and some text.&lt;/p&gt;

&lt;p&gt;I believe this issue is not related to Grails and may impact any webapp using&lt;br/&gt;
spring-security-cas and wanting to generate proxy tickets.&lt;br/&gt;
Furthermore, the default behaviour in cas-client &lt;span class=&quot;error&quot;&gt;&amp;#91;3&amp;#93;&lt;/span&gt; is already to stop processing the&lt;br/&gt;
request once it has been handled by the Cas20ProxyReceivingTicketValidationFilter &lt;span class=&quot;error&quot;&gt;&amp;#91;3&amp;#93;&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; &lt;a href=&quot;http://burtbeckwith.github.com/grails-spring-security-core/docs/manual/index.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://burtbeckwith.github.com/grails-spring-security-core/docs/manual/index.html&lt;/a&gt;&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;2&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://source.jasig.org/cas3/tags/cas-3-3-5-1-final/cas-server-core/src/main/java/org/jasig/cas/authentication/handler/support/HttpBasedServiceCredentialsAuthenticationHandler.java&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://source.jasig.org/cas3/tags/cas-3-3-5-1-final/cas-server-core/src/main/java/org/jasig/cas/authentication/handler/support/HttpBasedServiceCredentialsAuthenticationHandler.java&lt;/a&gt;&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;2&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://source.jasig.org/cas3/tags/cas-3-3-5-1-final/cas-server-core/src/main/java/org/jasig/cas/util/HttpClient.java&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://source.jasig.org/cas3/tags/cas-3-3-5-1-final/cas-server-core/src/main/java/org/jasig/cas/util/HttpClient.java&lt;/a&gt;&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;3&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://source.jasig.org/cas-clients/java-client/tags/cas-client-3.1.12/cas-client-core/src/main/java/org/jasig/cas/client/validation/Cas20ProxyReceivingTicketValidationFilter.java&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://source.jasig.org/cas-clients/java-client/tags/cas-client-3.1.12/cas-client-core/src/main/java/org/jasig/cas/client/validation/Cas20ProxyReceivingTicketValidationFilter.java&lt;/a&gt;&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;3&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://source.jasig.org/cas-clients/java-client/tags/cas-client-3.1.12/cas-client-core/src/main/java/org/jasig/cas/client/validation/AbstractTicketValidationFilter.java&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://source.jasig.org/cas-clients/java-client/tags/cas-client-3.1.12/cas-client-core/src/main/java/org/jasig/cas/client/validation/AbstractTicketValidationFilter.java&lt;/a&gt;&lt;/p&gt;</description>
                <environment>Ubuntu Lucid&lt;br/&gt;
Java(TM) SE Runtime Environment (build 1.6.0_20-b02)&lt;br/&gt;
Grails 1.3.2&lt;br/&gt;
Spring security core/cas 3.0.2 (Grails spring-security-core plugin 0.4.1 &amp;amp; Grails spring-security-cas plugin 0.1)</environment>
        <key id="33780">SEC-1592</key>
            <summary>CAS proxy receptor requests must not pass through the filter chain</summary>
                <type id="1" iconUrl="https://jira.spring.io/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="4" iconUrl="https://jira.spring.io/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://jira.spring.io/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="8">Complete</resolution>
                                        <assignee username="rwinch">Rob Winch</assignee>
                                    <reporter username="yabon">S&#233;bastien Launay</reporter>
                        <labels>
                    </labels>
                <created>Wed, 13 Oct 2010 08:22:21 +0000</created>
                <updated>Sat, 6 Feb 2016 06:15:40 +0000</updated>
                            <resolved>Thu, 27 Jan 2011 08:52:41 +0000</resolved>
                                    <version>3.0.2</version>
                                    <fixVersion>3.1.0.RC1</fixVersion>
                    <fixVersion>3.0.6</fixVersion>
                                    <component>CAS</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                <comments>
                            <comment id="59160" author="yabon" created="Wed, 13 Oct 2010 08:35:14 +0000"  >&lt;p&gt;A patch against the master branch to:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;reproduce the issue with a test case (and also to detect potential future regression around proxy receptor)&lt;/li&gt;
	&lt;li&gt;stop processing the request once it has been handled by CommonUtils#readAndRespondToProxyReceptorRequest(...)&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="62809" author="rwinch" created="Thu, 27 Jan 2011 08:51:58 +0000"  >&lt;p&gt;Thank you for your bug/patch submission. I fixed this is 3.x and master, but went about it slightly differently. In short, the fix moves CommonUtils.readAndRespondToProxyReceptorRequest into CasAuthenticationFilter.attemptAuthentication. This makes sense since the CAS server is authenticating that the proxy url is valid (i.e. it exists and the SSL handshake succeeds). It also allows the FilterChain to not be processed by returning a null Authentication.&lt;/p&gt;</comment>
                            <comment id="62810" author="yabon" created="Thu, 27 Jan 2011 09:35:18 +0000"  >&lt;p&gt;Thanks Rob I now will be able to remove my workaround.&lt;/p&gt;

&lt;p&gt;Like you said, the fix has been backported to 3.0.x (commit ece824f) so I guess this issue needs to also be marked as fixed for version 3.0.6.&lt;/p&gt;</comment>
                            <comment id="62812" author="rwinch" created="Thu, 27 Jan 2011 09:43:19 +0000"  >&lt;p&gt;&amp;gt;&amp;gt; Like you said, the fix has been backported to 3.0.x (commit ece824f) so I guess this issue needs to also be marked as fixed for version 3.0.6. &lt;/p&gt;

&lt;p&gt;Good catch....I have updated the fix version&lt;/p&gt;</comment>
                            <comment id="124521" author="issuemaster" created="Sat, 6 Feb 2016 06:15:40 +0000"  >&lt;p&gt;This issue has been migrated to &lt;a href=&quot;https://github.com/spring-projects/spring-security/issues/1831&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/spring-projects/spring-security/issues/1831&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="17190" name="fix-cas-proxy-receptor-chain-2010-10-13.patch" size="10649" author="yabon" created="Wed, 13 Oct 2010 08:35:14 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_10170" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>First Response Date</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 27 Jan 2011 08:51:58 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10280" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>12866</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10880" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i02urz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10380" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>16695</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10381" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Ranking</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>15711</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_10171" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>