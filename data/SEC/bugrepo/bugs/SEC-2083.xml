<!-- 
RSS generated by JIRA (6.4.11#64026-sha1:78f6ec473a3f058bd5d6c30e9319c7ab376bdb9c) at Fri Dec 23 11:53:47 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://jira.spring.io/si/jira.issueviews:issue-xml/SEC-2083/SEC-2083.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>Spring JIRA</title>
    <link>https://jira.spring.io</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.4.11</version>
        <build-number>64026</build-number>
        <build-date>25-08-2015</build-date>
    </build-info>

<item>
            <title>[SEC-2083] Create a MethodSecurityExpressionHandler that can handle immutable collections</title>
                <link>https://jira.spring.io/browse/SEC-2083</link>
                <project id="10040" key="SEC">Spring Security</project>
                    <description>&lt;p&gt;When using annotations to filter collections based, e.g. &lt;tt&gt;@PostFilter(&quot;hasPermission(filterObject, &apos;SOME_PERMISSION&apos;)&quot;)&lt;/tt&gt;, the &lt;a href=&quot;https://github.com/SpringSource/spring-security/blob/master/core/src/main/java/org/springframework/security/access/expression/method/DefaultMethodSecurityExpressionHandler.java#L72&amp;quot;&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;DefaultMethodSecurityExpressionHandler.filter()&lt;/a&gt; gets called. The problem with this method is that if the &lt;tt&gt;filterTarget&lt;/tt&gt; is an immutable list or an immutable set, an exception will thrown (because &lt;tt&gt;collection.clear()&lt;/tt&gt; is called before the elements in the &lt;tt&gt;retainList&lt;/tt&gt; are added back to the collection).&lt;/p&gt;

&lt;p&gt;One solution to overcome this problem is to implement an &quot;ImmutableMethodSecurityExpressionHandler&quot; by subclassing the &lt;tt&gt;DefaultMethodSecurityExpressionHandler&lt;/tt&gt;, override the &lt;tt&gt;filter()&lt;/tt&gt; method if the &lt;tt&gt;filterTarget&lt;/tt&gt; is of type &lt;tt&gt;List&lt;/tt&gt;, &lt;tt&gt;Set&lt;/tt&gt;, or &lt;tt&gt;SortedSet&lt;/tt&gt;, do the filtering as before, but instead of clearing the existing collection, returning the &lt;tt&gt;retainList&lt;/tt&gt; wrapped in &lt;a href=&quot;http://docs.oracle.com/javase/7/docs/api/java/util/Collections.html#unmodifiableList(java.util.List)&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;Collections.unmodifiableList()&lt;/a&gt;, &lt;a href=&quot;http://docs.oracle.com/javase/7/docs/api/java/util/Collections.html#unmodifiableSet(java.util.Set)&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;Collections.unmodifiableSet()&lt;/a&gt; or &lt;a href=&quot;http://docs.oracle.com/javase/7/docs/api/java/util/Collections.html#unmodifiableSortedSet(java.util.SortedSet)&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;Collections.unmodifiableSortedSet()&lt;/a&gt;&#160;respectively.&lt;/p&gt;</description>
                <environment></environment>
        <key id="46282">SEC-2083</key>
            <summary>Create a MethodSecurityExpressionHandler that can handle immutable collections</summary>
                <type id="4" iconUrl="https://jira.spring.io/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="4" iconUrl="https://jira.spring.io/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://jira.spring.io/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="matsev">Mattias Severson</reporter>
                        <labels>
                    </labels>
                <created>Wed, 21 Nov 2012 10:48:03 +0000</created>
                <updated>Sat, 6 Feb 2016 06:41:38 +0000</updated>
                            <resolved>Sat, 6 Feb 2016 06:41:38 +0000</resolved>
                                                    <fixVersion>4.0 Backlog</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                <comments>
                            <comment id="86203" author="matsev" created="Mon, 17 Dec 2012 13:38:20 +0000"  >&lt;p&gt;Are you considering filtering of immutable collections? I have just submitted a &lt;a href=&quot;https://github.com/SpringSource/spring-security/pull/19&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;pull reqiest&lt;/a&gt; to give you some idea to what I have in mind. &lt;/p&gt;</comment>
                            <comment id="99989" author="rwinch" created="Fri, 7 Mar 2014 10:52:58 +0000"  >&lt;p&gt;Thanks for the submission. I think I would prefer a strategy style pattern rather than inheritance. This would allow handling of custom types. One issue I see w/ the pull request is it does not seem to consider that some users may use specific types of collections. For example, if the method signature were a LinkedList this solution does not look like it would work since LinkedList is a List and the solution would use an ArrayList. A PR that would be merged would certainly need some tests to demonstrate these use cases working.&lt;/p&gt;</comment>
                            <comment id="125055" author="issuemaster" created="Sat, 6 Feb 2016 06:20:47 +0000"  >&lt;p&gt;This issue has been migrated to &lt;a href=&quot;https://github.com/spring-projects/spring-security/issues/2316&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/spring-projects/spring-security/issues/2316&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="55633">SEC-2488</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_10170" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>First Response Date</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 7 Mar 2014 10:52:58 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10280" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>33082</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10880" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i05z5j:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10380" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>34901</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10381" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Ranking</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>32784</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_10171" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>