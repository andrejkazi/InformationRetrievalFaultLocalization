<!-- 
RSS generated by JIRA (6.4.11#64026-sha1:78f6ec473a3f058bd5d6c30e9319c7ab376bdb9c) at Fri Dec 23 09:58:06 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://jira.spring.io/si/jira.issueviews:issue-xml/SEC-822/SEC-822.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>Spring JIRA</title>
    <link>https://jira.spring.io</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.4.11</version>
        <build-number>64026</build-number>
        <build-date>25-08-2015</build-date>
    </build-info>

<item>
            <title>[SEC-822] TokenBasedRememberMeServices calculate expiryTime: explicit cat to long is needed</title>
                <link>https://jira.spring.io/browse/SEC-822</link>
                <project id="10040" key="SEC">Spring Security</project>
                    <description>
&lt;p&gt;public class TokenBasedRememberMeServices extends AbstractRememberMeServices {&lt;/p&gt;

&lt;p&gt;  public void onLoginSuccess(HttpServletRequest request,&lt;br/&gt;
      HttpServletResponse response, Authentication successfulAuthentication) {&lt;/p&gt;

&lt;p&gt;    String username = retrieveUserName(successfulAuthentication);&lt;br/&gt;
    String password = retrievePassword(successfulAuthentication);&lt;/p&gt;

&lt;p&gt;    // If unable to find a username and password, just abort as&lt;br/&gt;
    // TokenBasedRememberMeServices is&lt;br/&gt;
    // unable to construct a valid token in this case.&lt;br/&gt;
    if (!StringUtils.hasLength(username) || !StringUtils.hasLength(password)) &lt;/p&gt;
{
      return;
    }

&lt;p&gt;    int tokenLifetime = calculateLoginLifetime(request,&lt;br/&gt;
        successfulAuthentication);&lt;br/&gt;
    long expiryTime = System.currentTimeMillis() + 1000 * tokenLifetime;&lt;br/&gt;
    String signatureValue = makeTokenSignature(expiryTime, username, password);&lt;/p&gt;

&lt;p&gt;    setCookie(new String[] &lt;/p&gt;
{ username, Long.toString(expiryTime),
        signatureValue }
&lt;p&gt;, tokenLifetime, request, response);&lt;/p&gt;

&lt;p&gt;    if (logger.isDebugEnabled()) &lt;/p&gt;
{
      logger.debug(&quot;Added remember-me cookie for user &apos;&quot; + username
          + &quot;&apos;, expiry: &apos;&quot; + new Date(expiryTime) + &quot;&apos;&quot;);
    }
&lt;p&gt;  }&lt;/p&gt;

&lt;p&gt;}&lt;/p&gt;

&lt;p&gt;tokenLifetime is an integer. When the tokenLifetime is 1 month =&amp;gt; value = 2678400 seconds =&amp;gt; 1000 * 2678400 &amp;gt; Integer.MAX_VALUE =&amp;gt; negative integer.&lt;br/&gt;
In the calculation, there should be an explicit cast to long&lt;br/&gt;
So &lt;br/&gt;
long expiryTime = System.currentTimeMillis() + 1000 * tokenLifetime;&lt;br/&gt;
should be &lt;br/&gt;
long expiryTime = System.currentTimeMillis() + 1000 * &lt;span class=&quot;error&quot;&gt;&amp;#91;B&amp;#93;&lt;/span&gt;(long)&lt;span class=&quot;error&quot;&gt;&amp;#91;/B&amp;#93;&lt;/span&gt; tokenLifetime;&lt;/p&gt;</description>
                <environment>jboss 4.2.0 GA&lt;br/&gt;
jdk 1.6.0_03&lt;br/&gt;
spring security 2.0.1&lt;br/&gt;
spring 2.5.3</environment>
        <key id="22041">SEC-822</key>
            <summary>TokenBasedRememberMeServices calculate expiryTime: explicit cat to long is needed</summary>
                <type id="1" iconUrl="https://jira.spring.io/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://jira.spring.io/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://jira.spring.io/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="luke">Luke Taylor</assignee>
                                    <reporter username="sphemy">Robrecht Anrijs</reporter>
                        <labels>
                    </labels>
                <created>Thu, 8 May 2008 01:27:44 +0000</created>
                <updated>Sat, 6 Feb 2016 06:37:03 +0000</updated>
                            <resolved>Thu, 8 May 2008 02:08:38 +0000</resolved>
                                    <version>2.0.1</version>
                                    <fixVersion>2.0.2</fixVersion>
                                    <component>Core</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="35493" author="luke" created="Thu, 8 May 2008 02:08:38 +0000"  >&lt;p&gt;Thanks for the report. I&apos;ve changed it to &lt;/p&gt;

&lt;p&gt;1000L*tokenLifetime&lt;/p&gt;

&lt;p&gt;which should force the use of long arithmetic.&lt;/p&gt;</comment>
                            <comment id="126837" author="issuemaster" created="Sat, 6 Feb 2016 06:37:03 +0000"  >&lt;p&gt;This issue has been migrated to &lt;a href=&quot;https://github.com/spring-projects/spring-security/issues/1069&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/spring-projects/spring-security/issues/1069&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_10170" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>First Response Date</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 8 May 2008 02:08:38 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10280" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>20056</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10880" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i04n1r:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10380" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>27108</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10381" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Ranking</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>21757</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_10171" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>