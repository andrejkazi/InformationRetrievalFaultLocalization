<!-- 
RSS generated by JIRA (6.4.11#64026-sha1:78f6ec473a3f058bd5d6c30e9319c7ab376bdb9c) at Fri Dec 23 11:37:28 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://jira.spring.io/si/jira.issueviews:issue-xml/SEC-228/SEC-228.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>Spring JIRA</title>
    <link>https://jira.spring.io</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.4.11</version>
        <build-number>64026</build-number>
        <build-date>25-08-2015</build-date>
    </build-info>

<item>
            <title>[SEC-228] URL encoding issues in CasProcessingFilterEntryPoint</title>
                <link>https://jira.spring.io/browse/SEC-228</link>
                <project id="10040" key="SEC">Spring Security</project>
                    <description>&lt;p&gt;A friend who&apos;s looking at integrating another SSO system sent me the the following mail:&lt;/p&gt;

&lt;p&gt;The bug is in CasProcessingFilterEntryPoint (I&apos;m looking at the RC2&lt;br/&gt;
release, havent checked nightly):&lt;/p&gt;

&lt;p&gt;    public void commence(ServletRequest request, ServletResponse response,&lt;br/&gt;
        AuthenticationException authenticationException)&lt;br/&gt;
        throws IOException, ServletException {&lt;br/&gt;
        String url;&lt;/p&gt;

&lt;p&gt;        if (serviceProperties.isSendRenew()) &lt;/p&gt;
{
            url = loginUrl + &quot;?renew=true&quot; + &quot;&amp;amp;service=&quot;
                + serviceProperties.getService();
        }
&lt;p&gt; else &lt;/p&gt;
{
            url = loginUrl + &quot;?service=&quot;
                + URLEncoder.encode(serviceProperties.getService(), &quot;UTF-8&quot;);
        }

&lt;p&gt;        ((HttpServletResponse) response).sendRedirect(url);&lt;br/&gt;
    }&lt;/p&gt;

&lt;p&gt;There are two bugs here.&lt;br/&gt;
The first is that serviceProperties.getService() is the URL of the&lt;br/&gt;
login handler (eg&lt;br/&gt;
&lt;a href=&quot;https://www.mycompany.com/application/j_acegi_cas_security_check&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://www.mycompany.com/application/j_acegi_cas_security_check&lt;/a&gt;).&lt;br/&gt;
However, since this URL doesn&apos;t get encoded with the session id, so&lt;br/&gt;
when CAS redirects back to you and cookies are off, the user gets a&lt;br/&gt;
new session - and I presume they are taken to a default page rather&lt;br/&gt;
than the page they wanted? This might seem obtuse, since CAS SSO&lt;br/&gt;
relies on cookies, but using CAS as a single point of authentication&lt;br/&gt;
doesn&apos;t; you just log into CAS for each resource you want.&lt;/p&gt;

&lt;p&gt;The second bug is even more obvious: service is encoded in the &apos;login&apos;&lt;br/&gt;
URL but not encoded in the &apos;renew&apos; URL. The &apos;renew&apos; one is clearly&lt;br/&gt;
wrong.&lt;/p&gt;

&lt;p&gt;I havent tested these, but they sure look wrong.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13537">SEC-228</key>
            <summary>URL encoding issues in CasProcessingFilterEntryPoint</summary>
                <type id="1" iconUrl="https://jira.spring.io/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://jira.spring.io/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://jira.spring.io/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="sbattaglia">Scott Battaglia</assignee>
                                    <reporter username="luke">Luke Taylor</reporter>
                        <labels>
                    </labels>
                <created>Wed, 15 Mar 2006 01:08:52 +0000</created>
                <updated>Sat, 6 Feb 2016 06:22:27 +0000</updated>
                            <resolved>Thu, 4 May 2006 06:33:33 +0000</resolved>
                                    <version>1.0.0 RC2</version>
                                    <fixVersion>1.0.0</fixVersion>
                                    <component>CAS</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                <comments>
                            <comment id="17489" author="sbattaglia" created="Thu, 4 May 2006 06:33:33 +0000"  >&lt;p&gt;I added the encoding of the service url as well as execuring response.encodeURL on the service url to get the jsession.&lt;/p&gt;</comment>
                            <comment id="17807" author="bruyeron" created="Wed, 31 May 2006 21:05:20 +0000"  >&lt;p&gt;Hi Scott, this change has created problems on CAS 3.0.4, see the external reference.&lt;/p&gt;

&lt;p&gt;The main issue is that ACEGI uses its own value for the serviceId (from ServiceProperties) during ticket validation instead of the value it sent to CAS. Therefore it is possible that they don&apos;t match (for example if jsessionid was present).&lt;/p&gt;</comment>
                            <comment id="17813" author="sbattaglia" created="Thu, 1 Jun 2006 03:50:41 +0000"  >&lt;p&gt;I spoke with one of my coworkers and we&apos;ve determined that Acegi is correct and CAS should remove the jsession as its a user identifier and not a service identifier.  This affects all versions of CAS (2.x and up).  We&apos;ve opened a JIRA issue in the CAS JIRA instance.&lt;/p&gt;</comment>
                            <comment id="125271" author="issuemaster" created="Sat, 6 Feb 2016 06:22:27 +0000"  >&lt;p&gt;This issue has been migrated to &lt;a href=&quot;https://github.com/spring-projects/spring-security/issues/489&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/spring-projects/spring-security/issues/489&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_10170" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>First Response Date</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 4 May 2006 06:33:33 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10280" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>20602</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10880" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i021uf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10380" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>12008</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10381" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Ranking</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>11897</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_10171" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>