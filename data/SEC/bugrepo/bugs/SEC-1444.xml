<!-- 
RSS generated by JIRA (6.4.11#64026-sha1:78f6ec473a3f058bd5d6c30e9319c7ab376bdb9c) at Fri Dec 23 11:13:55 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://jira.spring.io/si/jira.issueviews:issue-xml/SEC-1444/SEC-1444.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>Spring JIRA</title>
    <link>https://jira.spring.io</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.4.11</version>
        <build-number>64026</build-number>
        <build-date>25-08-2015</build-date>
    </build-info>

<item>
            <title>[SEC-1444] BindAuthentiator Fails for Active Directory DN Containing Special Chars</title>
                <link>https://jira.spring.io/browse/SEC-1444</link>
                <project id="10040" key="SEC">Spring Security</project>
                    <description>&lt;p&gt;BindAuthenticator.java (3.0.2) line 115, change userDN:&lt;/p&gt;

&lt;p&gt;Attributes attrs = ctx.getAttributes(userDn, getUserAttributes());&lt;/p&gt;

&lt;p&gt;to fullDn:&lt;/p&gt;

&lt;p&gt;Attributes attrs = ctx.getAttributes(fullDn, getUserAttributes());&lt;/p&gt;

&lt;p&gt;The reason is that when you use fullDn the DN string is generated using the LdapEncoder from Spring-LDAP.   If you use the raw userDn string that encoding isn&apos;t used, so special characters in a username (admittedly rare) can prevent the user from authenticating.&lt;/p&gt;
</description>
                <environment></environment>
        <key id="30672">SEC-1444</key>
            <summary>BindAuthentiator Fails for Active Directory DN Containing Special Chars</summary>
                <type id="1" iconUrl="https://jira.spring.io/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://jira.spring.io/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://jira.spring.io/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="luke">Luke Taylor</assignee>
                                    <reporter username="jnadler">Jeff Nadler</reporter>
                        <labels>
                    </labels>
                <created>Fri, 19 Mar 2010 11:49:38 +0000</created>
                <updated>Sat, 6 Feb 2016 06:14:09 +0000</updated>
                            <resolved>Sat, 27 Mar 2010 03:37:50 +0000</resolved>
                                    <version>3.0.2</version>
                                    <fixVersion>3.0.3</fixVersion>
                    <fixVersion>3.1.0.M1</fixVersion>
                                    <component>LDAP</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                <comments>
                            <comment id="52303" author="luke" created="Mon, 22 Mar 2010 11:01:34 +0000"  >&lt;p&gt;The use of the fullDn will potentially fail there since the name used should be relative to the context returned by the bind. The fullDn is already used for the authentication call (the bind). It may be that we should encode the userDn value too though. Could you clarify what the actual error you are seeing is please?&lt;/p&gt;</comment>
                            <comment id="52332" author="jnadler" created="Tue, 23 Mar 2010 04:23:07 +0000"  >&lt;p&gt;Here&apos;s the exception I get when I attempt to login as a user with a slash in his DN.  All other users can authenticate without problems.&lt;/p&gt;

&lt;p&gt; AuthenticationServiceException: &lt;br/&gt;
org.springframework.security.authentication.AuthenticationServiceException: Uncategorized exception occured during LDAP processing; nested exception is javax.naming.NamingException: [LDAP: error code 1 - 000020D6: SvcErr: DSID-031006CC, problem 5012 (DIR_ERROR), data 0&lt;br/&gt;
remaining name &apos;cn=Pinhead\, Zippy PH/HU,ou=AA,ou=A,ou=Users 135200,dc=dom1,dc=local&apos;&lt;br/&gt;
	at org.springframework.security.ldap.authentication.LdapAuthenticationProvider.authenticate(LdapAuthenticationProvider.java:271)&lt;br/&gt;
	at com.attensa.core.security.MultiAuthorityAuthenticationProvider.authenticateAgainstRemoteDirectory(MultiAuthorityAuthenticationProvider.java:96)&lt;br/&gt;
	at com.attensa.core.security.MultiAuthorityAuthenticationProvider.remoteDirectoryAuthenticationChecks(MultiAuthorityAuthenticationProvider.java:79)&lt;br/&gt;
	at com.attensa.core.security.MultiAuthorityAuthenticationProvider.additionalAuthenticationChecks(MultiAuthorityAuthenticationProvider.java:55)&lt;br/&gt;
	at org.springframework.security.authentication.dao.AbstractUserDetailsAuthenticationProvider.authenticate(AbstractUserDetailsAuthenticationProvider.java:139)&lt;br/&gt;
	at org.springframework.security.authentication.ProviderManager.doAuthentication(ProviderManager.java:120)&lt;br/&gt;
	at org.springframework.security.authentication.AbstractAuthenticationManager.authenticate(AbstractAuthenticationManager.java:48)&lt;br/&gt;
	at org.springframework.security.web.authentication.UsernamePasswordAuthenticationFilter.attemptAuthentication(UsernamePasswordAuthenticationFilter.java:97)&lt;br/&gt;
	at org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:200)&lt;br/&gt;
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:355)&lt;br/&gt;
	at com.attensa.web.security.ActiveUserFilter.doFilter(ActiveUserFilter.java:106)&lt;br/&gt;
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:355)&lt;br/&gt;
	at com.attensa.web.security.SyncDirectoryUserFilter.doFilter(SyncDirectoryUserFilter.java:65)&lt;br/&gt;
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:355)&lt;br/&gt;
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:105)&lt;br/&gt;
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:355)&lt;br/&gt;
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:79)&lt;br/&gt;
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:355)&lt;br/&gt;
	at com.attensa.web.security.SessionTimeoutFilter.doFilter(SessionTimeoutFilter.java:29)&lt;br/&gt;
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:355)&lt;br/&gt;
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:149)&lt;br/&gt;
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:237)&lt;br/&gt;
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:167)&lt;br/&gt;
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)&lt;br/&gt;
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)&lt;br/&gt;
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233)&lt;br/&gt;
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)&lt;br/&gt;
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:127)&lt;br/&gt;
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)&lt;br/&gt;
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)&lt;br/&gt;
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:298)&lt;br/&gt;
	at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:852)&lt;br/&gt;
	at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:588)&lt;br/&gt;
	at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:489)&lt;br/&gt;
	at java.lang.Thread.run(Thread.java:619)&lt;br/&gt;
Caused by: org.springframework.ldap.UncategorizedLdapException: Uncategorized exception occured during LDAP processing; nested exception is javax.naming.NamingException: [LDAP: error code 1 - 000020D6: SvcErr: DSID-031006CC, problem 5012 (DIR_ERROR), data 0&lt;br/&gt;
remaining name &apos;cn=Pinhead\, Zippy PH/HU,ou=AA,ou=A,ou=Users 135200,dc=dom1,dc=local&apos;&lt;br/&gt;
	at org.springframework.ldap.support.LdapUtils.convertLdapException(LdapUtils.java:215)&lt;br/&gt;
	at com.attensa.core.security.AttensaBindAuthenticator.bindWithDn(AttensaBindAuthenticator.java:130)&lt;br/&gt;
	at com.attensa.core.security.AttensaBindAuthenticator.authenticate(AttensaBindAuthenticator.java:83)&lt;br/&gt;
	at org.springframework.security.ldap.authentication.LdapAuthenticationProvider.authenticate(LdapAuthenticationProvider.java:252)&lt;br/&gt;
	... 34 more&lt;br/&gt;
Caused by: javax.naming.NamingException: [LDAP: error code 1 - 000020D6: SvcErr: DSID-031006CC, problem 5012 (DIR_ERROR), data 0&lt;br/&gt;
remaining name &apos;cn=Pinhead\, Zippy PH/HU,ou=AA,ou=A,ou=Users 135200,dc=dom1,dc=local&apos;&lt;br/&gt;
	at com.sun.jndi.ldap.LdapCtx.mapErrorCode(LdapCtx.java:3081)&lt;br/&gt;
	at com.sun.jndi.ldap.LdapCtx.processReturnCode(LdapCtx.java:2987)&lt;br/&gt;
	at com.sun.jndi.ldap.LdapCtx.processReturnCode(LdapCtx.java:2794)&lt;br/&gt;
	at com.sun.jndi.ldap.LdapCtx.c_lookup(LdapCtx.java:1011)&lt;br/&gt;
	at com.sun.jndi.toolkit.ctx.ComponentContext.c_resolveIntermediate_nns(ComponentContext.java:152)&lt;br/&gt;
	at com.sun.jndi.toolkit.ctx.AtomicContext.c_resolveIntermediate_nns(AtomicContext.java:342)&lt;br/&gt;
	at com.sun.jndi.toolkit.ctx.ComponentContext.p_resolveIntermediate(ComponentContext.java:381)&lt;br/&gt;
	at com.sun.jndi.toolkit.ctx.ComponentDirContext.p_getAttributes(ComponentDirContext.java:205)&lt;br/&gt;
	at com.sun.jndi.toolkit.ctx.PartialCompositeDirContext.getAttributes(PartialCompositeDirContext.java:121)&lt;br/&gt;
	at com.sun.jndi.toolkit.ctx.PartialCompositeDirContext.getAttributes(PartialCompositeDirContext.java:109)&lt;br/&gt;
	at javax.naming.directory.InitialDirContext.getAttributes(InitialDirContext.java:123)&lt;br/&gt;
	at com.attensa.core.security.AttensaBindAuthenticator.bindWithDn(AttensaBindAuthenticator.java:108)&lt;br/&gt;
	... 36 more&lt;/p&gt;

</comment>
                            <comment id="52333" author="jnadler" created="Tue, 23 Mar 2010 04:26:31 +0000"  >&lt;p&gt;There may be another (semi-related) bug as well.  This user was originally getting parse exceptions out of Spring-LDAP&apos;s DistinguishedName class.  Spring Security was passing a DN path that was partially quoted like this:&lt;br/&gt;
    &quot;cn=Pinhead\, Zippy PH/HU,ou=AA,ou=A,ou=Users 135200&quot;,dc=dom1,dc=local&lt;/p&gt;

&lt;p&gt;I patched DistinguishedName to be able to parse an oddly quoted DN like this, but on further investigation the better place to fix this would be in Spring Security.  The JNDI name classes do the quoting, Spring Security should remove them before appending the base.&lt;/p&gt;

&lt;p&gt;Am I making sense?  I can enter a separate Jira for this if you agree.&lt;/p&gt;</comment>
                            <comment id="52463" author="luke" created="Sat, 27 Mar 2010 03:37:50 +0000"  >&lt;p&gt;I think this should be fixed now. The problems were both specific to &quot;/&quot; which is a special character in JNDI names (but not LDAP ones). LDAP escaping of commas etc, should already have been OK, but the &quot;/&quot; can cause problems with lookups and  when it is returned froma search (because CompositeName adds quotes to the name). Spring LDAP&apos;s DistinguishedName deals with this, but only if the quotes are at the ends of the String, and we were prepending the search base to the DN beforehand.&lt;/p&gt;</comment>
                            <comment id="52470" author="jnadler" created="Sat, 27 Mar 2010 07:03:40 +0000"  >&lt;p&gt;You da man.  I&apos;ll grab a snapshot build and test during the upcoming week.  Thanks!&lt;/p&gt;</comment>
                            <comment id="52523" author="ulsa" created="Mon, 29 Mar 2010 20:02:31 +0000"  >&lt;p&gt;Well done guys. I&apos;m just curious about something Jeff said earlier about there being more places than BindAuthenticator where the integration with Spring LDAP should be investigated. Should we create another issue for this, perhaps?&lt;/p&gt;</comment>
                            <comment id="52526" author="luke" created="Mon, 29 Mar 2010 22:26:09 +0000"  >&lt;p&gt;Hi Ulrik. Which places do you mean? Feel free to send me a mail if you have more ideas.&lt;/p&gt;</comment>
                            <comment id="52542" author="jnadler" created="Tue, 30 Mar 2010 03:03:35 +0000"  >&lt;p&gt;We&apos;re running the 3.0.3 snapshot build now and this issue appears to be completely resolved.  Thanks for all the help guys.&lt;/p&gt;

&lt;p&gt;Ulrik to be clear I think Luke has nailed it.  There were two issues, handling the slash-related quoting &apos;inbound&apos; and escaping the slash &apos;outbound&apos;.   When I had fixed this myself I did the &apos;inbound&apos; part by hacking a fix into Spring LDAP so that it&apos;s DistinguishedName could parse improperly quoted DNs.  That wasn&apos;t the proper way to do it of course.&lt;/p&gt;

&lt;p&gt;Nothing more to see here.  Thanks again all.&lt;/p&gt;
</comment>
                            <comment id="52573" author="luke" created="Wed, 31 Mar 2010 02:45:39 +0000"  >&lt;p&gt;Thanks for the feedback, Jeff.&lt;/p&gt;</comment>
                            <comment id="52837" author="sryll" created="Fri, 9 Apr 2010 01:07:05 +0000"  >&lt;p&gt;Are there any chances that this bug fix will be backported to the 2.0.x series? I&apos;m currently tinkering with this problem in a project where we have Spring 2.5.6 with Spring Security 2.0.4 integrated. We didn&apos;t take the migration hurdle to the 3.x series yet, so I&apos;d find it very helpful if this could be fixed in a 2.0.6 release as well. &lt;/p&gt;

&lt;p&gt;Thanks for the good work!&lt;/p&gt;</comment>
                            <comment id="52838" author="luke" created="Fri, 9 Apr 2010 01:40:40 +0000"  >&lt;p&gt;Hi Steffen. The 2.0.x series is unlikely to see any further releases apart from critical bugfixes now that 3.0 has been released. You can of course apply the patch yourself, or you can get in touch with SpringSource about a commercial support package which might include custom fixes to older versions.&lt;/p&gt;</comment>
                            <comment id="52880" author="sryll" created="Mon, 12 Apr 2010 03:35:35 +0000"  >&lt;p&gt;Luke, thanks for the quick response. Luckily, it was not that difficult to back-port that patch to 2.0.5. I just don&apos;t like running on non-released libraries, hence my question. Now that I have this patch for 2.0.5: Would you nevertheless be interested to give the patch to the public, for all those who care? Attaching it to this ticket would be the easiest, I suppose?!&lt;/p&gt;</comment>
                            <comment id="52881" author="luke" created="Mon, 12 Apr 2010 03:40:33 +0000"  >&lt;p&gt;Sure. If you an attach a minimal patch against the current git 2.0.x branch I will apply it.&lt;/p&gt;</comment>
                            <comment id="52907" author="sryll" created="Tue, 13 Apr 2010 02:14:15 +0000"  >&lt;p&gt;Here you go. I had to wrestle with git for a while, but I with good old diff I managed it. The patch is basically equivalent to your patch in 3.x, except that I couldn&apos;t prevent my Eclipse from shuffling around  the imports. Hope that&apos;s ok with you. Thanks again for solving this issue!&lt;/p&gt;</comment>
                            <comment id="53024" author="luke" created="Fri, 16 Apr 2010 01:17:23 +0000"  >&lt;p&gt;Ok, thanks. I&apos;ve applied the patch.&lt;/p&gt;</comment>
                            <comment id="71133" author="khitrenovich" created="Mon, 10 Oct 2011 00:32:57 +0000"  >&lt;p&gt;Hi Luke,&lt;/p&gt;

&lt;p&gt;From the conversation above it is not clear whether this fix was released in some 2.0.x version.I did a quick search in the release notes of 2.0.5 and up and did not find anything related. Please clarify...&lt;/p&gt;

&lt;p&gt;Thanks in advance,&lt;br/&gt;
     Anton.&lt;/p&gt;</comment>
                            <comment id="71136" author="luke" created="Mon, 10 Oct 2011 05:23:12 +0000"  >&lt;p&gt;Check the commit log:&lt;/p&gt;

&lt;p&gt;$ git checkout 2.0.x&lt;br/&gt;
$ git log --pretty=oneline | grep &lt;a href=&quot;https://jira.spring.io/browse/SEC-1444&quot; title=&quot;BindAuthentiator Fails for Active Directory DN Containing Special Chars&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SEC-1444&quot;&gt;&lt;del&gt;SEC-1444&lt;/del&gt;&lt;/a&gt;&lt;br/&gt;
d6f6a544556dfd940257ef6d2989494176b7421c &lt;a href=&quot;https://jira.spring.io/browse/SEC-1444&quot; title=&quot;BindAuthentiator Fails for Active Directory DN Containing Special Chars&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SEC-1444&quot;&gt;&lt;del&gt;SEC-1444&lt;/del&gt;&lt;/a&gt;: Backport of changes to 2.0.x&lt;/p&gt;

&lt;p&gt;or the source tab...&lt;/p&gt;</comment>
                            <comment id="71148" author="khitrenovich" created="Mon, 10 Oct 2011 10:06:48 +0000"  >&lt;p&gt;Luke,&lt;/p&gt;

&lt;p&gt;I&apos;m a user of this project, not a developer. &lt;br/&gt;
IMHO, setting up the development environment in order to get answer to this simple question is an overkill.&lt;/p&gt;

&lt;p&gt;Please correct me if I&apos;m wrong...&lt;/p&gt;

&lt;p&gt;Regards,&lt;br/&gt;
     Anton.&lt;/p&gt;</comment>
                            <comment id="71154" author="luke" created="Mon, 10 Oct 2011 13:42:30 +0000"  >&lt;p&gt;Yes, I think you&apos;re wrong &lt;img class=&quot;emoticon&quot; src=&quot;https://jira.spring.io/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;. And I don&apos;t mean that in a bad way. The first thing I do when I have an issue with a third-party project which uses git is clone the source repository. It is a veritable gold mine of information and an essential skill when working with open source.&lt;/p&gt;

&lt;p&gt;Of course if you disagree, there is still the &quot;source&quot; tab &lt;img class=&quot;emoticon&quot; src=&quot;https://jira.spring.io/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="71174" author="khitrenovich" created="Mon, 10 Oct 2011 23:45:51 +0000"  >&lt;p&gt;According to commit history in  2.0.x branch, it should be 2.0.6.RELEASE... Can you please add it to the list of fix versions?&lt;/p&gt;</comment>
                            <comment id="124361" author="issuemaster" created="Sat, 6 Feb 2016 06:14:09 +0000"  >&lt;p&gt;This issue has been migrated to &lt;a href=&quot;https://github.com/spring-projects/spring-security/issues/1685&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/spring-projects/spring-security/issues/1685&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="16423" name="LdapBindFailureWithSlashInName_against_2.0.x.patch" size="13070" author="sryll" created="Tue, 13 Apr 2010 02:14:15 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_10170" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>First Response Date</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 22 Mar 2010 11:01:34 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10280" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>19520</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10880" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i03yb3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10380" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>23100</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10381" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Ranking</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>19617</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_10171" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>