<!-- 
RSS generated by JIRA (6.4.11#64026-sha1:78f6ec473a3f058bd5d6c30e9319c7ab376bdb9c) at Fri Dec 23 11:11:33 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://jira.spring.io/si/jira.issueviews:issue-xml/SEC-2794/SEC-2794.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>Spring JIRA</title>
    <link>https://jira.spring.io</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.4.11</version>
        <build-number>64026</build-number>
        <build-date>25-08-2015</build-date>
    </build-info>

<item>
            <title>[SEC-2794] AbstractPreAuthenticatedProcessingFilter requires authentication check failure</title>
                <link>https://jira.spring.io/browse/SEC-2794</link>
                <project id="10040" key="SEC">Spring Security</project>
                    <description>&lt;p&gt;In the AbstractPreAuthenticatedProcessingFilter.requiresAuthentication(HttpServletRequest request) method which is private, there is the following code:&lt;/p&gt;

&lt;p&gt;        Object principal = getPreAuthenticatedPrincipal(request);&lt;/p&gt;

&lt;p&gt;        if (currentUser.getName().equals(principal)) &lt;/p&gt;
{
            return false;
        }

&lt;p&gt;This assumes that the overriden method of getPreAuthenticatedPrincipal(request) will always return a String, when in fact it could be any object. This needs to change to either:&lt;br/&gt;
		String principal = request.getUserPrincipal().getName();&lt;/p&gt;

&lt;p&gt;		if (currentUser.getName().equals(principal)) &lt;/p&gt;
{
			return false;
		}
&lt;p&gt;or provide an abstract method (or at least a protected/public method) in order to do the comparison - see attachment. My getPreAuthenticatedPrincipal(request) returns a FederationPrincipal, and not a String. The only way to deal with it at the moment is to completely copy the AbstractPreAuthenticatedProcessingFilter, and change the tiny bit of code above.&lt;/p&gt;</description>
                <environment>any</environment>
        <key id="61225">SEC-2794</key>
            <summary>AbstractPreAuthenticatedProcessingFilter requires authentication check failure</summary>
                <type id="1" iconUrl="https://jira.spring.io/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="4" iconUrl="https://jira.spring.io/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://jira.spring.io/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="3">Duplicate</resolution>
                                        <assignee username="rwinch">Rob Winch</assignee>
                                    <reporter username="kathryn.spinks">Kathryn Spinks</reporter>
                        <labels>
                    </labels>
                <created>Tue, 16 Dec 2014 02:47:18 +0000</created>
                <updated>Sat, 6 Feb 2016 06:42:37 +0000</updated>
                            <resolved>Tue, 16 Dec 2014 07:44:33 +0000</resolved>
                                    <version>4.0.0.RC1</version>
                                                    <component>Web</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                <comments>
                            <comment id="110706" author="rwinch" created="Tue, 16 Dec 2014 07:44:33 +0000"  >&lt;p&gt;Thanks for the report. This appears to duplicate &lt;a href=&quot;https://jira.spring.io/browse/SEC-2078&quot; title=&quot;Pre-authentication fails when using check for principal change and using non String principals&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SEC-2078&quot;&gt;&lt;del&gt;SEC-2078&lt;/del&gt;&lt;/a&gt; in which I am waiting feedback from the original user. Please comment there if my proposal will work for you.&lt;/p&gt;</comment>
                            <comment id="117881" author="kathryn.spinks" created="Wed, 22 Jul 2015 05:39:02 +0000"  >&lt;p&gt;Hi Rob, I&apos;ve just picked up the 4.0.1.RELEASE to check the change but the principalChanged(HttpServletRequest request, Authentication currentAuthentication) method that you indicated that you were going to add in SEC 2078 appears to be missing, but some changes to requiresAuthentication(...) that you mention have been included. This doesn&apos;t help me as the PreAuthenticatedPrincipal will never be the same as currentUser.getPrincipal() as currentUser.getPrincipal() returns an instance of UserDetails.&lt;/p&gt;

&lt;p&gt;Is this is as expected or is it an oversight?&lt;br/&gt;
Thanks.&lt;/p&gt;
</comment>
                            <comment id="117891" author="rwinch" created="Wed, 22 Jul 2015 07:17:44 +0000"  >&lt;p&gt;Thanks for pointing this out! You are correct the method was never added (only the other changes). This was a mistake on my part.&lt;/p&gt;

&lt;p&gt;I created &lt;a href=&quot;https://jira.spring.io/browse/SEC-3051&quot; title=&quot;Add AbstractPreAuthenticatedProcessingFilter principalChanged(HttpServletRequest, Authentication)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SEC-3051&quot;&gt;&lt;del&gt;SEC-3051&lt;/del&gt;&lt;/a&gt; and resolved it. You can see it is now fixed in &lt;a href=&quot;https://github.com/spring-projects/spring-security/commit/92ae45a04d0d35d2b4d6b414c6f3c7d42ab5a3db&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;master&lt;/a&gt; and &lt;a href=&quot;https://github.com/spring-projects/spring-security/commit/12ed990aa289caa1b902b2d7d4b47e4332603bc7&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;3.2.x&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Please give the latest snapshots a try. I expect a release out by the end of the week.&lt;/p&gt;</comment>
                            <comment id="125823" author="issuemaster" created="Sat, 6 Feb 2016 06:27:07 +0000"  >&lt;p&gt;This issue has been migrated to &lt;a href=&quot;https://github.com/spring-projects/spring-security/issues/3017&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/spring-projects/spring-security/issues/3017&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10000">
                    <name>Duplicate</name>
                                            <outwardlinks description="duplicates">
                                        <issuelink>
            <issuekey id="46051">SEC-2078</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="22431" name="AbstractPreAuthenticatedProcessingFilter.java" size="12484" author="kathryn.spinks" created="Tue, 16 Dec 2014 02:47:19 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_10170" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>First Response Date</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 16 Dec 2014 07:44:33 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10280" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>47298</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10880" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0826v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10380" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>47059</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10381" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Ranking</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>47000</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_10171" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>