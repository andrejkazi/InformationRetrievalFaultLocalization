<!-- 
RSS generated by JIRA (6.4.11#64026-sha1:78f6ec473a3f058bd5d6c30e9319c7ab376bdb9c) at Fri Dec 23 10:01:17 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://jira.spring.io/si/jira.issueviews:issue-xml/SEC-953/SEC-953.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>Spring JIRA</title>
    <link>https://jira.spring.io</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.4.11</version>
        <build-number>64026</build-number>
        <build-date>25-08-2015</build-date>
    </build-info>

<item>
            <title>[SEC-953] Query string isn&apos;t ignored while url - filterchain pattern matching</title>
                <link>https://jira.spring.io/browse/SEC-953</link>
                <project id="10040" key="SEC">Spring Security</project>
                    <description>&lt;p&gt;While upgrading from Acegi Security 1.0.7 to Spring Security 2.0.2 I noticed that url matching doesn&apos;t work as it was before.&lt;br/&gt;
In Acegi I used the following url - filter chaing mapping:&lt;/p&gt;

&lt;p&gt;&amp;lt;bean id=&quot;filterChainProxy&quot; class=&quot;org.acegisecurity.util.FilterChainProxy&quot;&amp;gt;&lt;br/&gt;
    &amp;lt;property name=&quot;filterInvocationDefinitionSource&quot;&amp;gt;&lt;br/&gt;
	&amp;lt;value&amp;gt;&lt;br/&gt;
	     CONVERT_URL_TO_LOWERCASE_BEFORE_COMPARISON &lt;br/&gt;
	     PATTERN_TYPE_APACHE_ANT&lt;br/&gt;
                  j_acegi_security_check=httpSessionContextIntegrationFilter,....................			&lt;br/&gt;
	    j_acegi_logout=httpSessionContextIntegrationFilter,.......................&lt;br/&gt;
                 /*&lt;b&gt;/&lt;/b&gt;.htm=httpSessionContextIntegrationFilter,.....................&lt;br/&gt;
            &amp;lt;/value&amp;gt;&lt;br/&gt;
  &amp;lt;/property&amp;gt;&lt;br/&gt;
&amp;lt;/bean&amp;gt;&lt;/p&gt;

&lt;p&gt;I Spring Security the same mapping looks as follows:&lt;/p&gt;

&lt;p&gt;&amp;lt;bean id=&quot;filterChainProxy&quot; class=&quot;org.springframework.security.util.FilterChainProxy&quot;&amp;gt;&lt;br/&gt;
    &amp;lt;security:filter-chain-map path-type=&quot;ant&quot;&amp;gt;&lt;br/&gt;
            &amp;lt;security:filter-chain pattern=&quot;/j_spring_security_check&quot; filters=&quot;httpSessionContextIntegrationFilter, ...............&quot; /&amp;gt;&lt;br/&gt;
	&amp;lt;security:filter-chain pattern=&quot;/j_spring_security_logout&quot; filters=&quot;httpSessionContextIntegrationFilter,.....&quot; /&amp;gt;&lt;br/&gt;
	&amp;lt;security:filter-chain pattern=&quot;/*&lt;b&gt;/&lt;/b&gt;.htm&quot; filters=&quot;httpSessionContextIntegrationFilter,.....&quot; /&amp;gt;			&lt;br/&gt;
    &amp;lt;/security:filter-chain-map&amp;gt;	&lt;br/&gt;
&amp;lt;/bean&amp;gt;&lt;/p&gt;

&lt;p&gt;But  I received NullPointerException while performing some requests.  It appears because these requests bypass filterchain and Security Context isn&apos;t integrated into a session. Such situation occurs for requests which includes parameters in url.&lt;br/&gt;
For instance, request url &apos;page1.htm&apos; matches to pattern &apos;/*&lt;b&gt;/&lt;/b&gt;.htm&apos; but url &apos;page1.htm?param=value&apos; doesn&apos;t. &lt;/p&gt;

&lt;p&gt;It caused by changes in url - filterchain pattern matching. In Acegi PathBasedFilterInvocationDefinitionMap ignores query string (any symbols after first &apos;?&apos;) but in Spring FilterChainProxy provides full requests url to matcher (in this case AntUrlPathMatcher) :&lt;/p&gt;

&lt;p&gt;public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain)&lt;br/&gt;
            throws IOException, ServletException &lt;/p&gt;
{

        FilterInvocation fi = new FilterInvocation(request, response, chain);
        List filters = getFilters(fi.getRequestUrl());
       .................

}

&lt;p&gt;public List getFilters(String url)  {&lt;br/&gt;
      Iterator filterChains = filterChainMap.entrySet().iterator();&lt;/p&gt;

&lt;p&gt;        while (filterChains.hasNext()) {&lt;br/&gt;
            Map.Entry entry = (Map.Entry) filterChains.next();&lt;br/&gt;
            Object path = entry.getKey();&lt;/p&gt;

&lt;p&gt;            if (matcher.requiresLowerCaseUrl()) {&lt;br/&gt;
                url = url.toLowerCase();&lt;/p&gt;

&lt;p&gt;                if (logger.isDebugEnabled()) &lt;/p&gt;
{
                    logger.debug(&quot;Converted URL to lowercase, from: &apos;&quot; + url + &quot;&apos;; to: &apos;&quot; + url + &quot;&apos;&quot;);
                }
&lt;p&gt;            }&lt;/p&gt;

&lt;p&gt;            boolean matched = matcher.pathMatchesUrl(path, url);&lt;br/&gt;
             ......&lt;br/&gt;
}&lt;/p&gt;

&lt;p&gt;To keep backward compatibility I offer to change doFilter() implementation to pass request url without query string into getFilters() method.&lt;/p&gt;



</description>
                <environment></environment>
        <key id="23568">SEC-953</key>
            <summary>Query string isn&apos;t ignored while url - filterchain pattern matching</summary>
                <type id="1" iconUrl="https://jira.spring.io/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://jira.spring.io/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://jira.spring.io/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="luke">Luke Taylor</assignee>
                                    <reporter username="myron">Myron Chelyada</reporter>
                        <labels>
                    </labels>
                <created>Mon, 11 Aug 2008 04:14:13 +0000</created>
                <updated>Sat, 6 Feb 2016 06:38:26 +0000</updated>
                            <resolved>Mon, 11 Aug 2008 06:23:51 +0000</resolved>
                                    <version>2.0.2</version>
                                    <fixVersion>2.0.4</fixVersion>
                                    <component>Core</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="38825" author="luke" created="Mon, 11 Aug 2008 06:23:51 +0000"  >&lt;p&gt;I&apos;ve added a stripQueryStringFromUrls property to FilterChainProxy which functions in the same way as the one on DefaultFilterInvocationDefintionSource. This defaults to &apos;true&apos; so the query string will be removed by default. If regular expression matching is in use with the namespace, it will be set to false.&lt;/p&gt;

&lt;p&gt;Users who are configuring their own FilterChainProxy explicitly and do not want the default behaviour will have to set the property to false in their configration.&lt;/p&gt;</comment>
                            <comment id="41725" author="robwinch" created="Wed, 17 Dec 2008 05:36:55 +0000"  >&lt;p&gt;I&apos;m not sure if it is too late to comment on this since this is a passivity concern and the release has already been done, but here it is anyways...&lt;/p&gt;

&lt;p&gt;While this change matches acegi security&apos;s implementation, it is not passive to the previous version spring security. Since there was not a major release I would expect it to be passive. Why wouldn&apos;t stripQueryStringFromUrls default to false?&lt;/p&gt;</comment>
                            <comment id="126978" author="issuemaster" created="Sat, 6 Feb 2016 06:38:26 +0000"  >&lt;p&gt;This issue has been migrated to &lt;a href=&quot;https://github.com/spring-projects/spring-security/issues/1201&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/spring-projects/spring-security/issues/1201&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="14532" name="mylyn-context.zip" size="2323" author="luke" created="Mon, 11 Aug 2008 06:11:34 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_10170" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>First Response Date</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 11 Aug 2008 06:23:51 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10280" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>19940</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10880" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i03zhz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10380" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>23293</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10381" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Ranking</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>19779</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_10171" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>