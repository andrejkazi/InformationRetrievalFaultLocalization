<!-- 
RSS generated by JIRA (6.4.11#64026-sha1:78f6ec473a3f058bd5d6c30e9319c7ab376bdb9c) at Fri Dec 23 10:50:04 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://jira.spring.io/si/jira.issueviews:issue-xml/SEC-973/SEC-973.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>Spring JIRA</title>
    <link>https://jira.spring.io</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.4.11</version>
        <build-number>64026</build-number>
        <build-date>25-08-2015</build-date>
    </build-info>

<item>
            <title>[SEC-973] OpenIDAuthenticationProcessingFilter assumes https uses port 80</title>
                <link>https://jira.spring.io/browse/SEC-973</link>
                <project id="10040" key="SEC">Spring Security</project>
                    <description>&lt;p&gt;OpenIDAuthenticationProcessingFilter when parsing the returnToUrl assumes port 80 even https is used.  There should be some logic to utilize port 443, the default port for https if url.getPort equals -1.&lt;/p&gt;

&lt;p&gt;if (mapping == null) {&lt;br/&gt;
            try {&lt;/p&gt;

&lt;p&gt;                URL url = new URL(returnToUrl);&lt;br/&gt;
                int port = (url.getPort() == -1) ? 80 : url.getPort();&lt;/p&gt;

&lt;p&gt;Workaround is to utilize realmMapping property to make a hard map between returnToUrl and the existing returnToUrl bypassing the flawed logic.  i.e.,&lt;/p&gt;

&lt;p&gt;&amp;lt;b:bean id=&quot;openIdFilter&quot; class=&quot;org.springframework.security.ui.openid.OpenIDAuthenticationProcessingFilter&quot;&amp;gt;&lt;br/&gt;
        &amp;lt;custom-filter position=&quot;AUTHENTICATION_PROCESSING_FILTER&quot;/&amp;gt;&lt;br/&gt;
        &amp;lt;b:property name=&quot;authenticationManager&quot; ref=&quot;authenticationManager&quot;/&amp;gt;&lt;br/&gt;
        &amp;lt;b:property name=&quot;defaultTargetUrl&quot; value=&quot;/index.jsp&quot;/&amp;gt;&lt;br/&gt;
        &amp;lt;b:property name=&quot;authenticationFailureUrl&quot; value=&quot;/openidlogin.jsp?login_error=true&quot;/&amp;gt;&lt;br/&gt;
        &amp;lt;!-- the realmMapping property allows mapping through apache&apos;s mod proxy --&amp;gt;&lt;br/&gt;
        &amp;lt;b:property name=&quot;realmMapping&quot;&amp;gt;&lt;br/&gt;
            &amp;lt;b:map&amp;gt;&lt;br/&gt;
                &amp;lt;b:entry key=&quot;https://sitename/j_spring_openid_security_check&quot;&lt;br/&gt;
                         value=&quot;https://sitename/j_spring_openid_security_check&quot;/&amp;gt;&lt;br/&gt;
            &amp;lt;/b:map&amp;gt;&lt;br/&gt;
        &amp;lt;/b:property&amp;gt;&lt;br/&gt;
    &amp;lt;/b:bean&amp;gt;&lt;/p&gt;

&lt;p&gt;I also found that putting a debug statement in helped doing the realmMapping i.e.&lt;/p&gt;

&lt;p&gt;protected String lookupRealm(String returnToUrl) {&lt;/p&gt;

&lt;p&gt;        String mapping = (String) realmMapping.get(returnToUrl);&lt;/p&gt;

&lt;p&gt;        log.debug(&quot;returnToUrl value = &quot; + returnToUrl);&lt;/p&gt;</description>
                <environment>mac, linux</environment>
        <key id="23915">SEC-973</key>
            <summary>OpenIDAuthenticationProcessingFilter assumes https uses port 80</summary>
                <type id="1" iconUrl="https://jira.spring.io/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://jira.spring.io/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://jira.spring.io/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="luke">Luke Taylor</assignee>
                                    <reporter username="espinoj">Jeremy Espino</reporter>
                        <labels>
                    </labels>
                <created>Mon, 8 Sep 2008 06:59:08 +0000</created>
                <updated>Sat, 6 Feb 2016 06:38:39 +0000</updated>
                            <resolved>Sun, 30 Aug 2009 21:43:11 +0000</resolved>
                                    <version>2.0.2</version>
                    <version>2.0.3</version>
                                    <fixVersion>3.0.0 RC1</fixVersion>
                                    <component>OpenID</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>2</watches>
                                                                <comments>
                            <comment id="46378" author="luke" created="Thu, 27 Aug 2009 06:41:55 +0000"  >&lt;p&gt;I&apos;m not really sure why it was appending the port at all in the case where url.getPort() was -1. If the port is standard then it doesn&apos;t need to be added to the URL whether it&apos;s using http or https. I&apos;ve modified the code to only add the port if the getPort() method returns a value &amp;gt; 0.&lt;/p&gt;</comment>
                            <comment id="126999" author="issuemaster" created="Sat, 6 Feb 2016 06:38:39 +0000"  >&lt;p&gt;This issue has been migrated to &lt;a href=&quot;https://github.com/spring-projects/spring-security/issues/1225&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/spring-projects/spring-security/issues/1225&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_10170" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>First Response Date</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 27 Aug 2009 06:41:55 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10280" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>19923</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10880" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i03zfb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10380" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>23281</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10381" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Ranking</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>19767</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_10171" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>