<!-- 
RSS generated by JIRA (6.4.11#64026-sha1:78f6ec473a3f058bd5d6c30e9319c7ab376bdb9c) at Fri Dec 23 11:40:19 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://jira.spring.io/si/jira.issueviews:issue-xml/SEC-134/SEC-134.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>Spring JIRA</title>
    <link>https://jira.spring.io</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.4.11</version>
        <build-number>64026</build-number>
        <build-date>25-08-2015</build-date>
    </build-info>

<item>
            <title>[SEC-134] Authentication.getAuthorities should return a collection rather than an array.</title>
                <link>https://jira.spring.io/browse/SEC-134</link>
                <project id="10040" key="SEC">Spring Security</project>
                    <description>&lt;p&gt;Currently Authentication.getAuthorities returns a GrantedAuthority[]. This is dangerous because calling code can accidentaly or deliberatly modify elements of the array to anything.&lt;/p&gt;

&lt;p&gt;This method should really return an unmodifiable collection. Alternatly class instances could return a clone of the array.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13069">SEC-134</key>
            <summary>Authentication.getAuthorities should return a collection rather than an array.</summary>
                <type id="1" iconUrl="https://jira.spring.io/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://jira.spring.io/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://jira.spring.io/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="luke">Luke Taylor</assignee>
                                    <reporter username="swamp_ig">Chris Wood</reporter>
                        <labels>
                    </labels>
                <created>Tue, 27 Dec 2005 16:12:07 +0000</created>
                <updated>Sat, 6 Feb 2016 06:13:04 +0000</updated>
                            <resolved>Tue, 7 Feb 2006 12:36:05 +0000</resolved>
                                    <version>0.8.2</version>
                    <version>0.8.3</version>
                    <version>0.9.0</version>
                    <version>1.0.0 RC1</version>
                                    <fixVersion>1.0.0 RC2</fixVersion>
                                    <component>Core</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="16166" author="balex" created="Wed, 25 Jan 2006 20:13:47 +0000"  >&lt;p&gt;Luke, as per our Skype discussion re the preferred strategy, please ensure we modify the JavaDocs for both Authentication.getAuthorities() and GrantedAuthority interface to reflect that these should be immutable.&lt;/p&gt;</comment>
                            <comment id="16251" author="swamp_ig" created="Sun, 29 Jan 2006 10:41:56 +0000"  >&lt;p&gt;The problem with this approach is that it&apos;s not secure against malicious code and as such is a dangerous flaw in somthing which is supposed to be a secure system. &lt;/p&gt;

&lt;p&gt;With a unmodifiable collection it&apos;s pretty simple to disable any ability to modify the data by setting the ReflectPermission(&quot;suppressAccessChecks&quot;) in the security manager for the potentialy untrusted code. For sensitive systems setting this security level this is done as a matter of course, so you&apos;d get this level of security for free. &lt;/p&gt;

&lt;p&gt;If you need to keep the array based implementation for compatibility reasons it should be marked as deprecated and measures to ensure the array isn&apos;t modified should be taken. The easiest way to prevent modification would be just to use toArray on the collection and return the output. Since it&apos;s just a simple array copy the performance overhead isn&apos;t that great.&lt;/p&gt;

&lt;p&gt;I urge you to reconsider this decision, since once the interface reaches 1.0 it&apos;s harder to change, and I&apos;d be very reluctant to use the system in a sensitive environment without fixing the problem.&lt;/p&gt;

&lt;p&gt;I know there&apos;s a large number of places in the code that call this method, I&apos;ll volenteer to create and submit a patch to fix them if you will accept it.&lt;/p&gt;</comment>
                            <comment id="16254" author="luke" created="Sun, 29 Jan 2006 22:59:47 +0000"  >&lt;p&gt;Chris,&lt;/p&gt;

&lt;p&gt;I wasn&apos;t aware that there was a decision to reconsider &lt;img class=&quot;emoticon&quot; src=&quot;https://jira.spring.io/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;. We are planning on copying the array at the moment. I&apos;ve been aware for a while that this should probably be done for those who need to run under a security manager, though in my experience this isn&apos;t done &quot;as a matter of course&quot;, even when it probably should be &lt;img class=&quot;emoticon&quot; src=&quot;https://jira.spring.io/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;.&lt;/p&gt;

&lt;p&gt;Copying the array should be adequate provided the authority implementations themselves are immmutable (hence Ben&apos;s comment above). The current implementation classes can also probably be refactored to move the array (and the getAuthorities method) into the base class to reduce duplication, which I&apos;m still looking at.&lt;/p&gt;

&lt;p&gt;I&apos;m not sure about changing the interface to use a Collection, though it would probably be more efficient. We&apos;ll definately have more of a discussion on it. This should probably be a general decision for the project - to use arrays or collections (or generics?). In any case, you can be certain that it won&apos;t be possible to modify the authorities stored in the authentication object in future releases.&lt;/p&gt;</comment>
                            <comment id="16263" author="swamp_ig" created="Mon, 30 Jan 2006 10:14:20 +0000"  >&lt;p&gt;Ahh that&apos;ll fix it then. I was under the impression you were going to fix the array issue by just commenting the method to say the array should not be modified by the users, rather than the Authorities. If you clone the array it&apos;s all good, although it does put some load on the garbage collector, but not that much since the arrays just end up in short term storage and almost certainly won&apos;t have reference cycles.&lt;/p&gt;</comment>
                            <comment id="16348" author="luke" created="Tue, 7 Feb 2006 12:36:05 +0000"  >&lt;p&gt;Changes are in CVS. The array is now copied and it has been moved to the base class.&lt;/p&gt;</comment>
                            <comment id="124248" author="issuemaster" created="Sat, 6 Feb 2016 06:13:04 +0000"  >&lt;p&gt;This issue has been migrated to &lt;a href=&quot;https://github.com/spring-projects/spring-security/issues/395&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/spring-projects/spring-security/issues/395&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_10170" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>First Response Date</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 25 Jan 2006 20:13:47 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10280" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>20692</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10880" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i04miv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10380" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>27023</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10381" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Ranking</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>21672</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_10171" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>