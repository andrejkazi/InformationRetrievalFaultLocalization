<!-- 
RSS generated by JIRA (6.4.11#64026-sha1:78f6ec473a3f058bd5d6c30e9319c7ab376bdb9c) at Fri Dec 23 11:36:34 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://jira.spring.io/si/jira.issueviews:issue-xml/SEC-222/SEC-222.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>Spring JIRA</title>
    <link>https://jira.spring.io</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.4.11</version>
        <build-number>64026</build-number>
        <build-date>25-08-2015</build-date>
    </build-info>

<item>
            <title>[SEC-222] AbstractAuthenticationToken Hashcode computation</title>
                <link>https://jira.spring.io/browse/SEC-222</link>
                <project id="10040" key="SEC">Spring Security</project>
                    <description>&lt;p&gt;The hashCode implementations in User as well as AbstractAuthenticationToken uses the MOD operator with the value 7. &lt;/p&gt;

&lt;p&gt;    public int hashCode() {&lt;br/&gt;
        int code = 2305;&lt;/p&gt;

&lt;p&gt;        if (this.getAuthorities() != null) {&lt;br/&gt;
            for (int i = 0; i &amp;lt; this.getAuthorities().length; i++) &lt;/p&gt;
{
                code = code * (this.getAuthorities()[i].hashCode() % 7);
            }
&lt;p&gt;        }&lt;br/&gt;
        ...&lt;/p&gt;

&lt;p&gt;This has the unfortunate result that when the hashCode of say a GrantedAuthority is dividable by 7, the result of the MOD will be zero. Since it multiplies all other results with itself, the hashCode will evaluate to zero.&lt;/p&gt;

&lt;p&gt;I&apos;m not sure of the consequences of this, but since HttpSessionContextIntegrationFilter compares the hashCode of the SecurityContext before and after the filter chain, this could cause some unexpected behaviour.&lt;/p&gt;

&lt;p&gt;The obvious question is how often a hashCode of a String evaluates to something dividable by 7. Well, it&apos;s actually pretty common. An empty password in the principal does, for example. So does &quot;ROLE_General.ITS&quot; and many others.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13523">SEC-222</key>
            <summary>AbstractAuthenticationToken Hashcode computation</summary>
                <type id="1" iconUrl="https://jira.spring.io/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="2" iconUrl="https://jira.spring.io/images/icons/priorities/critical.png">Critical</priority>
                        <status id="6" iconUrl="https://jira.spring.io/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="balex">Ben Alex</assignee>
                                    <reporter username="ulsa">Ulrik Sandberg</reporter>
                        <labels>
                    </labels>
                <created>Mon, 13 Mar 2006 17:45:24 +0000</created>
                <updated>Sat, 6 Feb 2016 06:21:58 +0000</updated>
                            <resolved>Tue, 25 Apr 2006 12:21:07 +0000</resolved>
                                    <version>0.8.2</version>
                    <version>0.8.3</version>
                    <version>0.9.0</version>
                    <version>1.0.0 RC1</version>
                    <version>1.0.0 RC2</version>
                                    <fixVersion>1.0.0</fixVersion>
                                    <component>Core</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                <comments>
                            <comment id="16795" author="ulsa" created="Mon, 13 Mar 2006 18:21:53 +0000"  >&lt;p&gt;The hashCode of &quot;an empty password in the principal&quot; is of course not dividable by 7, but evaluates to zero directly.&lt;/p&gt;</comment>
                            <comment id="17289" author="balex" created="Sun, 23 Apr 2006 17:07:14 +0000"  >&lt;p&gt;Extra email from Ulrik:&lt;/p&gt;

&lt;p&gt;The two major faults with the current implementations are:&lt;/p&gt;

&lt;p&gt;1. x MOD 7 results in zero for roughly one out of seven values of x. If that operation occurs in many places during the calculation, the probability increases. &lt;/p&gt;

&lt;p&gt;Proposed solution: Increasing 7 to a large number will decrease the probability considerably.&lt;/p&gt;

&lt;p&gt;2. Multiplying &apos;code&apos; with the result of the MOD operation without checking for zero. If &apos;code&apos; has been set to zero once, it will stay zero for the rest of the calculation. &lt;/p&gt;

&lt;p&gt;Proposed solution: Either check for zero before multiplying, or perhaps add rather than multiply, will result in a more robust implementation.&lt;/p&gt;</comment>
                            <comment id="17290" author="balex" created="Sun, 23 Apr 2006 17:08:07 +0000"  >&lt;p&gt;Must be fixed in 1.0.0 final.&lt;/p&gt;</comment>
                            <comment id="17334" author="asenft" created="Tue, 25 Apr 2006 00:11:50 +0000"  >
&lt;p&gt;I suggest to use XOR instead of multiplication or addition as it tends to yield a better distribution of hash values. Besides that, using zero in XOR causes no nasty effects as in multiplication. Additional modulo operation is then not necessary, I think.&lt;/p&gt;

&lt;p&gt;Example with additional prime number multiplication:&lt;br/&gt;
code ^= 31 * this.getAuthorities()&lt;span class=&quot;error&quot;&gt;&amp;#91;i&amp;#93;&lt;/span&gt;.hashCode();&lt;/p&gt;

&lt;p&gt;Regards,&lt;br/&gt;
Andreas&lt;/p&gt;</comment>
                            <comment id="17341" author="balex" created="Tue, 25 Apr 2006 12:21:07 +0000"  >&lt;p&gt;XOR approach used. Change checked into SVN.&lt;/p&gt;</comment>
                            <comment id="125206" author="issuemaster" created="Sat, 6 Feb 2016 06:21:58 +0000"  >&lt;p&gt;This issue has been migrated to &lt;a href=&quot;https://github.com/spring-projects/spring-security/issues/486&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/spring-projects/spring-security/issues/486&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_10170" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>First Response Date</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Sun, 23 Apr 2006 17:07:14 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10280" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>20608</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10880" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i021vr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10380" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>12014</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10381" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Ranking</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>11900</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_10171" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>