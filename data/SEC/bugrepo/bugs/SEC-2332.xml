<!-- 
RSS generated by JIRA (6.4.11#64026-sha1:78f6ec473a3f058bd5d6c30e9319c7ab376bdb9c) at Fri Dec 23 09:54:29 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://jira.spring.io/si/jira.issueviews:issue-xml/SEC-2332/SEC-2332.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>Spring JIRA</title>
    <link>https://jira.spring.io</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.4.11</version>
        <build-number>64026</build-number>
        <build-date>25-08-2015</build-date>
    </build-info>

<item>
            <title>[SEC-2332] GlobalMethodSecurityConfiguration does not configure the proper voters</title>
                <link>https://jira.spring.io/browse/SEC-2332</link>
                <project id="10040" key="SEC">Spring Security</project>
                    <description>&lt;p&gt;I could be missing something obvious here, and if so, please forgive me and skip to the bottom of this description. &lt;tt&gt;GlobalMethodSecurityConfiguration#accessDecisionManager()&lt;/tt&gt; doesn&apos;t seem quite right to me:&lt;/p&gt;

&lt;p&gt;First, it always configures a &lt;tt&gt;PreInvocationAuthorizationAdviceVoter&lt;/tt&gt;, but if pre-post annotations aren&apos;t enabled this voter will never be used, so it seems like omitting it in this case would be preferable.&lt;/p&gt;

&lt;p&gt;Second, it never adds a &lt;tt&gt;Jsr250Voter&lt;/tt&gt;, even if JSR 250 annotations are enabled. How can JSR 250 annotations work without the proper voter?&lt;/p&gt;

&lt;p&gt;It also never adds a &lt;tt&gt;WebExpressionVoter&lt;/tt&gt;, &lt;tt&gt;AclEntryVoter&lt;/tt&gt;, or &lt;tt&gt;RoleHierarchyVoter&lt;/tt&gt; for those cases where the configuration supports it.&lt;/p&gt;

&lt;p&gt;I believe it should be adding other voters (but, again, only when necessary) to fully complete the voting system and make it match the configuration.&lt;/p&gt;

&lt;p&gt;&lt;b&gt;Either Way&lt;/b&gt;&lt;br/&gt;
Whether the configured voters need to change or not, it seems to me that &lt;tt&gt;accessDecisionManager()&lt;/tt&gt; isn&apos;t very friendly to being overridden. If someone ONLY wants to change the decision manager implementation but NOT which voters are used, he &lt;em&gt;still&lt;/em&gt; has to re-implement/duplicate the 6 (or more) lines of code that constructs the voters. I think there should be a &lt;tt&gt;protected List&amp;lt;AccessDecisionVoter&amp;gt; accessDecisionVoters()&lt;/tt&gt; method that handles this process and is called from &lt;tt&gt;accessDecisionManager()&lt;/tt&gt; when constructing the manager.&lt;/p&gt;</description>
                <environment></environment>
        <key id="50951">SEC-2332</key>
            <summary>GlobalMethodSecurityConfiguration does not configure the proper voters</summary>
                <type id="1" iconUrl="https://jira.spring.io/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://jira.spring.io/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://jira.spring.io/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="8">Complete</resolution>
                                        <assignee username="rwinch">Rob Winch</assignee>
                                    <reporter username="guitarking117">Nick Williams</reporter>
                        <labels>
                    </labels>
                <created>Tue, 17 Sep 2013 23:38:22 +0000</created>
                <updated>Sat, 6 Feb 2016 06:22:55 +0000</updated>
                            <resolved>Wed, 18 Sep 2013 16:28:38 +0000</resolved>
                                                    <fixVersion>3.2.0.RC2</fixVersion>
                                    <component>Java Config</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                <comments>
                            <comment id="93682" author="rwinch" created="Wed, 18 Sep 2013 16:27:20 +0000"  >&lt;blockquote&gt;&lt;p&gt;First, it always configures a PreInvocationAuthorizationAdviceVoter, but if pre-post annotations aren&apos;t enabled this voter will never be used&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;You are correct. This has been fixed.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Second, it never adds a Jsr250Voter, even if JSR 250 annotations are enabled.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;You are correct. This got past the tests because there was only a test for verifying if `@DenyAll` worked (it did because all the voters abstained). I have updated the code to fix this and added an assertion that `@PermitAll` works properly.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;It also never adds a WebExpressionVoter&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;The HttpServletRequest is not available on method invocations so this does not make sense. &lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;..., AclEntryVoter&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;AclEntryVoter would be used by your PermissionEvaluator (i.e. AclPermissionEvaluator) so it doesn&apos;t make sense to include this as a voter.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;, or RoleHierarchyVoter&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;RoleHierarchyVoter is not added with the namespace either.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Whether the configured voters need to change or not, it seems to me that accessDecisionManager() isn&apos;t very friendly to being overridden&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I&apos;m not very keen on adding another method as this starts to make GlobalMethodSecurityConfiguration too granular. There is a very easy way to do this by overriding the accessDecisionManager method already. Yes it does involve some code, but at this time this sort of customizations are relatively rare. I&apos;d prefer not to make GlobalMethodSecurityConfiguration too complex. If you really disagree, feel free to create an enhancement request and we will see how much traction it gets. At that point I can re-evaluate the request.&lt;/p&gt;</comment>
                            <comment id="93683" author="guitarking117" created="Wed, 18 Sep 2013 16:55:26 +0000"  >&lt;blockquote&gt;&lt;p&gt;The HttpServletRequest is not available on method invocations so this does not make sense.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Duh. What was I thinking? &lt;img class=&quot;emoticon&quot; src=&quot;https://jira.spring.io/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;AclEntryVoter would be used by your PermissionEvaluator (i.e. AclPermissionEvaluator) so it doesn&apos;t make sense to include this as a voter.&lt;br/&gt;
...&lt;br/&gt;
RoleHierarchyVoter is not added with the namespace either.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I&apos;m a little confused about these two. First, &lt;tt&gt;AclPermissionEvaluator&lt;/tt&gt; does not have any way to configure a voter, so &lt;tt&gt;AclEntryVoter&lt;/tt&gt; could not be &quot;used by&quot; it. In the Javadoc for &lt;tt&gt;AclPermissionEvaluator&lt;/tt&gt;, the only thing I see referencing voters is &quot;Similar in behaviour to &lt;tt&gt;AclEntryVoter&lt;/tt&gt;.&quot; So which is used when ACL is enabled? &lt;tt&gt;AclPermissionEvaluator&lt;/tt&gt; or &lt;tt&gt;AclEntryVoter&lt;/tt&gt;?&lt;/p&gt;

&lt;p&gt;So if the namespace configures neither of these voters, then how can they ever get configured? Once an &lt;tt&gt;AccessDecisionManager&lt;/tt&gt; is configured you can&apos;t change its voters (unless you use a deprecated method, of course). Is overriding the &lt;tt&gt;accessDecisionManager&lt;/tt&gt; method the only way to configure the &lt;tt&gt;AclEntryVoter&lt;/tt&gt; and &lt;tt&gt;RoleHierarchyVoter&lt;/tt&gt;?&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;I&apos;ll consider filing an enhancement request and submitting a pull request. Don&apos;t know yet how much it&apos;s worth to me. &lt;img class=&quot;emoticon&quot; src=&quot;https://jira.spring.io/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="93708" author="rwinch" created="Thu, 19 Sep 2013 12:18:20 +0000"  >&lt;blockquote&gt;&lt;p&gt;I&apos;m a little confused about these two. First, AclPermissionEvaluator does not have any way to configure a voter, so AclEntryVoter could not be &quot;used by&quot; it. &lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;You are correct. What I meant to type was that most people (or least should) tend to use the AclPermissionEvaluator. So if they need Acl support they would configure this and not need the AclEntryVoter.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;So if the namespace configures neither of these voters, then how can they ever get configured? Once an AccessDecisionManager is configured you can&apos;t change its voters (unless you use a deprecated method, of course). Is overriding the accessDecisionManager method the only way to configure the AclEntryVoter and RoleHierarchyVoter?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Yes. Keep in mind adding every bell and whistle to Java Configuration support will make Java Configuration support just as difficult as using standard &amp;#64;Bean so we must consider this carefully before adding it.&lt;/p&gt;</comment>
                            <comment id="93710" author="guitarking117" created="Thu, 19 Sep 2013 12:28:04 +0000"  >&lt;p&gt;Okay. Makes sense. Thanks for clearing that up!&lt;/p&gt;</comment>
                            <comment id="125329" author="issuemaster" created="Sat, 6 Feb 2016 06:22:55 +0000"  >&lt;p&gt;This issue has been migrated to &lt;a href=&quot;https://github.com/spring-projects/spring-security/issues/2535&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/spring-projects/spring-security/issues/2535&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_10170" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>First Response Date</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 18 Sep 2013 16:27:20 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10280" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>37443</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10880" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i06l9r:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10380" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>38484</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10381" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Ranking</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>37145</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_10171" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>