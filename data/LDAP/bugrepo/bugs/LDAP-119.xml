<!-- 
RSS generated by JIRA (6.4.11#64026-sha1:78f6ec473a3f058bd5d6c30e9319c7ab376bdb9c) at Fri Dec 23 01:44:57 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://jira.spring.io/si/jira.issueviews:issue-xml/LDAP-119/LDAP-119.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>Spring JIRA</title>
    <link>https://jira.spring.io</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.4.11</version>
        <build-number>64026</build-number>
        <build-date>25-08-2015</build-date>
    </build-info>

<item>
            <title>[LDAP-119] modifyAttributes produces invalid SchemaViolationException in a particular use case</title>
                <link>https://jira.spring.io/browse/LDAP-119</link>
                <project id="10071" key="LDAP">Spring LDAP</project>
                    <description>&lt;p&gt;This is most likely not related to any environment, but I have found the following issue with modifyAttributes:&lt;/p&gt;

&lt;p&gt;Use case is a basic user/role relationship where we want to update the list of users that have been assigned to a role. A role has the following structure in our system, where values in &amp;lt;angle brackets&amp;gt; are variable:&lt;/p&gt;

&lt;p&gt;objectClass: groupOfUniqueNames&lt;br/&gt;
objectClass: top&lt;br/&gt;
cn: &amp;lt;ROLE_NAME&amp;gt;&lt;br/&gt;
uniqueMember: &amp;lt;DN of a user&amp;gt;&lt;br/&gt;
uniqueMember: &amp;lt;optional DN of another user&amp;gt;&lt;br/&gt;
...&lt;br/&gt;
description: &amp;lt;optional description&amp;gt;&lt;/p&gt;

&lt;p&gt;Since a groupOfUniqueNames must have at least one uniqueMember, the following use case pseudo code fails for us:&lt;/p&gt;

&lt;p&gt;1) retrieve an existing role using the role DN&lt;br/&gt;
2) convert to a role domain object using a context mapper&lt;br/&gt;
3) update the list of uniqueMember (users) to a completely different set of users from the original using DirContextOperations.setAttributeValues(&quot;uniqueMember&quot;, newMembers)&lt;br/&gt;
4) call ldapTemplate.modifyAttributes&lt;br/&gt;
5) watch a completely (now explainable) bogus SchemaViolationException get thrown&lt;/p&gt;

&lt;p&gt;The problem is that (I believe) the spring-ldap code deletes all the uniqueMember entries before adding the new ones, so the SchemaViolationException is thrown because you can&apos;t have zero uniqueMembers.&lt;/p&gt;

&lt;p&gt;Note: the SchemaViolationException is not thrown when at least one of the new users is the same as one that already exists for the role.&lt;/p&gt;

&lt;p&gt;What (I believe) needs to happen is that more logic needs to be applied under the covers when the multi-attribute being modified is a required attribute, such that the zero value condition is not reached. A suggested approach might be to do set compares (old values vs new values) and add new (non-existing) ones first, then delete obsolete (existing, but not in new set) attribute values.&lt;/p&gt;</description>
                <environment>MacOSX, Apache Directory Server 1.0.2</environment>
        <key id="22779">LDAP-119</key>
            <summary>modifyAttributes produces invalid SchemaViolationException in a particular use case</summary>
                <type id="1" iconUrl="https://jira.spring.io/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://jira.spring.io/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://jira.spring.io/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="8">Complete</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="richrem">Rich Remington</reporter>
                        <labels>
                    </labels>
                <created>Tue, 24 Jun 2008 07:25:46 +0000</created>
                <updated>Fri, 5 Feb 2016 21:17:45 +0000</updated>
                            <resolved>Wed, 14 Aug 2013 02:26:55 +0000</resolved>
                                    <version>1.2.1</version>
                                    <fixVersion>1.3.2</fixVersion>
                                        <due></due>
                            <votes>1</votes>
                                    <watches>3</watches>
                                            <timeestimate seconds="0">0d</timeestimate>
                            <timespent seconds="7200">0.25d</timespent>
                                <comments>
                            <comment id="92749" author="marthursson" created="Wed, 14 Aug 2013 02:26:55 +0000"  >&lt;p&gt;It appears this is caused by a peculiarity in ApacheDS. The order of ADD/REMOVE modifications doesn&apos;t matter - if all values are removed it will still return a SchemaViolation error.&lt;/p&gt;

&lt;p&gt;I did test the same scenario on Active Directory, and it seems to be happy either way; as long as the attribute value is not empty after all modifications it will happily go along its business.&lt;/p&gt;

&lt;p&gt;I did implement a workaround that appears to be working: if all existing attribute values are being replaced, a single REPLACE modification will now be issued instead of individual ADD/REMOVE modifications.&lt;/p&gt;

&lt;p&gt;If it is a &quot;normal&quot; modification however, it will still work as before, i.e. individual ADD/REMOVE modifications will still be issued.&lt;/p&gt;</comment>
                            <comment id="123556" author="rwinch" created="Fri, 5 Feb 2016 21:17:45 +0000"  >&lt;p&gt;This issue has been migrated to &lt;a href=&quot;https://github.com/spring-projects/spring-ldap/issues/158&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/spring-projects/spring-ldap/issues/158&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_10170" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>First Response Date</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 14 Aug 2013 02:26:55 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10280" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>24944</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10880" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0519r:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10380" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>29412</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10381" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Ranking</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>24976</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_10171" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>